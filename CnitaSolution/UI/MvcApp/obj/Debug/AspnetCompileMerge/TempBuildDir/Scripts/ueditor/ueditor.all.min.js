(function(){function h(n,t,i){var r;return t=t.toLowerCase(),(r=n.__allListeners||i&&(n.__allListeners={}))&&(r[t]||i&&(r[t]=[]))}function c(n,t,i,r,u,f){var e=r&&n[t],o;for(e||(e=n[i]);!e&&(o=(o||n).parentNode);){if(o.tagName=="BODY"||f&&!f(o))return null;e=o[i]}return e&&u&&!u(e)?c(e,t,i,!1,u):e}var s,u,y,p,w,r;UEDITOR_CONFIG=window.UEDITOR_CONFIG||{},r=window.baidu||{},window.baidu=r,window.UE=r.editor={},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE.version="1.2.6.1";var e=UE.dom={},i=UE.browser=function(){var i=navigator.userAgent.toLowerCase(),u=window.opera,n={ie:!!window.ActiveXObject,opera:!!u&&u.version,webkit:i.indexOf(" applewebkit/")>-1,mac:i.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"},t,r;return n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera,t=0,n.ie&&(t=parseFloat(i.match(/msie (\d+)/)[1]),n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=t==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=t<7||n.quirks),n.gecko&&(r=i.match(/rv:([\d\.]+)/),r&&(r=r[1].split("."),t=r[0]*1e4+(r[1]||0)*100+(r[2]||0)*1)),/chrome\/(\d+\.\d)/i.test(i)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(t=parseFloat(u.version())),n.webkit&&(t=parseFloat(i.match(/ applewebkit\/(\d+)/)[1])),n.version=t,n.isCompatible=!n.mobile&&(n.ie&&t>=6||n.gecko&&t>=10801||n.opera&&t>=9.5||n.air&&t>=1||n.webkit&&t>=522||!1),n}(),f=i.ie,b=i.webkit,k=i.gecko,a=i.opera,t=UE.utils={each:function(n,t,i){var r,f,u;if(n!=null)if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(t.call(i,n[r],r,n)===!1)return!1}else for(u in n)if(n.hasOwnProperty(u)&&t.call(i,n[u],u,n)===!1)return!1},makeInstance:function(n){var t=new Function;return t.prototype=n,n=new t,t.prototype=null,n},extend:function(n,t,i){if(t)for(var r in t)i&&n.hasOwnProperty(r)||(n[r]=t[r]);return n},extend2:function(n){for(var u=arguments,r,i,t=1;t<u.length;t++){r=u[t];for(i in r)n.hasOwnProperty(i)||(n[i]=r[i])}return n},inherits:function(n,i){var u=n.prototype,r=t.makeInstance(i.prototype);return t.extend(r,u,!0),n.prototype=r,r.constructor=n},bind:function(n,t){return function(){return n.apply(t,arguments)}},defer:function(n,t,i){var r;return function(){i&&clearTimeout(r),r=setTimeout(n,t)}},indexOf:function(n,t,i){var r=-1;return i=this.isNumber(i)?i:0,this.each(n,function(n,u){if(u>=i&&n===t)return r=u,!1}),r},removeItem:function(n,t){for(var i=0,r=n.length;i<r;i++)n[i]===t&&(n.splice(i,1),i--)},trim:function(n){return n.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(n){if(!n)return{};n=t.isArray(n)?n:n.split(",");for(var u=0,i,r={};i=n[u++];)r[i.toUpperCase()]=r[i]=1;return r},unhtml:function(n,t){return n?n.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(n,t){return t?n:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[n]}):""},html:function(n){return n?n.replace(/&((g|l|quo)t|amp|#39);/g,function(n){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[n]}):""},cssStyleToDomStyle:function(){var n=document.createElement("div").style,t={float:n.cssFloat!=undefined?"cssFloat":n.styleFloat!=undefined?"styleFloat":"float"};return function(n){return t[n]||(t[n]=n.toLowerCase().replace(/-./g,function(n){return n.charAt(1).toUpperCase()}))}}(),loadFile:function(){function t(t,i){try{for(var u=0,r;r=n[u++];)if(r.doc===t&&r.url==(i.src||i.href))return r}catch(f){return null}}var n=[];return function(i,r,u){var e=t(i,r),s,f,o;if(e){e.ready?u&&u():e.funs.push(u);return}if(n.push({doc:i,url:r.src||r.href,funs:[u]}),!i.body){s=[];for(o in r)o!="tag"&&s.push(o+'="'+r[o]+'"');i.write("<"+r.tag+" "+s.join(" ")+" ><\/"+r.tag+">");return}if(!r.id||!i.getElementById(r.id)){f=i.createElement(r.tag),delete r.tag;for(o in r)f.setAttribute(o,r[o]);f.onload=f.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(e=t(i,r),e.funs.length>0){e.ready=1;for(var n;n=e.funs.pop();)n()}f.onload=f.onreadystatechange=null}},f.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ");},i.getElementsByTagName("head")[0].appendChild(f)}}}(),isEmptyObject:function(n){if(n==null)return!0;if(this.isArray(n)||this.isString(n))return n.length===0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},fixColor:function(n,t){var r,u,i;if(/color/i.test(n)&&/rgba?/.test(t)){if(r=t.split(","),r.length>3)return"";for(t="#",u=0;i=r[u++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(n){function r(n,t){var o;if(!n)return"";var r=n.top,u=n.bottom,i=n.left,f=n.right,e="";if(r&&i&&u&&f)e+=";"+t+":"+(r==u&&u==i&&i==f?r:r==u&&i==f?r+" "+i:i==f?r+" "+i+" "+u:r+" "+f+" "+u+" "+i)+";";else for(o in n)e+=";"+t+"-"+o+":"+n[o]+";";return e}var t,i;return n=n.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(n,r,u,f){if(f.split(" ").length==1)switch(r){case"padding":return t||(t={}),t[u]=f,"";case"margin":return i||(i={}),i[u]=f,"";case"border":return f=="initial"?"":n}return n}),n+=r(t,"padding")+r(i,"margin"),n.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(n,t){return t?t+";;":";"})},clone:function(n,i){var u,r;i=i||{};for(r in n)n.hasOwnProperty(r)&&(u=n[r],typeof u=="object"?(i[r]=t.isArray(u)?[]:{},t.clone(n[r],i[r])):i[r]=u);return i},transUnitToPx:function(n){if(!/(pt|cm)/.test(n))return n;var t;n.replace(/([\d.]+)(\w+)/,function(i,r,u){n=r,t=u});switch(t){case"cm":n=parseFloat(n)*25;break;case"pt":n=Math.round(parseFloat(n)*96/72)}return n+(n?"px":"")},domReady:function(){function n(n){n.isReady=!0;for(var i;i=t.pop();i());}var t=[];return function(r,u){u=u||window;var f=u.document;r&&t.push(r),f.readyState==="complete"?n(f):(f.isReady&&n(f),i.ie?(function(){if(!f.isReady){try{f.documentElement.doScroll("left")}catch(t){setTimeout(arguments.callee,0);return}n(f)}}(),u.attachEvent("onload",function(){n(f)})):(f.addEventListener("DOMContentLoaded",function(){f.removeEventListener("DOMContentLoaded",arguments.callee,!1),n(f)},!1),u.addEventListener("load",function(){n(f)},!1)))}}(),cssRule:i.ie?function(n,t,i){var r,f,u;if(i=i||document,r=i.indexList?i.indexList:i.indexList={},r[n])u=i.styleSheets[r[n]];else{if(t===undefined)return"";u=i.createStyleSheet("",f=i.styleSheets.length),r[n]=f}if(t===undefined)return u.cssText;u.cssText=t||""}:function(n,t,i){i=i||document;var u=i.getElementsByTagName("head")[0],r;if(!(r=i.getElementById(n))){if(t===undefined)return"";r=i.createElement("style"),r.id=n,u.appendChild(r)}if(t===undefined)return r.innerHTML;t!==""?r.innerHTML=t:u.removeChild(r)},sort:function(n,t){var i,u,r,f,e;for(t=t||function(n,t){return n.localeCompare(t)},i=0,u=n.length;i<u;i++)for(r=i,f=n.length;r<f;r++)t(n[i],n[r])>0&&(e=n[i],n[i]=n[r],n[r]=e);return n}};t.each(["String","Function","Array","Number","RegExp","Object"],function(n){UE.utils["is"+n]=function(t){return Object.prototype.toString.apply(t)=="[object "+n+"]"}}),s=UE.EventBase=function(){},s.prototype={addListener:function(n,i){n=t.trim(n).split(" ");for(var u=0,r;r=n[u++];)h(this,r,!0).push(i)},removeListener:function(n,i){n=t.trim(n).split(" ");for(var u=0,r;r=n[u++];)t.removeItem(h(this,r)||[],i)},fireEvent:function(){for(var u=arguments[0],f,i,e,n,r,u=t.trim(u).split(" "),o=0;f=u[o++];){if(i=h(this,f),i)for(r=i.length;r--;)if(i[r]){if(n=i[r].apply(this,arguments),n===!0)return n;n!==undefined&&(e=n)}(n=this["on"+f.toLowerCase()])&&(e=n.apply(this,arguments))}return e}},u=e.dtd=function(){function n(n){for(var t in n)n[t.toUpperCase()]=n[t];return n}var r=t.extend2,h=n({isindex:1,fieldset:1}),a=n({input:1,button:1,select:1,textarea:1,label:1}),v=r(n({a:1}),a),c=r({iframe:1},v),e=n({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),y=n({ins:1,del:1,script:1,style:1}),p=r(n({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),y),w=r(n({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),p),o=r(n({p:1}),w),b=r(n({iframe:1}),w,a),k=n({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),i=r(n({a:0}),b),l=n({tr:1}),f=n({"#":1}),d=r(n({param:1}),k),u=r(n({form:1}),h,c,e,o),s=n({li:1,ol:1,ul:1}),it=n({style:1,script:1}),g=n({base:1,link:1,meta:1,title:1}),rt=r(g,it),nt=n({head:1,body:1}),ut=n({html:1}),tt=n({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),ft=n({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return n({$nonBodyContent:r(ut,nt,g),$block:tt,$inline:i,$inlineWithA:r(n({a:1}),i),$body:r(n({script:1,style:1}),tt),$cdata:n({script:1,style:1}),$empty:ft,$nonChild:n({iframe:1,textarea:1}),$listItem:n({dd:1,dt:1,li:1}),$list:n({ul:1,ol:1,dl:1}),$isNotEmpty:n({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:n({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:n({p:1,div:1}),$tableContent:n({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:n({pre:1,script:1,style:1,textarea:1}),html:nt,head:rt,style:f,script:f,body:u,base:{},link:{},meta:{},title:f,col:{},tr:n({td:1,th:1}),img:{},embed:{},colgroup:n({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:u,td:u,br:{},th:u,center:u,kbd:i,button:r(o,e),basefont:{},h5:i,h4:i,samp:i,h6:i,ol:s,h1:i,h3:i,option:f,h2:i,form:r(h,c,e,o),select:n({optgroup:1,option:1}),font:i,ins:i,menu:s,abbr:i,label:i,table:n({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:i,tfoot:l,cite:i,li:u,input:{},iframe:u,strong:i,textarea:f,noframes:u,big:i,small:i,span:n({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:i,dt:i,sub:i,optgroup:n({option:1}),param:{},bdo:i,"var":i,div:u,object:d,sup:i,dd:u,strike:i,area:{},dir:s,map:r(n({area:1,form:1,p:1}),h,y,e),applet:d,dl:n({dt:1,dd:1}),del:i,isindex:{},fieldset:r(n({legend:1}),k),thead:l,ul:s,acronym:i,b:i,a:r(n({a:1}),b),blockquote:r(n({td:1,tr:1,tbody:1,li:1}),u),caption:i,i:i,u:i,tbody:l,s:i,address:r(c,o),tt:i,legend:i,q:i,pre:r(p,v),p:r(n({a:1}),i),em:i,dfn:i})}();var l=f&&i.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},v=t.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),n=e.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:f&&i.version=="6"?"﻿":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(n,t){var i,r,u,f;if(n===t)return 0;for(r=[n],u=[t],i=n;i=i.parentNode;){if(i===t)return 10;r.push(i)}for(i=t;i=i.parentNode;){if(i===n)return 20;u.push(i)}if(r.reverse(),u.reverse(),r[0]!==u[0])return 1;for(f=-1;f++,r[f]===u[f];);for(n=r[f],t=u[f];n=n.nextSibling;)if(n===t)return 4;return 2},getNodeIndex:function(n,t){for(var i=n,r=0;i=i.previousSibling;){if(t&&i.nodeType==3){i.nodeType!=i.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(t,i){return n.getPosition(t,i)==10},findParent:function(t,i,r){if(t&&!n.isBody(t))for(t=r?t:t.parentNode;t;){if(!i||i(t)||n.isBody(t))return i&&!i(t)&&n.isBody(t)?null:t;t=t.parentNode}return null},findParentByTagName:function(i,r,u,f){return r=t.listToMap(t.isArray(r)?r:[r]),n.findParent(i,function(n){return r[n.tagName]&&!(f&&f(n))},u)},findParents:function(t,i,r,u){for(var f=i&&(r&&r(t)||!r)?[t]:[];t=n.findParent(t,r);)f.push(t);return u?f:f.reverse()},insertAfter:function(n,t){return n.parentNode.insertBefore(t,n.nextSibling)},remove:function(n,t){var i=n.parentNode,r;if(i){if(t&&n.hasChildNodes())while(r=n.firstChild)i.insertBefore(r,n);i.removeChild(n)}return n},getNextDomNode:function(n,t,i,r){return c(n,"firstChild","nextSibling",t,i,r)},isBookmarkNode:function(n){return n.nodeType==1&&n.id&&/^_baidu_bookmark_/i.test(n.id)},getWindow:function(n){var t=n.ownerDocument||n;return t.defaultView||t.parentWindow},getCommonAncestor:function(n,t){if(n===t)return n;for(var u=[n],f=[t],i=n,r=-1;i=i.parentNode;){if(i===t)return i;u.push(i)}for(i=t;i=i.parentNode;){if(i===n)return i;f.push(i)}for(u.reverse(),f.reverse();r++,u[r]===f[r];);return r==0?null:u[r-1]},clearEmptySibling:function(t,i,r){function u(t,i){for(var r;t&&!n.isBookmarkNode(t)&&(n.isEmptyInlineElement(t)||!new RegExp("[^\t\n\r"+n.fillChar+"]").test(t.nodeValue));)r=t[i],n.remove(t),t=r}i||u(t.nextSibling,"nextSibling"),r||u(t.previousSibling,"previousSibling")},split:function(t,r){var e=t.ownerDocument,o,u,f;return i.ie&&r==t.nodeValue.length?(o=e.createTextNode(""),n.insertAfter(t,o)):(u=t.splitText(r),i.ie8&&(f=e.createTextNode(""),n.insertAfter(u,f),n.remove(f)),u)},isWhitespace:function(t){return!new RegExp("[^ \t\n\r"+n.fillChar+"]").test(t.nodeValue)},getXY:function(n){for(var t=0,i=0;n.offsetParent;)i+=n.offsetTop,t+=n.offsetLeft,n=n.offsetParent;return{x:t,y:i}},on:function(n,i,r){var o=t.isArray(i)?i:[i],f=o.length,u,e;if(f)while(f--)i=o[f],n.addEventListener?n.addEventListener(i,r,!1):(r._d||(r._d={els:[]}),u=i+r.toString(),e=t.indexOf(r._d.els,n),r._d[u]&&e!=-1||(e==-1&&r._d.els.push(n),r._d[u]||(r._d[u]=function(n){return r.call(n.srcElement,n||window.event)}),n.attachEvent("on"+i,r._d[u])));n=null},un:function(n,i,r){var o=t.isArray(i)?i:[i],f=o.length,u,e;if(f)while(f--)if(i=o[f],n.removeEventListener)n.removeEventListener(i,r,!1);else{u=i+r.toString();try{n.detachEvent("on"+i,r._d?r._d[u]:r)}catch(s){}r._d&&r._d[u]&&(e=t.indexOf(r._d.els,n),e!=-1&&r._d.els.splice(e,1),r._d.els.length==0&&delete r._d[u])}},isSameElement:function(t,i){var h,e,r,u,o,c,s;if(t.tagName!=i.tagName||(h=t.attributes,e=i.attributes,!f&&h.length!=e.length))return!1;for(o=0,c=0,s=0;r=h[s++];){if(r.nodeName=="style")if(r.specified&&o++,n.isSameStyle(t,i))continue;else return!1;if(f)if(r.specified)o++,u=e.getNamedItem(r.nodeName);else continue;else u=i.attributes[r.nodeName];if(!u.specified||r.nodeValue!=u.nodeValue)return!1}if(f){for(s=0;u=e[s++];)u.specified&&c++;if(o!=c)return!1}return!0},isSameStyle:function(n,r){var u=n.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),f=r.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),e,o,s;if(i.opera){if(u=n.style,f=r.style,u.length!=f.length)return!1;for(e in u)if(!/^(\d+|csstext)$/i.test(e)&&u[e]!=f[e])return!1;return!0}if(!u||!f)return u==f;if(u=u.split(";"),f=f.split(";"),u.length!=f.length)return!1;for(o=0;s=u[o++];)if(t.indexOf(f,s)==-1)return!1;return!0},isBlockElm:function(t){return t.nodeType==1&&(u.$block[t.tagName]||v[n.getComputedStyle(t,"display")])&&!u.$nonChild[t.tagName]},isBody:function(n){return n&&n.nodeType==1&&n.tagName.toLowerCase()=="body"},breakParent:function(t,i){var r,f=t,o=t,u,e;do{for(f=f.parentNode,u?(r=f.cloneNode(!1),r.appendChild(u),u=r,r=f.cloneNode(!1),r.appendChild(e),e=r):(u=f.cloneNode(!1),e=u.cloneNode(!1));r=o.previousSibling;)u.insertBefore(r,u.firstChild);while(r=o.nextSibling)e.appendChild(r);o=f}while(i!==f);return r=i.parentNode,r.insertBefore(u,i),r.insertBefore(e,i),r.insertBefore(t,e),n.remove(i),t},isEmptyInlineElement:function(t){if(t.nodeType!=1||!u.$removeEmpty[t.tagName])return 0;for(t=t.firstChild;t;){if(n.isBookmarkNode(t)||t.nodeType==1&&!n.isEmptyInlineElement(t)||t.nodeType==3&&!n.isWhitespace(t))return 0;t=t.nextSibling}return 1},trimWhiteTextNode:function(t){function i(i){for(var r;(r=t[i])&&r.nodeType==3&&n.isWhitespace(r);)t.removeChild(r)}i("firstChild"),i("lastChild")},mergeChild:function(i,r,u){for(var c=n.getElementsByTagName(i,i.tagName.toLowerCase()),f,e,h,o,s=0;f=c[s++];)if(f.parentNode&&!n.isBookmarkNode(f)){if(f.tagName.toLowerCase()=="span"){if(i===f.parentNode&&(n.trimWhiteTextNode(i),i.childNodes.length==1)){i.style.cssText=f.style.cssText+";"+i.style.cssText,n.remove(f,!0);continue}if(f.style.cssText=i.style.cssText+";"+f.style.cssText,u&&(e=u.style,e))for(e=e.split(";"),h=0;o=e[h++];)f.style[t.cssStyleToDomStyle(o.split(":")[0])]=o.split(":")[1];n.isSameStyle(f,i)&&n.remove(f,!0);continue}n.isSameElement(i,f)&&n.remove(f,!0)}},getElementsByTagName:function(i,r,u){var o,f,s,h,c,l,e;for(u&&t.isString(u)&&(o=u,u=function(t){return n.hasClass(t,o)}),r=t.trim(r).replace(/[ ]{2,}/g," ").split(" "),f=[],s=0;h=r[s++];)for(c=i.getElementsByTagName(h),l=0;e=c[l++];)(!u||u(e))&&f.push(e);return f},mergeToParent:function(t){for(var i=t.parentNode;i&&u.$removeEmpty[i.tagName];){if(i.tagName==t.tagName||i.tagName=="A"){if(n.trimWhiteTextNode(i),i.tagName=="SPAN"&&!n.isSameStyle(i,t)||i.tagName=="A"&&t.tagName=="SPAN")if(i.childNodes.length>1||i!==t.parentNode){t.style.cssText=i.style.cssText+";"+t.style.cssText,i=i.parentNode;continue}else i.style.cssText+=";"+t.style.cssText,i.tagName=="A"&&(i.style.textDecoration="underline");if(i.tagName!="A"){i===t.parentNode&&n.remove(t,!0);break}}i=i.parentNode}},mergeSibling:function(t,i,r){function u(t,i,r){var u;if((u=r[t])&&!n.isBookmarkNode(u)&&u.nodeType==1&&n.isSameElement(r,u)){while(u.firstChild)i=="firstChild"?r.insertBefore(u.lastChild,r.firstChild):r.appendChild(u.firstChild);n.remove(u)}}i||u("previousSibling","firstChild",t),r||u("nextSibling","lastChild",t)},unSelectable:f||i.opera?function(n){n.onselectstart=function(){return!1},n.onclick=n.onkeyup=n.onkeydown=function(){return!1},n.unselectable="on",n.setAttribute("unselectable","on");for(var i=0,t;t=n.all[i++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",n.setAttribute("unselectable","on")}}:function(n){n.style.MozUserSelect=n.style.webkitUserSelect=n.style.KhtmlUserSelect="none"},removeAttributes:function(n,r){r=t.isArray(r)?r:t.trim(r).replace(/[ ]{2,}/g," ").split(" ");for(var f=0,u;u=r[f++];){u=l[u]||u;switch(u){case"className":n[u]="";break;case"style":n.style.cssText="",i.ie||n.removeAttributeNode(n.getAttributeNode("style"))}n.removeAttribute(u)}},createElement:function(t,i,r){return n.setAttributes(t.createElement(i),r)},setAttributes:function(n,t){var i,r;for(i in t)if(t.hasOwnProperty(i)){r=t[i];switch(i){case"class":n.className=r;break;case"style":n.style.cssText=n.style.cssText+";"+r;break;case"innerHTML":n[i]=r;break;case"value":n.value=r;break;default:n.setAttribute(l[i]||i,r)}}return n},getComputedStyle:function(r,f){var e,o,s;if("width height top left".indexOf(f)>-1)return r["offset"+f.replace(/^\w/,function(n){return n.toUpperCase()})]+"px";if(r.nodeType==3&&(r=r.parentNode),i.ie&&i.version<9&&f=="font-size"&&!r.style.fontSize&&!u.$empty[r.tagName]&&!u.$nonChild[r.tagName])return e=r.ownerDocument.createElement("span"),e.style.cssText="padding:0;border:0;font-family:simsun;",e.innerHTML=".",r.appendChild(e),o=e.offsetHeight,r.removeChild(e),e=null,o+"px";try{s=n.getStyle(r,f)||(window.getComputedStyle?n.getWindow(r).getComputedStyle(r,"").getPropertyValue(f):(r.currentStyle||r.style)[t.cssStyleToDomStyle(f)])}catch(h){return""}return t.transUnitToPx(t.fixColor(f,s))},removeClasses:function(i,r){r=t.isArray(r)?r:t.trim(r).replace(/[ ]{2,}/g," ").split(" ");for(var e=0,f,u=i.className;f=r[e++];)u=u.replace(new RegExp("\\b"+f+"\\b"),"");u=t.trim(u).replace(/[ ]{2,}/g," "),u?i.className=u:n.removeAttributes(i,["class"])},addClass:function(n,i){if(n){i=t.trim(i).replace(/[ ]{2,}/g," ").split(" ");for(var u=0,r,f=n.className;r=i[u++];)new RegExp("\\b"+r+"\\b").test(f)||(n.className+=" "+r)}},hasClass:function(n,i){if(t.isRegExp(i))return i.test(n.className);i=t.trim(i).replace(/[ ]{2,}/g," ").split(" ");for(var r=0,u,f=n.className;u=i[r++];)if(!new RegExp("\\b"+u+"\\b","i").test(f))return!1;return r-1==i.length},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},removeStyle:function(r,u){i.ie?(u=="color"&&(u="(^|;)"+u),r.style.cssText=r.style.cssText.replace(new RegExp(u+"[^:]*:[^;]+;?","ig"),"")):r.style.removeProperty?r.style.removeProperty(u):r.style.removeAttribute(t.cssStyleToDomStyle(u)),r.style.cssText||n.removeAttributes(r,["style"])},getStyle:function(n,i){var r=n.style[t.cssStyleToDomStyle(i)];return t.fixColor(i,r)},setStyle:function(n,i,r){n.style[t.cssStyleToDomStyle(i)]=r,t.trim(n.style.cssText)||this.removeAttributes(n,"style")},setStyles:function(t,i){for(var r in i)i.hasOwnProperty(r)&&n.setStyle(t,r,i[r])},removeDirtyAttr:function(n){for(var i=0,t,r=n.getElementsByTagName("*");t=r[i++];)t.removeAttribute("_moz_dirty");n.removeAttribute("_moz_dirty")},getChildCount:function(n,t){var r=0,i=n.firstChild;for(t=t||function(){return 1};i;)t(i)&&r++,i=i.nextSibling;return r},isEmptyNode:function(t){return!t.firstChild||n.getChildCount(t,function(t){return!n.isBr(t)&&!n.isBookmarkNode(t)&&!n.isWhitespace(t)})==0},clearSelectedArr:function(t){for(var i;i=t.pop();)n.removeAttributes(i,["class"])},scrollToView:function(t,i,r){var s=function(){var n=i.document,t=n.compatMode=="CSS1Compat";return{width:(t?n.documentElement.clientWidth:n.body.clientWidth)||0,height:(t?n.documentElement.clientHeight:n.body.clientHeight)||0}},h=function(n){if("pageXOffset"in n)return{x:n.pageXOffset||0,y:n.pageYOffset||0};var t=n.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},e=s().height,u=e*-1+r,o,f;u+=t.offsetHeight||0,o=n.getXY(t),u+=o.y,f=h(i).y,(u>f||u<f-e)&&i.scrollTo(0,u+(u<0?-20:20))},isBr:function(n){return n.nodeType==1&&n.tagName=="BR"},isFillChar:function(t,i){return t.nodeType==3&&!t.nodeValue.replace(new RegExp((i?"^":"")+n.fillChar),"").length},isStartInblock:function(t){var r=t.cloneRange(),o=0,i=r.startContainer,f,u,e;if(i.nodeType==1&&i.childNodes[r.startOffset])for(i=i.childNodes[r.startOffset],u=i.previousSibling;u&&n.isFillChar(u);)i=u,u=u.previousSibling;for(this.isFillChar(i,!0)&&r.startOffset==1&&(r.setStartBefore(i),i=r.startContainer);i&&n.isFillChar(i);)f=i,i=i.previousSibling;for(f&&(r.setStartBefore(f),i=r.startContainer),i.nodeType==1&&n.isEmptyNode(i)&&r.startOffset==1&&r.setStart(i,0).collapse(!0);!r.startOffset;){if(i=r.startContainer,n.isBlockElm(i)||n.isBody(i)){o=1;break}if(u=r.startContainer.previousSibling,u){while(u&&n.isFillChar(u))e=u,u=u.previousSibling;e?r.setStartBefore(e):r.setStartBefore(r.startContainer)}else r.setStartBefore(r.startContainer)}return o&&!n.isBody(r.startContainer)?1:0},isEmptyBlock:function(t,r){if(t.nodeType!=1||(r=r||new RegExp("[ \t\r\n"+n.fillChar+"]","g"),t[i.ie?"innerText":"textContent"].replace(r,"").length>0))return 0;for(var f in u.$isNotEmpty)if(t.getElementsByTagName(f).length)return 0;return 1},setViewportOffset:function(n,t){var f=parseInt(n.style.left)|0,e=parseInt(n.style.top)|0,i=n.getBoundingClientRect(),r=t.left-i.left,u=t.top-i.top;r&&(n.style.left=f+r+"px"),u&&(n.style.top=e+u+"px")},fillNode:function(t,r){var u=i.ie?t.createTextNode(n.fillChar):t.createElement("br");r.innerHTML="",r.appendChild(u)},moveChild:function(n,t,i){while(n.firstChild)i&&t.firstChild?t.insertBefore(n.lastChild,t.firstChild):t.appendChild(n.firstChild)},hasNoAttributes:function(n){return i.ie?/^<\w+\s*?>/.test(n.outerHTML):n.attributes.length==0},isCustomeNode:function(n){return n.nodeType==1&&n.getAttribute("_ue_custom_node_")},isTagNode:function(n,t){return n.nodeType==1&&new RegExp("^"+n.tagName+"$","i").test(t)},filterNodeList:function(n,i,r){var u=[],f;return t.isFunction(i)||(f=i,i=function(n){return t.indexOf(t.isArray(f)?f:f.split(" "),n.tagName.toLowerCase())!=-1}),t.each(n,function(n){i(n)&&u.push(n)}),u.length==0?null:u.length==1||!r?u[0]:u},isInNodeEndBoundary:function(n,t){var i=n.startContainer;if(i.nodeType==3&&n.startOffset!=i.nodeValue.length||i.nodeType==1&&n.startOffset!=i.childNodes.length)return 0;while(i!==t){if(i.nextSibling)return 0;i=i.parentNode}return 1},isBoundaryNode:function(t,i){for(var r;!n.isBody(t);)if(r=t,t=t.parentNode,r!==t[i])return!1;return!0}},o=new RegExp(n.fillChar,"g");(function(){function p(n){n.collapsed=n.startContainer&&n.endContainer&&n.startContainer===n.endContainer&&n.startOffset==n.endOffset}function l(n){return!n.collapsed&&n.startContainer.nodeType==1&&n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1}function a(t,i,r,f){return i.nodeType==1&&(u.$empty[i.tagName]||u.$nonChild[i.tagName])&&(r=n.getNodeIndex(i)+(t?0:1),i=i.parentNode),t?(f.startContainer=i,f.startOffset=r,f.endContainer||f.collapse(!0)):(f.endContainer=i,f.endOffset=r,f.startContainer||f.collapse(!1)),p(f),f}function h(t,i){var r=t.startContainer,o=t.endContainer,h=t.startOffset,w=t.endOffset,l=t.document,b=l.createDocumentFragment(),k,d,f,y,s,p;if(r.nodeType==1&&(r=r.childNodes[h]||(k=r.appendChild(l.createTextNode("")))),o.nodeType==1&&(o=o.childNodes[w]||(d=o.appendChild(l.createTextNode("")))),r===o&&r.nodeType==3)return b.appendChild(l.createTextNode(r.substringData(h,w-h))),i&&(r.deleteData(h,w-h),t.collapse(!0)),b;var u,a,e=b,c=n.findParents(r,!0),v=n.findParents(o,!0);for(f=0;c[f]==v[f];)f++;for(s=f;y=c[s];s++){for(u=y.nextSibling,y==r?k||(t.startContainer.nodeType==3?(e.appendChild(l.createTextNode(r.nodeValue.slice(h))),i&&r.deleteData(h,r.nodeValue.length-h)):e.appendChild(i?r:r.cloneNode(!0))):(a=y.cloneNode(!1),e.appendChild(a));u;){if(u===o||u===v[s])break;y=u.nextSibling,e.appendChild(i?u:u.cloneNode(!0)),u=y}e=a}for(e=b,c[f]||(e.appendChild(c[f-1].cloneNode(!1)),e=e.firstChild),s=f;p=v[s];s++){if(u=p.previousSibling,p==o?d||t.endContainer.nodeType!=3||(e.appendChild(l.createTextNode(o.substringData(0,w))),i&&o.deleteData(0,w)):(a=p.cloneNode(!1),e.appendChild(a)),s!=f||!c[f])while(u){if(u===r)break;p=u.previousSibling,e.insertBefore(i?u:u.cloneNode(!0),e.firstChild),u=p}e=a}return i&&t.setStartBefore(v[f]?c[f]?v[f]:c[f-1]:v[f-1]).collapse(!0),k&&n.remove(k),d&&n.remove(d),b}function y(t,u){try{if(r&&n.inDoc(r,t))if(r.nodeValue.replace(o,"").length)r.nodeValue=r.nodeValue.replace(o,"");else{var f=r.parentNode;for(n.remove(r);f&&n.isEmptyInlineElement(f)&&(i.safari?!(n.getPosition(f,u)&n.POSITION_CONTAINS):!f.contains(u));)r=f.parentNode,n.remove(f),f=r}}catch(e){}}function f(t,i){var r;for(t=t[i];t&&n.isFillChar(t);)r=t[i],n.remove(t),t=r}var c=0,s=n.fillChar,r,v=e.Range=function(n){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=n,t.collapsed=!0};v.prototype={cloneContents:function(){return this.collapsed?null:h(this,0)},deleteContents:function(){var t;return this.collapsed||h(this,1),i.webkit&&(t=this.startContainer,t.nodeType!=3||t.nodeValue.length||(this.setStartBefore(t).collapse(!0),n.remove(t))),this},extractContents:function(){return this.collapsed?null:h(this,2)},setStart:function(n,t){return a(!0,n,t,this)},setEnd:function(n,t){return a(!1,n,t,this)},setStartAfter:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t)+1)},setStartBefore:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t))},setEndAfter:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t)+1)},setEndBefore:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t))},setStartAtFirst:function(n){return this.setStart(n,0)},setStartAtLast:function(n){return this.setStart(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},setEndAtFirst:function(n){return this.setEnd(n,0)},setEndAtLast:function(n){return this.setEnd(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},selectNode:function(n){return this.setStartBefore(n).setEndAfter(n)},selectNodeContents:function(n){return this.setStart(n,0).setEndAtLast(n)},cloneRange:function(){var n=this;return new v(n.document).setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(n){var t=this;return n?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(t){function f(t){return t.nodeType==1&&!n.isBookmarkNode(t)&&!u.$empty[t.tagName]&&!u.$nonChild[t.tagName]}for(var i=this,r,e=i.collapsed;i.startContainer.nodeType==1&&(r=i.startContainer.childNodes[i.startOffset])&&f(r);)i.setStart(r,0);if(e)return i.collapse(!0);if(!t)while(i.endContainer.nodeType==1&&i.endOffset>0&&(r=i.endContainer.childNodes[i.endOffset-1])&&f(r))i.setEnd(r,r.childNodes.length);return i},getCommonAncestor:function(t,i){var u=this,r=u.startContainer,f=u.endContainer;return r===f?t&&l(this)&&(r=r.childNodes[u.startOffset],r.nodeType==1)?r:i&&r.nodeType==3?r.parentNode:r:n.getCommonAncestor(r,f)},trimBoundary:function(t){var f;this.txtToElmBoundary();var u=this.startContainer,i=this.startOffset,e=this.collapsed,r=this.endContainer;return u.nodeType==3&&(i==0?this.setStartBefore(u):i>=u.nodeValue.length?this.setStartAfter(u):(f=n.split(u,i),u===r?this.setEnd(f,this.endOffset-i):u.parentNode===r&&(this.endOffset+=1),this.setStartBefore(f)),e)?this.collapse(!0):(t||(i=this.endOffset,r=this.endContainer,r.nodeType==3&&(i==0?this.setEndBefore(r):(i<r.nodeValue.length&&n.split(r,i),this.setEndAfter(r)))),this)},txtToElmBoundary:function(n){function t(n,t){var i=n[t+"Container"],r=n[t+"Offset"];i.nodeType==3&&(r?r>=i.nodeValue.length&&n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"After"](i):n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"Before"](i))}return(n||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(n){var t=n,r=1;n.nodeType==11&&(t=n.firstChild,r=n.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,f=this.startOffset,u=i.childNodes[f];return u?i.insertBefore(n,u):i.appendChild(n),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+r),this.setStartBefore(t)},setCursor:function(n,t){return this.collapse(!n).select(t)},createBookmark:function(n,t){var i,r=this.document.createElement("span");return r.style.cssText="display:none;line-height:0px;",r.appendChild(this.document.createTextNode("‍")),r.id="_baidu_bookmark_start_"+(t?"":c++),this.collapsed||(i=r.cloneNode(!0),i.id="_baidu_bookmark_end_"+(t?"":c++)),this.insertNode(r),i&&this.collapse().insertNode(i).setEndBefore(i),this.setStartAfter(r),{start:n?r.id:r,end:i?n?i.id:i:null,id:n}},moveToBookmark:function(t){var r=t.id?this.document.getElementById(t.start):t.start,i=t.end&&t.id?this.document.getElementById(t.end):t.end;return this.setStartBefore(r),n.remove(r),i?(this.setEndBefore(i),n.remove(i)):this.collapse(!0),this},enlarge:function(t,i){var e=n.isBody,u,r,f=this.document.createTextNode("");if(t){for(r=this.startContainer,r.nodeType==1?r.childNodes[this.startOffset]?u=r=r.childNodes[this.startOffset]:(r.appendChild(f),u=r=f):u=r;;){if(n.isBlockElm(r)){for(r=u;(u=r.previousSibling)&&!n.isBlockElm(u);)r=u;this.setStartBefore(r);break}u=r,r=r.parentNode}for(r=this.endContainer,r.nodeType==1?((u=r.childNodes[this.endOffset])?r.insertBefore(f,u):r.appendChild(f),u=r=f):u=r;;){if(n.isBlockElm(r)){for(r=u;(u=r.nextSibling)&&!n.isBlockElm(u);)r=u;this.setEndAfter(r);break}u=r,r=r.parentNode}f.parentNode===this.endContainer&&this.endOffset--,n.remove(f)}if(!this.collapsed){while(this.startOffset==0){if(i&&i(this.startContainer))break;if(e(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(i&&i(this.endContainer))break;if(e(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!n.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!n.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(t,i,r){var p,f,s,w,b,k,v;if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(t){return t.nodeType==1&&n.isBlockElm(t)}).adjustmentBoundary();for(var c=this.createBookmark(),l=c.end,a=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},o=n.getNextDomNode(c.start,!1,a),e,y,h=this.cloneRange();o&&n.getPosition(o,l)&n.POSITION_PRECEDING;)if(o.nodeType==3||u[t][o.tagName]){for(h.setStartBefore(o),e=o;e&&(e.nodeType==3||u[t][e.tagName])&&e!==l;)y=e,e=n.getNextDomNode(e,e.nodeType==1,null,function(n){return u[t][n.tagName]});if(p=h.setEndAfter(y).extractContents(),r&&r.length>0){for(w=s=r[0].cloneNode(!1),b=1;k=r[b++];)s.appendChild(k.cloneNode(!1)),s=s.firstChild;f=s}else f=h.document.createElement(t);if(i&&n.setAttributes(f,i),f.appendChild(p),h.insertNode(r?w:f),t=="span"&&i.style&&/text\-decoration/.test(i.style)&&(v=n.findParentByTagName(f,"a",!0))?(n.setAttributes(v,i),n.remove(f,!0),f=v):(n.mergeSibling(f),n.clearEmptySibling(f)),n.mergeChild(f,i),o=n.getNextDomNode(f,!1,a),n.mergeToParent(f),e===l)break}else o=n.getNextDomNode(o,!0,a);return this.moveToBookmark(c)},removeInlineStyle:function(i){var r,u,f,s,o,e,h;if(this.collapsed)return this;for(i=t.isArray(i)?i:[i],this.shrinkBoundary().adjustmentBoundary(),r=this.startContainer,u=this.endContainer;;){if(r.nodeType==1){if(t.indexOf(i,r.tagName.toLowerCase())>-1)break;if(r.tagName.toLowerCase()=="body"){r=null;break}}r=r.parentNode}for(;;){if(u.nodeType==1){if(t.indexOf(i,u.tagName.toLowerCase())>-1)break;if(u.tagName.toLowerCase()=="body"){u=null;break}}u=u.parentNode}for(f=this.createBookmark(),r&&(o=this.cloneRange().setEndBefore(f.start).setStartBefore(r),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(r,!0),r.parentNode.insertBefore(f.start,r)),u&&(o=this.cloneRange().setStartAfter(f.end).setEndAfter(u),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(u,!1,!0),u.parentNode.insertBefore(f.end,u.nextSibling)),e=n.getNextDomNode(f.start,!1,function(n){return n.nodeType==1});e&&e!==f.end;)h=n.getNextDomNode(e,!0,function(n){return n.nodeType==1}),t.indexOf(i,e.tagName.toLowerCase())>-1&&n.remove(e,!0),e=h;return this.moveToBookmark(f)},getClosedNode:function(){var i,t,n;return this.collapsed||(t=this.cloneRange().adjustmentBoundary().shrinkBoundary(),l(t)&&(n=t.startContainer.childNodes[t.startOffset],n&&n.nodeType==1&&(u.$empty[n.tagName]||u.$nonChild[n.tagName])&&(i=n))),i},select:i.ie?function(t,i){var u,l,h,e,v,a,c,o;if(this.collapsed||this.shrinkBoundary(),l=this.getClosedNode(),l&&!i){try{u=this.document.body.createControlRange(),u.addElement(l),u.select()}catch(p){}return this}h=this.createBookmark(),e=h.start,u=this.document.body.createTextRange(),u.moveToElementText(e),u.moveStart("character",1),this.collapsed?t||this.startContainer.nodeType==3||(c=this.document.createTextNode(s),o=this.document.createElement("span"),o.appendChild(this.document.createTextNode(s)),e.parentNode.insertBefore(o,e),e.parentNode.insertBefore(c,e),y(this.document,c),r=c,f(o,"previousSibling"),f(e,"nextSibling"),u.moveStart("character",-1),u.collapse(!0)):(a=this.document.body.createTextRange(),v=h.end,a.moveToElementText(v),u.setEndPoint("EndToEnd",a)),this.moveToBookmark(h),o&&n.remove(o);try{u.select()}catch(p){}return this}:function(t){function a(n){function t(t,i,r){t.nodeType==3&&t.nodeValue.length<i&&(n[r+"Offset"]=t.nodeValue.length)}t(n.startContainer,n.startOffset,"start"),t(n.endContainer,n.endOffset,"end")}var l=n.getWindow(this.document),c=l.getSelection(),e,o,h,u;if(i.gecko?this.document.body.focus():l.focus(),c){if(c.removeAllRanges(),this.collapsed&&!t&&(o=this.startContainer,u=o,o.nodeType==1&&(u=o.childNodes[this.startOffset]),o.nodeType==3&&this.startOffset||(u?u.previousSibling&&u.previousSibling.nodeType==3:o.lastChild&&o.lastChild.nodeType==3)||(e=this.document.createTextNode(s),this.insertNode(e),y(this.document,e),f(e,"previousSibling"),f(e,"nextSibling"),r=e,this.setStart(e,i.webkit?1:0).collapse(!0))),h=this.document.createRange(),this.collapsed&&i.opera&&this.startContainer.nodeType==1)if(u=this.startContainer.childNodes[this.startOffset],u){while(u&&n.isBlockElm(u))if(u.nodeType==1&&u.childNodes[0])u=u.childNodes[0];else break;u&&this.setStartBefore(u).collapse(!0)}else u=this.startContainer.lastChild,u&&n.isBr(u)&&this.setStartBefore(u).collapse(!0);a(this),h.setStart(this.startContainer,this.startOffset),h.setEnd(this.endContainer,this.endOffset),c.addRange(h)}return this},scrollToView:function(t,i){t=t?window:n.getWindow(this.document);var u=this,r=u.document.createElement("span");return r.innerHTML="&nbsp;",u.cloneRange().insertNode(r),n.scrollToView(r,t,i),n.remove(r),u},inFillChar:function(){var t=this.startContainer;return this.collapsed&&t.nodeType==3&&t.nodeValue.replace(new RegExp("^"+n.fillChar),"").length+1==t.nodeValue.length?!0:!1},createAddress:function(t,i){function f(t){for(var f=t?r.startContainer:r.endContainer,a=n.findParents(f,!0,function(t){return!n.isBody(t)}),h=[],l,e,s,u,c=0;l=a[c++];)h.push(n.getNodeIndex(l,i));if(e=0,i)if(f.nodeType==3){for(s=f.previousSibling;s&&s.nodeType==3;)e+=s.nodeValue.replace(o,"").length,s=s.previousSibling;e+=t?r.startOffset:r.endOffset}else if(f=f.childNodes[t?r.startOffset:r.endOffset],f)e=n.getNodeIndex(f,i);else for(f=t?r.startContainer:r.endContainer,u=f.firstChild;u;){if(n.isFillChar(u)){u=u.nextSibling;continue}if(e++,u.nodeType==3)while(u&&u.nodeType==3)u=u.nextSibling;else u=u.nextSibling}else e=t?n.isFillChar(f)?0:r.startOffset:r.endOffset;return e<0&&(e=0),h.push(e),h}var u={},r=this;return u.startAddress=f(!0),t||(u.endAddress=r.collapsed?[].concat(u.startAddress):f()),u},moveToAddress:function(n,t){function r(n,t){for(var r=i.document.body,f,e,o,u=0,s=n.length;u<s;u++)if(o=n[u],f=r,r=r.childNodes[o],!r){e=o;break}t?r?i.setStartBefore(r):i.setStart(f,e):r?i.setEndBefore(r):i.setEnd(f,e)}var i=this;return r(n.startAddress,!0),!t&&n.endAddress&&r(n.endAddress),i},equals:function(n){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==n[t])return!1;return!0},traversal:function(t,i){var e;if(this.collapsed)return this;for(var u=this.createBookmark(),f=u.end,r=n.getNextDomNode(u.start,!1,i);r&&r!==f&&n.getPosition(r,f)&n.POSITION_PRECEDING;)e=n.getNextDomNode(r,!1,i),t(r),r=e;return this.moveToBookmark(u)}}})(),function(){function o(t,i){var l=n.getNodeIndex,e,o,y,p;if(t=t.duplicate(),t.collapse(i),e=t.parentElement(),!e.hasChildNodes())return{container:e,offset:0};for(var s=e.children,r,h=t.duplicate(),a=0,v=s.length-1,c=-1,f;a<=v;)if(c=Math.floor((a+v)/2),r=s[c],h.moveToElementText(r),o=h.compareEndPoints("StartToStart",t),o>0)v=c-1;else if(o<0)a=c+1;else return{container:e,offset:l(r)};if(c==-1){if(h.moveToElementText(e),h.setEndPoint("StartToStart",t),f=h.text.replace(/(\r\n|\r)/g,"\n").length,s=e.childNodes,!f)return r=s[s.length-1],{container:r,offset:r.nodeValue.length};for(y=s.length;f>0;)f-=s[--y].nodeValue.length;return{container:s[y],offset:-f}}if(h.collapse(o>0),h.setEndPoint(o>0?"StartToStart":"EndToStart",t),f=h.text.replace(/(\r\n|\r)/g,"\n").length,!f)return u.$empty[r.tagName]||u.$nonChild[r.tagName]?{container:e,offset:l(r)+(o>0?0:1)}:{container:r,offset:o>0?0:r.childNodes.length};while(f>0)try{p=r,r=r[o>0?"previousSibling":"nextSibling"],f-=r.nodeValue.length}catch(w){return{container:e,offset:l(p)}}return{container:r,offset:o>0?-f:r.nodeValue.length+f}}function s(n,t){if(n.item)t.selectNode(n.item(0));else{var i=o(n,!0);t.setStart(i.container,i.offset),n.compareEndPoints("StartToEnd",n)!=0&&(i=o(n,!1),t.setEnd(i.container,i.offset))}return t}function t(n){var t,i;try{t=n.getNative().createRange()}catch(r){return null}return(i=t.item?t.item(0):t.parentElement(),(i.ownerDocument||i)===n.document)?t:null}var h=e.Selection=function(i){var r=this,u;if(r.document=i,f){u=n.getWindow(i).frameElement;n.on(u,"beforedeactivate",function(){r._bakIERange=r.getIERange()});n.on(u,"activate",function(){try{!t(r)&&r._bakIERange&&r._bakIERange.select()}catch(n){}r._bakIERange=null})}u=i=null};h.prototype={getNative:function(){var t=this.document;try{return t?f&&i.ie<9?t.selection:n.getWindow(t).getSelection():null}catch(r){return null}},getIERange:function(){var n=t(this);return!n&&this._bakIERange?this._bakIERange:n},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?n.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return i.ie&&t(this)||!i.ie&&this.getNative().rangeCount?!0:!1}catch(n){return!1}},getRange:function(){function o(n){for(var t=u.document.body.firstChild,i=n.collapsed;t&&t.firstChild;)n.setStart(t,0),t=t.firstChild;n.startContainer||n.setStart(u.document.body,0),i&&n.collapse(!0)}var u=this,t,h,e,c,l;if(u._cachedRange!=null)return this._cachedRange;if(t=new r.editor.dom.Range(u.document),f&&i.ie<9)if(h=u.getIERange(),h)try{s(h,t)}catch(a){o(t)}else o(t);else if(e=u.getNative(),e&&e.rangeCount)c=e.getRangeAt(0),l=e.getRangeAt(e.rangeCount-1),t.setStart(c.startContainer,c.startOffset).setEnd(l.endContainer,l.endOffset),t.collapsed&&n.isBody(t.startContainer)&&!t.startOffset&&o(t);else{if(this._bakRange&&n.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;o(t)}return this._bakRange=t},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var t=f?this.getIERange():this.getRange(),i,n,r,u;if(f){if(!t)return this.document.body.firstChild;if(t.item)return t.item(0);for(i=t.duplicate(),i.text.length>0&&i.moveStart("character",1),i.collapse(1),n=i.parentElement(),u=r=t.parentElement();r=r.parentNode;)if(r==n){n=u;break}}else if(t.shrinkBoundary(),n=t.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,t.startOffset)]),n.nodeType==3)return n.parentNode;return n},getText:function(){var n,t;return this.isFocus()&&(n=this.getNative())?(t=i.ie?n.createRange():n.getRangeAt(0),i.ie?t.text:t.toString()):""},clearRange:function(){this.getNative()[i.ie?"empty":"removeAllRanges"]()}}}(),function(){function r(i,r){var u,e,f,o;if(r.textarea)if(t.isString(r.textarea)){for(e=0,o=n.getElementsByTagName(i,"textarea");f=o[e++];)if(f.id=="ueditor_textarea_"+r.options.textarea){u=f;break}}else u=r.textarea;u||(i.appendChild(u=n.createElement(document,"textarea",{name:r.options.textarea,id:"ueditor_textarea_"+r.options.textarea,style:"display:none"})),r.textarea=u),u.value=r.hasContents()?r.options.allHtmlEnabled?r.getAllHtml():r.getContent(null,null,!0):""}function h(n){for(var t in UE.plugins)UE.plugins[t].call(n);n.langIsReady=!0,n.fireEvent("langReady")}function a(n){for(var t in n)return t}var l=0,o,c=UE.Editor=function(n){var i=this;i.uid=l++,s.call(i),i.commands={},i.options=t.extend(t.clone(n||{}),UEDITOR_CONFIG,!0),i.shortcutkeys={},i.inputRules=[],i.outputRules=[],i.setOpt({isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:i.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:i.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:i.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0}),t.isEmptyObject(UE.I18N)?t.loadFile(document,{src:i.options.langPath+i.options.lang+"/"+i.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){h(i)}):(i.options.lang=a(UE.I18N),h(i)),UE.instants["ueditorInstant"+i.uid]=i};c.prototype={ready:function(n){var t=this;n&&(t.isReady?n.apply(t):t.addListener("ready",n))},setOpt:function(n,i){var r={};t.isString(n)?r[n]=i:r=n,t.extend(this.options,r,!0)},destroy:function(){var t=this,r,i,f,u;t.fireEvent("destroy"),r=t.container.parentNode,i=t.textarea,i?i.style.display="":(i=document.createElement("textarea"),r.parentNode.insertBefore(i,r)),i.style.width=t.iframe.offsetWidth+"px",i.style.height=t.iframe.offsetHeight+"px",i.value=t.getContent(),i.id=t.key,r.innerHTML="",n.remove(r),f=t.key;for(u in t)t.hasOwnProperty(u)&&delete this[u];UE.delEditor(f)},render:function(r){var o=this,u=o.options,e=function(t){return parseInt(n.getComputedStyle(r,t))},s;t.isString(r)&&(r=document.getElementById(r)),r&&(u.minFrameWidth=u.initialFrameWidth?u.initialFrameWidth:u.initialFrameWidth=r.offsetWidth,u.initialFrameHeight?u.minFrameHeight=u.initialFrameHeight:u.initialFrameHeight=u.minFrameHeight=r.offsetHeight,r.style.width=/%$/.test(u.initialFrameWidth)?"100%":u.initialFrameWidth-e("padding-left")-e("padding-right")+"px",r.style.height=/%$/.test(u.initialFrameHeight)?"100%":u.initialFrameHeight-e("padding-top")-e("padding-bottom")+"px",r.style.zIndex=u.zIndex,s=(f&&i.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}<\/style>"+(u.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+t.unhtml(u.iframeCssUrl)+"'/>":"")+(u.initialStyle?"<style>"+u.initialStyle+"<\/style>":"")+"<\/head><body class='view' ><\/body><script type='text/javascript' "+(f?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){window.parent.UE.instants['ueditorInstant"+o.uid+"']._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script><\/html>",r.appendChild(n.createElement(document,"iframe",{id:"ueditor_"+o.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(u.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+s+'");document.close();}())'})),r.style.overflow="hidden",setTimeout(function(){/%$/.test(u.initialFrameWidth)&&(u.minFrameWidth=u.initialFrameWidth=r.offsetWidth,r.style.width=u.initialFrameWidth+"px"),/%$/.test(u.initialFrameHeight)&&(u.minFrameHeight=u.initialFrameHeight=r.offsetHeight,r.style.height=u.initialFrameHeight+"px")}))},_setup:function(t){var u=this,o=u.options,h,s,c;for(f?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):t.body.contentEditable=!0,t.body.spellcheck=!1,u.document=t,u.window=t.defaultView||t.parentWindow,u.iframe=u.window.frameElement,u.body=t.body,u.selection=new e.Selection(t),i.gecko&&(h=this.selection.getNative())&&h.removeAllRanges(),this._initEvents(),s=this.iframe.parentNode;!n.isBody(s);s=s.parentNode)if(s.tagName=="FORM"){if(u.form=s,u.options.autoSyncData)n.on(u.window,"blur",function(){r(s,u)});else n.on(s,"submit",function(){r(this,u)});break}o.initialContent&&(o.autoClearinitialContent?(c=u.execCommand,u.execCommand=function(){return u.fireEvent("firstBeforeExecCommand"),c.apply(u,arguments)},this._setDefaultContent(o.initialContent)):this.setContent(o.initialContent,!1,!0)),n.isEmptyNode(u.body)&&(u.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"<\/p>"),o.focus&&setTimeout(function(){u.focus(u.options.focusInEnd),u.options.autoClearinitialContent||u._selectionChange()},0),u.container||(u.container=this.iframe.parentNode),o.fullscreen&&u.ui&&u.ui.setFullScreen(!0);try{u.document.execCommand("2D-position",!1,!1)}catch(l){}try{u.document.execCommand("enableInlineTableEditing",!1,!1)}catch(l){}try{u.document.execCommand("enableObjectResizing",!1,!1)}catch(l){}if(u._bindshortcutKeys(),u.isReady=1,u.fireEvent("ready"),o.onready&&o.onready.call(u),!i.ie)n.on(u.window,["blur","focus"],function(n){if(n.type=="blur"){u._bakRange=u.selection.getRange();try{u._bakNativeRange=u.selection.getNative().getRangeAt(0),u.selection.getNative().removeAllRanges()}catch(n){u._bakNativeRange=null}}else try{u._bakRange&&u._bakRange.select()}catch(n){}});i.gecko&&i.version<=10902&&(u.body.contentEditable=!1,setTimeout(function(){u.body.contentEditable=!0},100),setInterval(function(){u.body.style.height=u.iframe.offsetHeight-20+"px"},100)),o.isShow||u.setHide(),o.readonly&&u.setDisabled()},sync:function(t){var i=this,u=t?document.getElementById(t):n.findParent(i.iframe.parentNode,function(n){return n.tagName=="FORM"},!0);u&&r(u,i)},setHeight:function(n,t){n!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=n+"px"),t||(this.options.minFrameHeight=this.options.initialFrameHeight=n),this.body.style.height=n+"px"},addshortcutkey:function(n,i){var r={};i?r[n]=i:r=n,t.extend(this.shortcutkeys,r)},_bindshortcutKeys:function(){var t=this,i=this.shortcutkeys;t.addListener("keydown",function(r,u){var h=u.keyCode||u.which,e,c,l,f,o,s;for(e in i)for(c=i[e].split(","),l=0;f=c[l++];)f=f.split(":"),o=f[0],s=f[1],(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o))&&((RegExp.$1=="ctrl"?u.ctrlKey||u.metaKey:0)&&(RegExp.$2!=""?u[RegExp.$2.slice(1)+"Key"]:1)&&h==RegExp.$3||h==RegExp.$1)&&(t.queryCommandState(e,s)!=-1&&t.execCommand(e,s),n.preventDefault(u))})},getContent:function(n,i,r,u,f){var e=this,o;return(n&&t.isFunction(n)&&(i=n,n=""),i?!i():!this.hasContents())?"":(e.fireEvent("beforegetcontent"),o=UE.htmlparser(e.body.innerHTML,u),e.filterOutputRule(o),e.fireEvent("aftergetcontent",n),o.toHtml(f))},getAllHtml:function(){var n=this,u=[],r;return n.fireEvent("getAllHtml",u),i.ie&&i.version>8&&(r="",t.each(n.document.styleSheets,function(n){r+=n.href?'<link rel="stylesheet" type="text/css" href="'+n.href+'" />':"<style>"+n.cssText+"<\/style>"}),t.each(n.document.getElementsByTagName("script"),function(n){r+=n.outerHTML})),"<html><head>"+(n.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+n.options.charset+'"/>':"")+(r||n.document.getElementsByTagName("head")[0].innerHTML)+u.join("\n")+"<\/head><body "+(f&&i.version<9?'class="view"':"")+">"+n.getContent(null,null,!0)+"<\/body><\/html>"},getPlainTxt:function(){var i=new RegExp(n.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(n,t,i){return u.$block[i]?"\n":t?t:""}),t.replace(i,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var t=new RegExp(n.fillChar,"g");return this.body[i.ie?"innerText":"textContent"].replace(t,"").replace(/\u00a0/g," ")},setContent:function(t,f,e){function v(n){return n.tagName=="DIV"&&n.getAttribute("cdata_tag")}var s=this,c,o,l,h,a;if(s.fireEvent("beforesetcontent",t),c=UE.htmlparser(t),s.filterInputRule(c),t=c.toHtml(),s.body.innerHTML=(f?s.body.innerHTML:"")+t,s.options.enterTag=="p")if(o=this.body.firstChild,!o||o.nodeType==1&&(u.$cdata[o.tagName]||v(o)||n.isCustomeNode(o))&&o===this.body.lastChild)this.body.innerHTML="<p>"+(i.ie?"&nbsp;":"<br/>")+"<\/p>"+this.body.innerHTML;else for(h=s.document.createElement("p");o;){while(o&&(o.nodeType==3||o.nodeType==1&&u.p[o.tagName]&&!u.$cdata[o.tagName]))l=o.nextSibling,h.appendChild(o),o=l;if(h.firstChild)if(o)o.parentNode.insertBefore(h,o),h=s.document.createElement("p");else{s.body.appendChild(h);break}o=o.nextSibling}s.fireEvent("aftersetcontent"),s.fireEvent("contentchange"),e||s._selectionChange(),s._bakRange=s._bakIERange=s._bakNativeRange=null,i.gecko&&(a=this.selection.getNative())&&a.removeAllRanges(),s.options.autoSyncData&&s.form&&r(s.form,s)},focus:function(n){try{var t=this,i=t.selection.getRange();n?i.setStartAtLast(t.body.lastChild).setCursor(!1,!0):i.select(!0),this.fireEvent("focus")}catch(r){}},_initEvents:function(){var i=this,r=i.document,u=i.window;i._proxyDomEvent=t.bind(i._proxyDomEvent,i);n.on(r,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],i._proxyDomEvent);n.on(u,["focus","blur"],i._proxyDomEvent);n.on(r,["mouseup","keydown"],function(n){n.type=="keydown"&&(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey)||n.button!=2&&i._selectionChange(250,n)})},_proxyDomEvent:function(n){return this.fireEvent(n.type.replace(/^on/,""),n)},_selectionChange:function(n,t){var r=this,u=!1,f,e,s;i.ie&&i.version<9&&t&&t.type=="mouseup"&&(s=this.selection.getRange(),s.collapsed||(u=!0,f=t.clientX,e=t.clientY)),clearTimeout(o),o=setTimeout(function(){var n,i;if(r.selection.getNative()){if(u&&r.selection.getNative().type=="None"){n=r.document.body.createTextRange();try{n.moveToPoint(f,e)}catch(o){n=null}}n&&(i=r.selection.getIERange,r.selection.getIERange=function(){return n}),r.selection.cache(),i&&(r.selection.getIERange=i),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!t),r.fireEvent("afterselectionchange"),r.selection.clear())}},n||50)},_callCmdFn:function(n,t){var u=t[0].toLowerCase(),i,r;if(i=this.commands[u]||UE.commands[u],r=i&&i[n],i&&r||n!="queryCommandState"){if(r)return r.apply(this,t)}else return 0},execCommand:function(n){n=n.toLowerCase();var t=this,i,r=t.commands[n]||UE.commands[n];return!r||!r.execCommand?null:(r.notNeedUndo||t.__hasEnterExecCommand?(i=this._callCmdFn("execCommand",arguments),t._ignoreContentChange||t.fireEvent("contentchange")):(t.__hasEnterExecCommand=!0,t.queryCommandState.apply(t,arguments)!=-1&&(t.fireEvent("beforeexeccommand",n),i=this._callCmdFn("execCommand",arguments),t._ignoreContentChange||t.fireEvent("contentchange"),t.fireEvent("afterexeccommand",n)),t.__hasEnterExecCommand=!1),t._ignoreContentChange||t._selectionChange(),i)},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(t){var i,r,u,f,e;if(t)for(i=0;r=t[i++];)if(this.document.getElementsByTagName(r).length>0)return!0;if(!n.isEmptyBlock(this.body))return!0;for(t=["div"],i=0;r=t[i++];)for(u=n.getElementsByTagName(this.document,r),f=0;e=u[f++];)if(n.isCustomeNode(e))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var n=this,t;if(n.body.contentEditable=="false"){n.body.contentEditable=!0,t=n.selection.getRange();try{t.moveToBookmark(n.lastBk),delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}t.select(!0),n.bkqueryCommandState&&(n.queryCommandState=n.bkqueryCommandState,delete n.bkqueryCommandState),n.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(n){var i=this;n=n?t.isArray(n)?n:[n]:[],i.body.contentEditable=="true"&&(i.lastBk||(i.lastBk=i.selection.getRange().createBookmark(!0)),i.body.contentEditable=!1,i.bkqueryCommandState=i.queryCommandState,i.queryCommandState=function(r){return t.indexOf(n,r)!=-1?i.bkqueryCommandState.apply(i,arguments):-1},i.fireEvent("selectionchange"))},disable:function(n){return this.setDisabled(n)},_setDefaultContent:function(){function n(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(f?"":"<br/>")+"<\/p>",t.removeListener("firstBeforeExecCommand focus",n),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var i=this;i.body.innerHTML='<p id="initContent">'+t+"<\/p>",i.addListener("firstBeforeExecCommand focus",n)}}(),setShow:function(){var n=this,t=n.selection.getRange();if(n.container.style.display=="none"){try{t.moveToBookmark(n.lastBk),delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),n.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var n=this;n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0)),n.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(n){var t=UE.I18N[this.options.lang],i,r;if(!t)throw Error("not import language file");for(n=(n||"").split("."),i=0;r=n[i++];)if(t=t[r],!t)break;return t},getContentLength:function(n,t){var i=this.getContent(!1,!1,!0).length,r,u;if(n)for(t=(t||[]).concat(["hr","img","iframe"]),i=this.getContentTxt().replace(/[\t\r\n]+/g,"").length,r=0;u=t[r++];)i+=this.document.getElementsByTagName(u).length;return i},addInputRule:function(n){this.inputRules.push(n)},filterInputRule:function(n){for(var i=0,t;t=this.inputRules[i++];)t.call(this,n)},addOutputRule:function(n){this.outputRules.push(n)},filterOutputRule:function(n){for(var i=0,t;t=this.outputRules[i++];)t.call(this,n)}},t.inherits(c,s)}(),UE.ajax=function(){function r(n){var i=[],t;for(t in n)t!="method"&&t!="timeout"&&t!="async"&&((typeof n[t]).toLowerCase()=="function"||(typeof n[t]).toLowerCase()=="object"||i.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t])));return i.join("&")}var n="XMLHttpRequest()",i;try{new ActiveXObject("Msxml2.XMLHTTP"),n="ActiveXObject('Msxml2.XMLHTTP')"}catch(u){try{new ActiveXObject("Microsoft.XMLHTTP"),n="ActiveXObject('Microsoft.XMLHTTP')"}catch(u){}}return i=new Function("return new "+n),{request:function(n,u){var f=i(),h=!1,c={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}},e,o;if(typeof n=="object"&&(u=n,n=u.url),f&&n){e=u?t.extend(c,u):c,o=r(e),t.isEmptyObject(e.data)||(o+=(o?"&":"")+r(e.data));var l=setTimeout(function(){f.readyState!=4&&(h=!0,f.abort(),clearTimeout(l))},e.timeout),s=e.method.toUpperCase(),a=n+(n.indexOf("?")==-1?"?":"&")+(s=="POST"?"":o+"&noCache="+ +new Date);f.open(s,a,e.async),f.onreadystatechange=function(){if(f.readyState==4)if(h||f.status!=200)e.onerror(f);else e.onsuccess(f)},s=="POST"?(f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.send(o)):f.send(null)}}}}(),y=UE.filterWord=function(){function r(n){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(n)}function n(n){return n.replace(/[\d.]+\w+/g,function(n){return t.transUnitToPx(n)})}function u(r){return r.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(t){if(i.opera)return"";try{var r=t.match(/width:([ \d.]*p[tx])/i)[1],u=t.match(/height:([ \d.]*p[tx])/i)[1],f=t.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+n(r)+'" height="'+n(u)+'" src="'+f+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(n,t,i,r){return t=="class"&&r=="MsoListParagraph"?n:""}).replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(t,i,r,u){for(var o=[],l=u.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g),c,s,f,h,e=0;c=l[e];e++)if(h=c.split(":"),h.length==2){if(s=h[0].toLowerCase(),f=h[1].toLowerCase(),/^(background)\w*/.test(s)&&f.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(s)&&/^0\w+$/.test(f))continue;switch(s){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(i)||(o[e]=s.replace(/^mso-|-alt$/g,"")+":"+n(f));continue;case"horiz-align":o[e]="text-align:"+f;continue;case"vert-align":o[e]="vertical-align:"+f;continue;case"font-color":case"mso-foreground":o[e]="color:"+f;continue;case"mso-background":case"mso-highlight":o[e]="background:"+f;continue;case"mso-default-height":o[e]="min-height:"+n(f);continue;case"mso-default-width":o[e]="min-width:"+n(f);continue;case"mso-padding-between-alt":o[e]="border-collapse:separate;border-spacing:"+n(f);continue;case"text-line-through":(f=="single"||f=="double")&&(o[e]="text-decoration:line-through");continue;case"mso-zero-height":f=="yes"&&(o[e]="display:none");continue;case"margin":if(!/[1-9]/.test(f))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(s)||/text\-indent|padding|margin/.test(s)&&/\-[\d.]+/.test(f))continue;o[e]=s+":"+h[1]}return i+(o.length?' style="'+o.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(n){return t.transUnitToPx(n)})}return function(n){return r(n)?u(n):n}}(),function(){function i(n,t,i){return n.push(c),t+(i?1:-1)}function r(n,t){for(var i=0;i<t;i++)n.push(h)}function f(n,t,e,o){switch(n.type){case"root":for(var h=0,s;s=n.children[h++];)e&&s.type=="element"&&!u.$inlineWithA[s.tagName]&&h>1&&(i(t,o,!0),r(t,o)),f(s,t,e,o);break;case"text":l(n,t);break;case"element":a(n,t,e,o);break;case"comment":v(n,t,e)}return t}function l(n,t){t.push(n.parentNode.tagName=="pre"?n.data:n.data.replace(/[ ]{2}/g," &nbsp;"))}function a(n,e,o,s){var h="",c,l,v,a;if(n.attrs){h=[],c=n.attrs;for(l in c)h.push(l+(c[l]!==undefined?'="'+t.unhtml(c[l])+'"':""));h=h.join(" ")}if(e.push("<"+n.tagName+(h?" "+h:"")+(u.$empty[n.tagName]?"/":"")+">"),o&&!u.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(s=i(e,s,!0),r(e,s)),n.children&&n.children.length)for(v=0;a=n.children[v++];)o&&a.type=="element"&&!u.$inlineWithA[a.tagName]&&v>1&&(i(e,s),r(e,s)),f(a,e,o,s);u.$empty[n.tagName]||(o&&!u.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(s=i(e,s),r(e,s)),e.push("<\/"+n.tagName+">"))}function v(n,t){t.push("<!--"+n.data+"-->")}function e(n,t){var i,r,u;if(n.type=="element"&&n.getAttr("id")==t)return n;if(n.children&&n.children.length)for(r=0;u=n.children[r++];)if(i=e(u,t))return i}function o(n,t,i){if(n.type=="element"&&n.tagName==t&&i.push(n),n.children&&n.children.length)for(var u=0,r;r=n.children[u++];)o(r,t,i)}function s(n,t){if(n.children&&n.children.length)for(var r=0,i;i=n.children[r];)s(i,t),i.parentNode&&(i.children&&i.children.length&&t(i),i.parentNode&&r++);else t(n)}var n=UE.uNode=function(n){this.type=n.type,this.data=n.data,this.tagName=n.tagName,this.parentNode=n.parentNode,this.attrs=n.attrs||{},this.children=n.children},h="    ",c="\n";n.createElement=function(t){return/[<>]/.test(t)?UE.htmlparser(t).children[0]:new n({type:"element",children:[],tagName:t})},n.createText=function(n){return new UE.uNode({type:"text",data:t.unhtml(n||"")})},n.prototype={toHtml:function(n){var t=[];return f(this,t,n,0),t.join("")},innerHTML:function(n){var i,r,f;if(this.type!="element"||u.$empty[this.tagName])return this;if(t.isString(n)){if(this.children)for(i=0;r=this.children[i++];)r.parentNode=null;for(this.children=[],f=UE.htmlparser(n),i=0;r=f.children[i++];)this.children.push(r),r.parentNode=this;return this}return f=new UE.uNode({type:"root",children:this.children}),f.toHtml()},innerText:function(t){if(this.type!="element"||u.$empty[this.tagName])return this;if(t){if(this.children)for(var r=0,i;i=this.children[r++];)i.parentNode=null;return this.children=[],this.appendChild(n.createText(t)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return this.type=="element"?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var t=this.parentNode,i,n=0;i=t.children[n];n++)if(i===this)return n==0?null:t.children[n-1]},nextSibling:function(){for(var t=this.parentNode,i,n=0;i=t.children[n++];)if(i===this)return t.children[n]},replaceChild:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,1,n),t.parentNode=null,n.parentNode=this,n}},appendChild:function(n){if(this.type=="root"||this.type=="element"&&!u.$empty[this.tagName]){this.children||(this.children=[]),n.parentNode&&n.parentNode.removeChild(n);for(var t=0,i;i=this.children[t];t++)if(i===n){this.children.splice(t,1);break}return this.children.push(n),n.parentNode=this,n}},insertBefore:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,0,n),n.parentNode=this,n}},insertAfter:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i+1,0,n),n.parentNode=this,n}},removeChild:function(n,t){var r,i,u,f;if(this.children)for(r=0;i=this.children[r];r++)if(i===n){if(this.children.splice(r,1),i.parentNode=null,t&&i.children&&i.children.length)for(u=0;f=i.children[u];u++)this.children.splice(r+u,0,f),f.parentNode=this;return i}},getAttr:function(n){return this.attrs&&this.attrs[n.toLowerCase()]},setAttr:function(n,i){if(!n){delete this.attrs;return}if(this.attrs||(this.attrs={}),t.isObject(n))for(var r in n)n[r]?this.attrs[r.toLowerCase()]=n[r]:delete this.attrs[r];else i?this.attrs[n.toLowerCase()]=i:delete this.attrs[n]},getIndex:function(){for(var i=this.parentNode,t,n=0;t=i.children[n];n++)if(t===this)return n;return-1},getNodeById:function(n){var t,i,r;if(this.children&&this.children.length)for(i=0;r=this.children[i++];)if(t=e(r,n))return t},getNodesByTagName:function(n){n=t.trim(n).replace(/[ ]{2,}/g," ").split(" ");var r=[],i=this;return t.each(n,function(n){if(i.children&&i.children.length)for(var u=0,t;t=i.children[u++];)o(t,n,r)}),r},getStyle:function(n){var i=this.getAttr("style"),r,t;return i?(r=new RegExp(n+":([^;]+)","i"),t=i.match(r),t&&t[0])?t[1]:"":""},setStyle:function(n,i){function f(n,i){var u=new RegExp(n+":([^;]+;?)","gi");r=r.replace(u,""),i&&(r=n+":"+t.unhtml(i)+";"+r)}var r=this.getAttr("style"),u;if(r||(r=""),t.isObject(n))for(u in n)f(u,n[u]);else f(n,i);this.setAttr("style",t.trim(r))},traversal:function(n){return this.children&&this.children.length&&s(this,n),this}}}(),p=UE.htmlparser=function(i,r){function a(n,t){if(l[n.tagName]){var i=o.createElement(l[n.tagName]);n.appendChild(i),i.appendChild(o.createText(t)),n=i}else n.appendChild(o.createText(t))}function v(n,i,r){var f,e,l,h,c,s;if(f=k[i]){for(e=n;e.type!="root";){if(t.isArray(f)?t.indexOf(f,e.tagName)!=-1:f==e.tagName){n=e,l=!0;break}e=e.parentNode}l||(n=v(n,t.isArray(f)?f[0]:f))}if(h=new o({parentNode:n,type:"element",tagName:i.toLowerCase(),children:u.$empty[i]?null:[]}),r){for(c={};s=w.exec(r);)c[s[1].toLowerCase()]=t.unhtml(s[2]||s[3]||s[4]);h.attrs=c}return n.children.push(h),u.$empty[i]?n:h}function d(n,t){n.children.push(new o({type:"comment",data:t,parentNode:n}))}var c=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,w=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,b={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1},p;i=i.replace(new RegExp(n.fillChar,"g"),""),r||(i=i.replace(new RegExp("[\\r\\t\\n"+(r?"":" ")+"]*<\/?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(r?"":" ")+"]*","g"),function(n,t){return t&&b[t.toLowerCase()]?n.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):n.replace(new RegExp("^[\\r\\n"+(r?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(r?"":" ")+"]+$"),"")}));for(var o=UE.uNode,k={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},l={ol:"li",ul:"li"},e,h=0,s=0,y=new o({type:"root",children:[]}),f=y;e=c.exec(i);){h=e.index;try{if(h>s&&a(f,i.slice(s,h)),e[3])f=v(f,e[3].toLowerCase(),e[4]);else if(e[1]){if(f.type!="root"){for(p=f;f.type=="element"&&f.tagName!=e[1].toLowerCase();)if(f=f.parentNode,f.type=="root"){f=p;throw"break";}f=f.parentNode}}else e[2]&&d(f,e[2])}catch(g){}s=c.lastIndex}return s<i.length&&a(f,i.slice(s)),y},w=UE.filterNode=function(){function n(i,r){var s,l,v,a,o,y,h,c,f,e;switch(i.type){case"element":if(s=r[i.tagName])if(s==="-")i.parentNode.removeChild(i);else if(t.isFunction(s))if(h=i.parentNode,c=i.getIndex(),s(i),i.parentNode){if(i.children)for(f=0;e=i.children[f];)n(e,r),e.parentNode&&f++}else for(f=c;e=h.children[f];)n(e,r),e.parentNode&&f++;else{if(l=s.$,l&&i.attrs){v={};for(o in l)a=i.getAttr(o),o=="style"&&t.isArray(l[o])&&(y=[],t.each(l[o],function(n){var t;(t=i.getStyle(n))&&y.push(n+":"+t)}),a=y.join(";")),a&&(v[o]=a);i.attrs=v}if(i.children)for(f=0;e=i.children[f];)n(e,r),e.parentNode&&f++}else if(u.$cdata[i.tagName])i.parentNode.removeChild(i);else for(h=i.parentNode,c=i.getIndex(),i.parentNode.removeChild(i,!0),f=c;e=h.children[f];)n(e,r),e.parentNode&&f++;break;case"comment":i.parentNode.removeChild(i)}}return function(i,r){var e,u,f;if(t.isEmptyObject(r))return i;for((e=r["-"])&&t.each(e.split(" "),function(n){r[n]="-"}),u=0;f=i.children[u];)n(f,r),f.parentNode&&u++;return i}}(),UE.plugins.defaultfilter=function(){var n=this;n.setOpt("allowDivTransToP",!0),n.addInputRule(function(r){var e=this.options.allowDivTransToP,f;r.traversal(function(r){var s,o,h,c;if(r.type=="element"){if(!u.$cdata[r.tagName]&&n.options.autoClearEmptyNode&&u.$inline[r.tagName]&&!u.$empty[r.tagName]&&(!r.attrs||t.isEmptyObject(r.attrs))){r.firstChild()?r.tagName=="span"&&(!r.attrs||t.isEmptyObject(r.attrs))&&r.parentNode.removeChild(r,!0):r.parentNode.removeChild(r);return}switch(r.tagName){case"style":case"script":r.setAttr({cdata_tag:r.tagName,cdata_data:encodeURIComponent(r.innerText()||"")}),r.tagName="div",r.removeChild(r.firstChild());break;case"a":(f=r.getAttr("href"))&&r.setAttr("_href",f);break;case"img":if((f=r.getAttr("src"))&&/^data:/.test(f)){r.parentNode.removeChild(r);break}r.setAttr("_src",r.getAttr("src"));break;case"span":i.webkit&&(f=r.getStyle("white-space"))&&/nowrap|normal/.test(f)&&(r.setStyle("white-space",""),n.options.autoClearEmptyNode&&t.isEmptyObject(r.attrs)&&r.parentNode.removeChild(r,!0));break;case"p":(f=r.getAttr("align"))&&(r.setAttr("align"),r.setStyle("text-align",f)),r.firstChild()||r.innerHTML(i.ie?"&nbsp;":"<br/>");break;case"div":if(r.getAttr("cdata_tag"))break;if(f=r.getAttr("class"),f&&/^line number\d+/.test(f))break;if(!e)break;for(o=UE.uNode.createElement("p");s=r.firstChild();)s.type!="text"&&UE.dom.dtd.$block[s.tagName]?o.firstChild()?(r.parentNode.insertBefore(o,r),o=UE.uNode.createElement("p")):r.parentNode.insertBefore(s,r):o.appendChild(s);o.firstChild()&&r.parentNode.insertBefore(o,r),r.parentNode.removeChild(r);break;case"dl":r.tagName="ul";break;case"dt":case"dd":r.tagName="li";break;case"li":h=r.getAttr("class"),h&&/list\-/.test(h)||r.setAttr(),c=r.getNodesByTagName("ol ul"),UE.utils.each(c,function(n){r.parentNode.insertAfter(n,r)});break;case"td":case"th":case"caption":r.children&&r.children.length||r.appendChild(i.ie?UE.uNode.createText(" "):UE.uNode.createElement("br"))}}r.type=="comment"&&r.parentNode.removeChild(r)})}),n.addOutputRule(function(i){var r;i.traversal(function(i){if(i.type=="element"){if(n.options.autoClearEmptyNode&&u.$inline[i.tagName]&&!u.$empty[i.tagName]&&(!i.attrs||t.isEmptyObject(i.attrs))){i.firstChild()?i.tagName=="span"&&(!i.attrs||t.isEmptyObject(i.attrs))&&i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i);return}switch(i.tagName){case"div":(r=i.getAttr("cdata_tag"))&&(i.tagName=r,i.appendChild(UE.uNode.createText(i.getAttr("cdata_data"))),i.setAttr({cdata_tag:"",cdata_data:""}));break;case"a":(r=i.getAttr("_href"))&&i.setAttr({href:r,_href:""});break;case"img":(r=i.getAttr("_src"))&&i.setAttr({src:i.getAttr("_src"),_src:""})}}})})},UE.commands.inserthtml={execCommand:function(r,f,e){var l=this,h,b,g,c,s,w,k,nt,y,p,d,tt,it,v,a;if(f&&l.fireEvent("beforeinserthtml",f)!==!0){if(h=l.selection.getRange(),b=h.document.createElement("div"),b.style.display="inline",e||(g=UE.htmlparser(f),l.options.filterRules&&UE.filterNode(g,l.options.filterRules),l.filterInputRule(g),f=g.toHtml()),b.innerHTML=t.trim(f),!h.collapsed&&(c=h.startContainer,n.isFillChar(c)&&h.setStartBefore(c),c=h.endContainer,n.isFillChar(c)&&h.setEndAfter(c),h.txtToElmBoundary(),h.endContainer&&h.endContainer.nodeType==1&&(c=h.endContainer.childNodes[h.endOffset],c&&n.isBr(c)&&h.setEndAfter(c)),h.startOffset==0&&(c=h.startContainer,n.isBoundaryNode(c,"firstChild")&&(c=h.endContainer,h.endOffset==(c.nodeType==3?c.nodeValue.length:c.childNodes.length)&&n.isBoundaryNode(c,"lastChild")&&(l.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"<\/p>",h.setStart(l.body.firstChild,0).collapse(!0)))),h.collapsed||h.deleteContents(),h.startContainer.nodeType==1&&(s=h.startContainer.childNodes[h.startOffset],s&&n.isBlockElm(s)&&(v=s.previousSibling)&&n.isBlockElm(v)))){for(h.setEnd(v,v.childNodes.length).collapse();s.firstChild;)v.appendChild(s.firstChild);n.remove(s)}if(nt=0,h.inFillChar()&&(s=h.startContainer,n.isFillChar(s)?(h.setStartBefore(s).collapse(!0),n.remove(s)):n.isFillChar(s,!0)&&(s.nodeValue=s.nodeValue.replace(o,""),h.startOffset--,h.collapsed&&h.collapse(!0))),p=n.findParentByTagName(h.startContainer,"li",!0),p){while(s=b.firstChild){while(s&&(s.nodeType==3||!n.isBlockElm(s)||s.tagName=="HR"))a=s.nextSibling,h.insertNode(s).collapse(),d=s,s=a;if(s)if(/^(ol|ul)$/i.test(s.tagName)){while(s.firstChild)d=s.firstChild,n.insertAfter(p,s.firstChild),p=p.nextSibling;n.remove(s)}else a=s.nextSibling,tt=l.document.createElement("li"),n.insertAfter(p,tt),tt.appendChild(s),d=s,s=a,p=tt}p=n.findParentByTagName(h.startContainer,"li",!0),n.isEmptyBlock(p)&&n.remove(p),d&&h.setStartAfter(d).collapse(!0).select(!0)}else{while(s=b.firstChild){if(nt){for(it=l.document.createElement("p");s&&(s.nodeType==3||!u.$block[s.tagName]);)y=s.nextSibling,it.appendChild(s),s=y;it.firstChild&&(s=it)}if(h.insertNode(s),y=s.nextSibling,!nt&&s.nodeType==n.NODE_ELEMENT&&n.isBlockElm(s)&&(w=n.findParent(s,function(t){return n.isBlockElm(t)}),w&&w.tagName.toLowerCase()!="body"&&!(u[w.tagName][s.nodeName]&&s.parentNode===w))){if(u[w.tagName][s.nodeName])for(k=s.parentNode;k!==w;)v=k,k=k.parentNode;else v=w;n.breakParent(s,v||k),v=s.previousSibling,n.trimWhiteTextNode(v),v.childNodes.length||n.remove(v),!i.ie&&(a=s.nextSibling)&&n.isBlockElm(a)&&a.lastChild&&!n.isBr(a.lastChild)&&a.appendChild(l.document.createElement("br")),nt=1}if(a=s.nextSibling,!b.firstChild&&a&&n.isBlockElm(a)){h.setStart(a,0).collapse(!0);break}h.setEndAfter(s).collapse()}if(s=h.startContainer,y&&n.isBr(y)&&n.remove(y),n.isBlockElm(s)&&n.isEmptyNode(s))if(y=s.nextSibling)n.remove(s),y.nodeType==1&&u.$block[y.tagName]&&h.setStart(y,0).collapse(!0).shrinkBoundary();else try{s.innerHTML=i.ie?n.fillChar:"<br/>"}catch(rt){h.setStartBefore(s),n.remove(s)}try{h.select(!0)}catch(rt){}}setTimeout(function(){h=l.selection.getRange(),h.scrollToView(l.autoHeightEnabled,l.autoHeightEnabled?n.getXY(l.iframe).y:0),l.fireEvent("afterinserthtml")},200)}}},UE.plugins.autotypeset=function(){function o(t,i){return!t||t.nodeType==3?0:n.isBr(t)?1:t&&t.parentNode&&l[t.tagName.toLowerCase()]?f&&f.contains(t)||t.getAttribute("pagebreak")?0:i?!n.isEmptyBlock(t):n.isEmptyBlock(t,new RegExp("[\\s"+n.fillChar+"]","g")):void 0}function s(t){t.style.cssText||(n.removeAttributes(t,["style"]),t.tagName.toLowerCase()=="span"&&n.hasNoAttributes(t)&&n.remove(t,!0))}function e(t,r){var y=this,w,d,g,e,nt,b,v,l,p,a,k,tt;if(r){if(!i.pasteFilter)return;w=y.document.createElement("div"),w.innerHTML=r.html}else w=y.document.body;for(d=n.getElementsByTagName(w,"*"),g=0;e=d[g++];)if(y.fireEvent("excludeNodeinautotype",e)!==!0){if(i.clearFontSize&&e.style.fontSize&&(n.removeStyle(e,"font-size"),s(e)),i.clearFontFamily&&e.style.fontFamily&&(n.removeStyle(e,"font-family"),s(e)),o(e)){if(i.mergeEmptyline)for(a=e.nextSibling,nt=n.isBr(e);o(a);){if(l=a,a=l.nextSibling,nt&&(!a||a&&!n.isBr(a)))break;n.remove(l)}if(i.removeEmptyline&&n.inDoc(e,w)&&!c[e.parentNode.tagName.toLowerCase()]){if(n.isBr(e)&&(a=e.nextSibling,a&&!n.isBr(a)))continue;n.remove(e);continue}}if(o(e,!0)&&e.tagName!="SPAN"&&(i.indent&&(e.style.textIndent=i.indentValue),i.textAlign&&(e.style.textAlign=i.textAlign)),i.removeClass&&e.className&&!h[e.className.toLowerCase()]){if(f&&f.contains(e))continue;n.removeAttributes(e,["class"])}if(i.imageBlockLine&&e.tagName.toLowerCase()=="img"&&!e.getAttribute("emotion"))if(r){b=e;switch(i.imageBlockLine){case"left":case"right":case"none":for(v=b.parentNode;u.$inline[v.tagName]||v.tagName=="A";)v=v.parentNode;if(l=v,l.tagName=="P"&&n.getStyle(l,"text-align")=="center"&&!n.isBody(l)&&n.getChildCount(l,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1)if(p=l.previousSibling,a=l.nextSibling,p&&a&&p.nodeType==1&&a.nodeType==1&&p.tagName==a.tagName&&n.isBlockElm(p)){for(p.appendChild(l.firstChild);a.firstChild;)p.appendChild(a.firstChild);n.remove(l),n.remove(a)}else n.setStyle(l,"text-align","");n.setStyle(b,"float",i.imageBlockLine);break;case"center":if(y.queryCommandValue("imagefloat")!="center"){for(v=b.parentNode,n.setStyle(b,"float","none"),l=b;v&&n.getChildCount(v,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(u.$inline[v.tagName]||v.tagName=="A");)l=v,v=v.parentNode;k=y.document.createElement("p"),n.setAttributes(k,{style:"text-align:center"}),l.parentNode.insertBefore(k,l),k.appendChild(l),n.setStyle(l,"float","")}}}else tt=y.selection.getRange(),tt.selectNode(e).select(),y.execCommand("imagefloat",i.imageBlockLine);i.removeEmptyNode&&i.removeTagNames[e.tagName.toLowerCase()]&&n.hasNoAttributes(e)&&n.isEmptyBlock(e)&&n.remove(e)}r&&(r.html=w.innerHTML)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:t.extend({div:1},u.$removeEmpty),indent:!1,indentValue:"2em"}});var r=this,i=r.options.autotypeset,h={selectTdClass:1,pagebreak:1,anchorclass:1},c={li:1},l={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},f;i&&(i.pasteFilter&&r.addListener("beforepaste",e),r.commands.autotypeset={execCommand:function(){r.removeListener("beforepaste",e),i.pasteFilter&&r.addListener("beforepaste",e),e.call(r)}})},UE.plugins.autosubmit=function(){var t=this;t.commands.autosubmit={execCommand:function(){var t=this,i=n.findParentByTagName(t.iframe,"form",!1);if(i){if(t.fireEvent("beforesubmit")===!1)return;t.sync(),i.submit()}}},t.addshortcutkey({autosubmit:"ctrl+13"})},UE.plugins.background=function(){var t=this;t.addListener("getAllHtml",function(r,u){var f=this.body,e=n.getComputedStyle(f,"background-image"),c="",o,s,h;c=e.indexOf(t.options.imagePath)>0?e.substring(e.indexOf(t.options.imagePath),e.length-1).replace(/"|\(|\)/ig,""):e!="none"?e.replace(/url\("?|"?\)/ig,""):"",o='<style type="text/css">body{',s={"background-color":n.getComputedStyle(f,"background-color")||"#ffffff","background-image":c?"url("+c+")":"","background-repeat":n.getComputedStyle(f,"background-repeat")||"","background-position":i.ie?n.getComputedStyle(f,"background-position-x")+" "+n.getComputedStyle(f,"background-position-y"):n.getComputedStyle(f,"background-position"),height:n.getComputedStyle(f,"height")};for(h in s)s.hasOwnProperty(h)&&(o+=h+":"+s[h]+";");o+="}<\/style> ",u.push(o)})},UE.commands.imagefloat={execCommand:function(t,i){var h=this,c=h.selection.getRange(),e,f,r,s,o;if(!c.collapsed&&(e=c.getClosedNode(),e&&e.tagName=="IMG"))switch(i){case"left":case"right":case"none":for(f=e.parentNode;u.$inline[f.tagName]||f.tagName=="A";)f=f.parentNode;if(r=f,r.tagName=="P"&&n.getStyle(r,"text-align")=="center"){if(!n.isBody(r)&&n.getChildCount(r,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1)if(s=r.previousSibling,o=r.nextSibling,s&&o&&s.nodeType==1&&o.nodeType==1&&s.tagName==o.tagName&&n.isBlockElm(s)){for(s.appendChild(r.firstChild);o.firstChild;)s.appendChild(o.firstChild);n.remove(r),n.remove(o)}else n.setStyle(r,"text-align","");c.selectNode(e).select()}n.setStyle(e,"float",i=="none"?"":i),i=="none"&&n.removeAttributes(e,"align");break;case"center":if(h.queryCommandValue("imagefloat")!="center"){for(f=e.parentNode,n.setStyle(e,"float",""),n.removeAttributes(e,"align"),r=e;f&&n.getChildCount(f,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(u.$inline[f.tagName]||f.tagName=="A");)r=f,f=f.parentNode;c.setStartBefore(r).setCursor(!1),f=h.document.createElement("div"),f.appendChild(r),n.setStyle(r,"float",""),h.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+f.innerHTML+"<\/p>"),r=h.document.getElementById("_img_parent_tmp"),r.removeAttribute("id"),r=r.firstChild,c.selectNode(r).select(),o=r.parentNode.nextSibling,o&&n.isEmptyNode(o)&&n.remove(o)}}},queryCommandValue:function(){var r=this.selection.getRange(),t,i;return r.collapsed?"none":(t=r.getClosedNode(),t&&t.nodeType==1&&t.tagName=="IMG")?(i=t.getAttribute("align")||n.getComputedStyle(t,"float"),i=="none"&&(i=n.getComputedStyle(t.parentNode,"text-align")=="center"?"center":i),{left:1,right:1,center:1}[i]?i:"none"):"none"},queryCommandState:function(){var t=this.selection.getRange(),n;return t.collapsed?-1:(n=t.getClosedNode(),n&&n.nodeType==1&&n.tagName=="IMG")?0:-1}},UE.commands.insertimage={execCommand:function(i,r){var s,l,h,f,u,a;if(r=t.isArray(r)?r:[r],r.length){var o=this,c=o.selection.getRange(),e=c.getClosedNode();if(e&&/img/i.test(e.tagName)&&e.className!="edui-faked-video"&&!e.getAttribute("word_img"))s=r.shift(),l=s.floatStyle,delete s.floatStyle,n.setAttributes(e,s),o.execCommand("imagefloat",l),r.length>0&&(c.setStartAfter(e).setCursor(!1,!0),o.execCommand("insertimage",r));else{if(h=[],f="",u=r[0],r.length==1)f='<img src="'+u.src+'" '+(u._src?' _src="'+u._src+'" ':"")+(u.width?'width="'+u.width+'" ':"")+(u.height?' height="'+u.height+'" ':"")+(u.floatStyle=="left"||u.floatStyle=="right"?' style="float:'+u.floatStyle+';"':"")+(u.title&&u.title!=""?' title="'+u.title+'"':"")+(u.border&&u.border!="0"?' border="'+u.border+'"':"")+(u.alt&&u.alt!=""?' alt="'+u.alt+'"':"")+(u.hspace&&u.hspace!="0"?' hspace = "'+u.hspace+'"':"")+(u.vspace&&u.vspace!="0"?' vspace = "'+u.vspace+'"':"")+"/>",u.floatStyle=="center"&&(f='<p style="text-align: center">'+f+"<\/p>"),h.push(f);else for(a=0;u=r[a++];)f="<p "+(u.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+u.src+'" '+(u.width?'width="'+u.width+'" ':"")+(u._src?' _src="'+u._src+'" ':"")+(u.height?' height="'+u.height+'" ':"")+' style="'+(u.floatStyle&&u.floatStyle!="center"?"float:"+u.floatStyle+";":"")+(u.border||"")+'" '+(u.title?' title="'+u.title+'"':"")+" /><\/p>",h.push(f);o.execCommand("insertHtml",h.join(""))}}}},UE.plugins.justify=function(){var f=this,i=n.isBlockElm,r={left:1,right:1,center:1,justify:1},u=function(r,u){var v=r.createBookmark(),c=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},o,s,a;r.enlarge(!0);for(var h=r.createBookmark(),f=n.getNextDomNode(h.start,!1,c),e=r.cloneRange(),l;f&&!(n.getPosition(f,h.end)&n.POSITION_FOLLOWING);)if(f.nodeType!=3&&i(f))f=n.getNextDomNode(f,!0,c);else{for(e.setStartBefore(f);f&&f!==h.end&&!i(f);)l=f,f=n.getNextDomNode(f,!1,null,function(n){return!i(n)});e.setEndAfter(l),o=e.getCommonAncestor(),!n.isBody(o)&&i(o)?(n.setStyles(o,t.isString(u)?{"text-align":u}:u),f=o):(s=r.document.createElement("p"),n.setStyles(s,t.isString(u)?{"text-align":u}:u),a=e.extractContents(),s.appendChild(a),e.insertNode(s),f=s),f=n.getNextDomNode(f,!1,c)}return r.moveToBookmark(h).moveToBookmark(v)};UE.commands.justify={execCommand:function(t,i){var r=this.selection.getRange(),f;return r.collapsed&&(f=this.document.createTextNode("p"),r.insertNode(f)),u(r,i),f&&(r.setStartBefore(f).collapse(!0),n.remove(f)),r.select(),!0},queryCommandValue:function(){var i=this.selection.getStart(),t=n.getComputedStyle(i,"text-align");return r[t]?t:"left"},queryCommandState:function(){var t=this.selection.getStart(),i=t&&n.findParentByTagName(t,["td","th","caption"],!0);return i?-1:0}}},UE.plugins.font=function(){function l(t){for(var i;i=t.parentNode;)if(i.tagName=="SPAN"&&n.getChildCount(i,function(t){return!n.isBookmarkNode(t)&&!n.isBr(t)})==1)i.style.cssText+=t.style.cssText,n.remove(t,!0),t=i;else break}function v(i,r,u){var f,e;c[r]&&(i.adjustmentBoundary(),i.collapsed||i.startContainer.nodeType!=1||(f=i.startContainer.childNodes[i.startOffset],f&&n.isTagNode(f,"span")&&(e=i.createBookmark(),t.each(n.getElementsByTagName(f,"span"),function(t){t.parentNode&&!n.isBookmarkNode(t)&&(r!="backcolor"||n.getComputedStyle(t,"background-color").toLowerCase()!==u)&&(n.removeStyle(t,c[r]),t.style.cssText.replace(/^\s+$/,"").length==0&&n.remove(t,!0))}),i.moveToBookmark(e))))}function f(r,f,e){var h=r.collapsed,s=r.createBookmark(),o;if(h)for(o=s.start.parentNode;u.$inline[o.tagName];)o=o.parentNode;else o=n.getCommonAncestor(s.start,s.end);t.each(n.getElementsByTagName(o,"span"),function(t){var r,u;if(t.parentNode&&!n.isBookmarkNode(t)){if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText)){/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?n.remove(t,!0):n.removeStyle(t,"border");return}if(/border/i.test(t.style.cssText)&&t.parentNode.tagName=="SPAN"&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),!(f=="fontborder"&&e=="none"))for(r=t.nextSibling;r&&r.nodeType==1&&r.tagName=="SPAN";){if(n.isBookmarkNode(r)&&f=="fontborder"){t.appendChild(r),r=t.nextSibling;continue}if(r.style.cssText==t.style.cssText&&(n.moveChild(r,t),n.remove(r)),t.nextSibling===r)break;r=t.nextSibling}l(t),i.ie&&i.version>8&&(u=n.findParent(t,function(n){return n.tagName=="SPAN"&&/background-color/.test(n.style.cssText)}),u&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=u.style.backgroundColor))}}),r.moveToBookmark(s),v(r,f,e)}var s=this,h={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},r={underline:1,strikethrough:1,fontborder:1},c={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"},e;s.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),s.addInputRule(function(n){t.each(n.getNodesByTagName("u s del font strike"),function(n){var t,i,r;if(n.tagName=="font"){t=[];for(i in n.attrs)switch(i){case"size":t.push("font-size:"+n.attrs[i]+"px");break;case"color":t.push("color:"+n.attrs[i]);break;case"face":t.push("font-family:"+n.attrs[i]);break;case"style":t.push(n.attrs[i])}n.attrs={style:t.join(";")}}else r=n.tagName=="u"?"underline":"line-through",n.attrs={style:(n.getAttr("style")||"")+"text-decoration:"+r+";"};n.tagName="span"})});for(e in h)(function(t,e){UE.commands[t]={execCommand:function(u,s){var v,h,c,l,y;if(s=s||(this.queryCommandState(u)?"none":u=="underline"?"underline":u=="fontborder"?"1px solid #000":"line-through"),v=this,h=this.selection.getRange(),s=="default")h.collapsed&&(c=v.document.createTextNode("font"),h.insertNode(c).select()),v.execCommand("removeFormat","span,a",e),c&&(h.setStartBefore(c).collapse(!0),n.remove(c)),f(h,u,s),h.select();else if(h.collapsed){if(l=n.findParentByTagName(h.startContainer,"span",!0),c=v.document.createTextNode("font"),!l||l.children.length||l[i.ie?"innerText":"textContent"].replace(o,"").length){if(h.insertNode(c),h.selectNode(c).select(),l=h.document.createElement("span"),r[t]){if(n.findParentByTagName(c,"a",!0)){h.setStartBefore(c).setCursor(),n.remove(c);return}v.execCommand("removeFormat","span,a",e)}if(l.style.cssText=e+":"+s,c.parentNode.insertBefore(l,c),!i.ie||i.ie&&i.version==9)for(y=l.parentNode;!n.isBlockElm(y);)y.tagName=="SPAN"&&(l.style.cssText=y.style.cssText+";"+l.style.cssText),y=y.parentNode;a?setTimeout(function(){h.setStart(l,0).collapse(!0),f(h,u,s),h.select()}):(h.setStart(l,0).collapse(!0),f(h,u,s),h.select())}else h.insertNode(c),r[t]&&(h.selectNode(c).select(),v.execCommand("removeFormat","span,a",e,null),l=n.findParentByTagName(c,"span",!0),h.setStartBefore(c)),l&&(l.style.cssText+=";"+e+":"+s),h.collapse(!0).select();n.remove(c)}else r[t]&&v.queryCommandValue(t)&&v.execCommand("removeFormat","span,a",e),h=v.selection.getRange(),h.applyInlineStyle("span",{style:e+":"+s}),f(h,u,s),h.select();return!0},queryCommandValue:function(t){var f=this.selection.getStart(),r,s,o,h,i;if(t=="underline"||t=="strikethrough"){for(r=f;r&&!n.isBlockElm(r)&&!n.isBody(r);){if(r.nodeType==1&&(s=n.getComputedStyle(r,e),s!="none"))return s;r=r.parentNode}return"none"}if(t=="fontborder"){for(i=f;i&&u.$inline[i.tagName];){if((o=n.getComputedStyle(i,"border"))&&/1px/.test(o)&&/solid/.test(o))return o;i=i.parentNode}return""}return t=="FontSize"?(h=n.getComputedStyle(f,e),i=/^([\d\.]+)(\w+)$/.exec(h),i)?Math.floor(i[1])+i[2]:h:n.getComputedStyle(f,e)},queryCommandState:function(n){if(!r[n])return 0;var t=this.queryCommandValue(n);return n=="fontborder"?/1px/.test(t)&&/solid/.test(t):t==(n=="underline"?"underline":"line-through")}}})(e,h[e])},UE.plugins.link=function(){function r(t){var i=t.startContainer,r=t.endContainer;(i=n.findParentByTagName(i,"a",!0))&&t.setStartBefore(i),(r=n.findParentByTagName(r,"a",!0))&&t.setEndAfter(r)}function u(u,f,e){var s=u.cloneRange(),l=e.queryCommandValue("link"),o,h,c;r(u=u.adjustmentBoundary()),o=u.startContainer,o.nodeType==1&&l&&(o=o.childNodes[u.startOffset],o&&o.nodeType==1&&o.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(o[i.ie?"innerText":"textContent"])&&(o[i.ie?"innerText":"textContent"]=t.html(f.textValue||f.href))),(!s.collapsed||l)&&(u.removeInlineStyle("a"),s=u.cloneRange()),s.collapsed?(h=u.document.createElement("a"),c="",f.textValue?(c=t.html(f.textValue),delete f.textValue):c=t.html(f.href),n.setAttributes(h,f),o=n.findParentByTagName(s.startContainer,"a",!0),o&&n.isInNodeEndBoundary(s,o)&&u.setStartAfter(o).collapse(!0),h[i.ie?"innerText":"textContent"]=c,u.insertNode(h).selectNode(h)):u.applyInlineStyle("a",f)}UE.commands.unlink={execCommand:function(){var t=this.selection.getRange(),i;(!t.collapsed||n.findParentByTagName(t.startContainer,"a",!0))&&(i=t.createBookmark(),r(t),t.removeInlineStyle("a").moveToBookmark(i).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={execCommand:function(n,i){var r;i._href&&(i._href=t.unhtml(i._href,/[<">]/g)),i.href&&(i.href=t.unhtml(i.href,/[<">]/g)),i.textValue&&(i.textValue=t.unhtml(i.textValue,/[<">]/g)),u(r=this.selection.getRange(),i,this),r.collapse().select(!0)},queryCommandValue:function(){var t=this.selection.getRange(),i,o,f,e,s,r;if(t.collapsed){if(i=t.startContainer,i=i.nodeType==1?i:i.parentNode,i&&(i=n.findParentByTagName(i,"a",!0))&&!n.isInNodeEndBoundary(t,i))return i}else{t.shrinkBoundary();var h=t.startContainer.nodeType==3||!t.startContainer.childNodes[t.startOffset]?t.startContainer:t.startContainer.childNodes[t.startOffset],c=t.endContainer.nodeType==3||t.endOffset==0?t.endContainer:t.endContainer.childNodes[t.endOffset-1],u=t.getCommonAncestor();if(i=n.findParentByTagName(u,"a",!0),!i&&u.nodeType==1)for(o=u.getElementsByTagName("a"),s=0;r=o[s++];)if(f=n.getPosition(r,h),e=n.getPosition(r,c),(f&n.POSITION_FOLLOWING||f&n.POSITION_CONTAINS)&&(e&n.POSITION_PRECEDING||e&n.POSITION_CONTAINS)){i=r;break}return i}},queryCommandState:function(){var n=this.selection.getRange().getClosedNode(),t=n&&n.className=="edui-faked-video";return t?-1:0}}},UE.plugins.insertframe=function(){function t(){n._iframe&&delete n._iframe}var n=this;n.addListener("selectionchange",function(){t()})},UE.commands.scrawl={queryCommandState:function(){return i.ie&&i.version<=8?-1:0}},UE.plugins.removeformat=function(){var t=this;t.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),t.commands.removeformat={execCommand:function(t,r,f,o,s){function y(n){var t,r,u;if(n.nodeType==3||n.tagName.toLowerCase()!="span")return 0;if(i.ie&&(t=n.attributes,t.length)){for(r=0,u=t.length;r<u;r++)if(t[r].specified)return 0;return 1}return!n.attributes.length}function w(t){var k=t.createBookmark(),o,r,w,e,i,a,b;for(t.collapsed&&t.enlarge(!0),s||(o=n.findParentByTagName(t.startContainer,"a",!0),o&&t.setStartBefore(o),o=n.findParentByTagName(t.endContainer,"a",!0),o&&t.setEndAfter(o)),h=t.createBookmark(),i=h.start;(c=i.parentNode)&&!n.isBlockElm(c);)n.breakParent(i,c),n.clearEmptySibling(i);if(h.end){for(i=h.end;(c=i.parentNode)&&!n.isBlockElm(c);)n.breakParent(i,c),n.clearEmptySibling(i);for(r=n.getNextDomNode(h.start,!1,v);r;){if(r==h.end)break;w=n.getNextDomNode(r,!0,v),u.$empty[r.tagName.toLowerCase()]||n.isBookmarkNode(r)||(p.test(r.tagName)?f?(n.removeStyle(r,f),y(r)&&f!="text-decoration"&&n.remove(r,!0)):n.remove(r,!0):u.$tableContent[r.tagName]||u.$list[r.tagName]||(n.removeAttributes(r,l),y(r)&&n.remove(r,!0))),r=w}}for(e=h.start.parentNode,!n.isBlockElm(e)||u.$tableContent[e.tagName]||u.$list[e.tagName]||n.removeAttributes(e,l),e=h.end.parentNode,h.end&&n.isBlockElm(e)&&!u.$tableContent[e.tagName]&&!u.$list[e.tagName]&&n.removeAttributes(e,l),t.moveToBookmark(h).moveToBookmark(k),i=t.startContainer,b=t.collapsed;i.nodeType==1&&n.isEmptyNode(i)&&u.$removeEmpty[i.tagName];)a=i.parentNode,t.setStartBefore(i),t.startContainer===t.endContainer&&t.endOffset--,n.remove(i),i=a;if(!b)for(i=t.endContainer;i.nodeType==1&&n.isEmptyNode(i)&&u.$removeEmpty[i.tagName];)a=i.parentNode,t.setEndBefore(i),n.remove(i),i=a}var p=new RegExp("^(?:"+(r||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),l=f?[]:(o||this.options.removeFormatAttributes).split(","),a=new e.Range(this.document),h,c,v=function(n){return n.nodeType==1};a=this.selection.getRange(),w(a),a.select()}}},UE.plugins.blockquote=function(){function t(t){return n.filterNodeList(t.selection.getStartElementPath(),"blockquote")}var i=this;i.commands.blockquote={execCommand:function(i,r){var l=this.selection.getRange(),c=t(this),b=u.blockquote,nt=l.createBookmark(),k,a,g,v,w;if(c){var y=l.startContainer,s=n.isBlockElm(y)?y:n.findParent(y,function(t){return n.isBlockElm(t)}),p=l.endContainer,h=n.isBlockElm(p)?p:n.findParent(p,function(t){return n.isBlockElm(t)});for(s=n.findParentByTagName(s,"li",!0)||s,h=n.findParentByTagName(h,"li",!0)||h,s.tagName=="LI"||s.tagName=="TD"||s===c||n.isBody(s)?n.remove(c,!0):n.breakParent(s,c),s!==h&&(c=n.findParentByTagName(h,"blockquote"),c&&(h.tagName=="LI"||h.tagName=="TD"||n.isBody(h)?c.parentNode&&n.remove(c,!0):n.breakParent(h,c))),k=n.getElementsByTagName(this.document,"blockquote"),v=0;a=k[v++];)a.childNodes.length?n.getPosition(a,s)&n.POSITION_FOLLOWING&&n.getPosition(a,h)&n.POSITION_PRECEDING&&n.remove(a,!0):n.remove(a)}else{for(var e=l.cloneRange(),f=e.startContainer.nodeType==1?e.startContainer:e.startContainer.parentNode,o=f,d=1;;){if(n.isBody(f)){o!==f?l.collapsed?(e.selectNode(o),d=0):e.setStartBefore(o):e.setStart(f,0);break}if(!b[f.tagName]){l.collapsed?e.selectNode(o):e.setStartBefore(o);break}o=f,f=f.parentNode}if(d)for(o=f=f=e.endContainer.nodeType==1?e.endContainer:e.endContainer.parentNode;;){if(n.isBody(f)){o!==f?e.setEndAfter(o):e.setEnd(f,f.childNodes.length);break}if(!b[f.tagName]){e.setEndAfter(o);break}o=f,f=f.parentNode}for(f=l.document.createElement("blockquote"),n.setAttributes(f,r),f.appendChild(e.extractContents()),e.insertNode(f),g=n.getElementsByTagName(f,"blockquote"),v=0;w=g[v++];)w.parentNode&&n.remove(w,!0)}l.moveToBookmark(nt).select()},queryCommandState:function(){return t(this)?1:0}}},UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(t){var o=this,r=o.selection.getRange();if(r.collapsed)return r;for(var u=r.createBookmark(),f=u.end,e=function(t){return!n.isBr(t)&&!n.isWhitespace(t)},i=n.getNextDomNode(u.start,!1,e);i&&n.getPosition(i,f)&n.POSITION_PRECEDING;)if(i.nodeType==3&&(i.nodeValue=i.nodeValue[t=="touppercase"?"toUpperCase":"toLowerCase"]()),i=n.getNextDomNode(i,!0,e),i===f)break;r.moveToBookmark(u).select()}},UE.commands.indent={execCommand:function(){var n=this,t=n.queryCommandState("indent")?"0em":n.options.indentValue||"2em";n.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t&&t.style.textIndent&&parseInt(t.style.textIndent)?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var t=window.open("","_blank",""),n=t.document;n.open(),n.write('<html><head><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{    'highlightJsUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js',    'highlightCssUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css'})},300)<\/script><\/head><body><div>"+this.getContent(null,null,!0)+"<\/div><\/body><\/html>"),n.close()},notNeedUndo:1},UE.plugins.selectall=function(){var t=this;t.commands.selectall={execCommand:function(){var u=this,t=u.body,r=u.selection.getRange();r.selectNodeContents(t),n.isEmptyBlock(t)&&(i.opera&&t.firstChild&&t.firstChild.nodeType==1&&r.setStartAtFirst(t.firstChild),r.collapse(!0)),r.select(!0)},notNeedUndo:1},t.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.paragraph=function(){var u=this,r=n.isBlockElm,f=["TD","LI","PRE"],e=function(i,u,e,o){var p=i.createBookmark(),v=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},s,h;i.enlarge(!0);for(var l=i.createBookmark(),c=n.getNextDomNode(l.start,!1,v),a=i.cloneRange(),y;c&&!(n.getPosition(c,l.end)&n.POSITION_FOLLOWING);)if(c.nodeType!=3&&r(c))c=n.getNextDomNode(c,!0,v);else{for(a.setStartBefore(c);c&&c!==l.end&&!r(c);)y=c,c=n.getNextDomNode(c,!1,null,function(n){return!r(n)});a.setEndAfter(y),s=i.document.createElement(u),e&&(n.setAttributes(s,e),o&&o=="customstyle"&&e.style&&(s.style.cssText=e.style)),s.appendChild(a.extractContents()),n.isEmptyNode(s)&&n.fillChar(i.document,s),a.insertNode(s),h=s.parentNode,r(h)&&!n.isBody(s.parentNode)&&t.indexOf(f,h.tagName)==-1&&(o&&o=="customstyle"||(h.getAttribute("dir")&&s.setAttribute("dir",h.getAttribute("dir")),h.style.cssText&&(s.style.cssText=h.style.cssText+";"+s.style.cssText),h.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=h.style.textAlign),h.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=h.style.textIndent),h.style.padding&&!s.style.padding&&(s.style.padding=h.style.padding)),e&&/h\d/i.test(h.tagName)&&!/h\d/i.test(s.tagName)?(n.setAttributes(h,e),o&&o=="customstyle"&&e.style&&(h.style.cssText=e.style),n.remove(s,!0),s=h):n.remove(s.parentNode,!0)),c=t.indexOf(f,h.tagName)!=-1?h:s,c=n.getNextDomNode(c,!1,v)}return i.moveToBookmark(l).moveToBookmark(p)};u.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),u.commands.paragraph={execCommand:function(t,r,u,f){var o=this.selection.getRange(),s,h,c;return o.collapsed&&(s=this.document.createTextNode("p"),o.insertNode(s),i.ie&&(h=s.previousSibling,h&&n.isWhitespace(h)&&n.remove(h),h=s.nextSibling,h&&n.isWhitespace(h)&&n.remove(h))),o=e(o,r,u,f),s&&(o.setStartBefore(s).collapse(!0),pN=s.parentNode,n.remove(s),n.isBlockElm(pN)&&n.isEmptyNode(pN)&&n.fillNode(this.document,pN)),i.gecko&&o.collapsed&&o.startContainer.nodeType==1&&(c=o.startContainer.childNodes[o.startOffset],c&&c.nodeType==1&&c.tagName.toLowerCase()==r&&o.setStart(c,0).collapse(!0)),o.select(),!0},queryCommandValue:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t?t.tagName.toLowerCase():""}}},function(){var t=n.isBlockElm,i=function(t){return n.filterNodeList(t.selection.getStartElementPath(),function(n){return n.getAttribute("dir")})},r=function(r,u,f){var a,l=function(t){return t.nodeType==1?!n.isBookmarkNode(t):!n.isWhitespace(t)},v=i(u),s,h,p;if(v&&r.collapsed)return v.setAttribute("dir",f),r;a=r.createBookmark(),r.enlarge(!0);for(var c=r.createBookmark(),e=n.getNextDomNode(c.start,!1,l),o=r.cloneRange(),y;e&&!(n.getPosition(e,c.end)&n.POSITION_FOLLOWING);)if(e.nodeType!=3&&t(e))e=n.getNextDomNode(e,!0,l);else{for(o.setStartBefore(e);e&&e!==c.end&&!t(e);)y=e,e=n.getNextDomNode(e,!1,null,function(n){return!t(n)});o.setEndAfter(y),s=o.getCommonAncestor(),!n.isBody(s)&&t(s)?(s.setAttribute("dir",f),e=s):(h=r.document.createElement("p"),h.setAttribute("dir",f),p=o.extractContents(),h.appendChild(p),o.insertNode(h),e=h),e=n.getNextDomNode(e,!1,l)}return r.moveToBookmark(c).moveToBookmark(a)};UE.commands.directionality={execCommand:function(t,i){var u=this.selection.getRange(),f;return u.collapsed&&(f=this.document.createTextNode("d"),u.insertNode(f)),r(u,this,i),f&&(u.setStartBefore(f).collapse(!0),n.remove(f)),u.select(),!0},queryCommandValue:function(){var n=i(this);return n?n.getAttribute("dir"):"ltr"}}}(),UE.plugins.horizontal=function(){var t=this;t.commands.horizontal={execCommand:function(n){var r=this,i,u,t;if(r.queryCommandState(n)!==-1)return r.execCommand("insertHtml","<hr>"),i=r.selection.getRange(),u=i.startContainer,u.nodeType!=1||u.childNodes[i.startOffset]||(t=u.childNodes[i.startOffset-1])&&t.nodeType==1&&t.tagName=="HR"&&(r.options.enterTag=="p"?(t=r.document.createElement("p"),i.insertNode(t),i.setStart(t,0).setCursor()):(t=r.document.createElement("br"),i.insertNode(t),i.setStartBefore(t).setCursor())),!0},queryCommandState:function(){return n.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}},t.addListener("delkeydown",function(t,i){var r=this.selection.getRange(),f,u;return r.txtToElmBoundary(!0),n.isStartInblock(r)&&(f=r.startContainer,u=f.previousSibling,u&&n.isTagNode(u,"hr"))?(n.remove(u),r.select(),n.preventDefault(i),!0):void 0})},UE.commands.time=UE.commands.date={execCommand:function(n){var t=new Date;this.execCommand("insertHtml",n=="time"?t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds()):t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate()))}},UE.plugins.rowspacing=function(){var t=this;t.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),t.commands.rowspacing={execCommand:function(n,t,i){return this.execCommand("paragraph","p",{style:"margin-"+i+":"+t+"px"}),!0},queryCommandValue:function(t,i){var u=n.filterNodeList(this.selection.getStartElementPath(),function(t){return n.isBlockElm(t)}),r;return u?(r=n.getComputedStyle(u,"margin-"+i).replace(/[^\d]/g,""),r?r:0):0}}},UE.plugins.lineheight=function(){var t=this;t.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]}),t.commands.lineheight={execCommand:function(n,t){return this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")}),!0},queryCommandValue:function(){var i=n.filterNodeList(this.selection.getStartElementPath(),function(t){return n.isBlockElm(t)}),t;if(i)return t=n.getComputedStyle(i,"line-height"),t=="normal"?1:t.replace(/[^\d.]*/ig,"")}}},UE.plugins.insertcode=function(){var r=this,f;r.ready(function(){t.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",r.document)}),r.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"}),r.commands.insertcode={execCommand:function(r,f){var h=this,s=h.selection.getRange(),o=n.findParentByTagName(s.startContainer,"pre",!0),e,a,l,c;o?o.className="brush:"+f+";toolbar:false;":(e="",s.collapsed?e=i.ie?i.version>8?"":"&nbsp;":"<br/>":(a=s.extractContents(),l=h.document.createElement("div"),l.appendChild(a),t.each(UE.filterNode(UE.htmlparser(l.innerHTML.replace(/[\r\t]/g,"")),h.options.filterTxtRules).children,function(n){if(i.ie&&i.version>8)n.type=="element"?n.tagName=="br"?e+="\n":u.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="\n":u.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/\n$/.test(e)||(e+="\n")):e+=n.data+"\n",!n.nextSibling()&&/\n$/.test(e)&&(e=e.replace(/\n$/,""));else if(i.ie)n.type=="element"?n.tagName=="br"?e+="<br>":u.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="<br>":u.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/br>$/.test(e)||(e+="<br>")):e+=n.data+"<br>",!n.nextSibling()&&/<br>$/.test(e)&&(e=e.replace(/<br>$/,""));else if(e+=n.type=="element"?u.$empty[n.tagName]?"":n.innerText():n.data,!/br\/?\s*>$/.test(e)){if(!n.nextSibling())return;e+="<br>"}})),h.execCommand("inserthtml",'<pre id="coder"class="brush:'+f+';toolbar:false">'+e+"<\/pre>",!0),o=h.document.getElementById("coder"),n.removeAttributes(o,"id"),c=o.previousSibling,c&&(c.nodeType==3&&c.nodeValue.length==1&&i.ie&&i.version==6||n.isEmptyBlock(c))&&n.remove(c),s=h.selection.getRange(),n.isEmptyBlock(o)?s.setStart(o,0).setCursor(!1,!0):s.selectNodeContents(o).select())},queryCommandValue:function(){var i=this.selection.getStartElementPath(),n="";return t.each(i,function(t){if(t.nodeName=="PRE"){var i=t.className.match(/brush:([^;]+)/);return n=i&&i[1]?i[1]:"",!1}}),n}},r.addInputRule(function(n){t.each(n.getNodesByTagName("pre"),function(n){var r=n.getNodesByTagName("br"),u;if(r.length){i.ie&&i.version>8&&t.each(r,function(n){var t=UE.uNode.createText("\n");n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)});return}i.ie&&i.version>8||(u=n.innerText().split(/\n/),n.innerHTML(""),t.each(u,function(t){t.length&&n.appendChild(UE.uNode.createText(t)),n.appendChild(UE.uNode.createElement("br"))}))})}),r.addOutputRule(function(n){t.each(n.getNodesByTagName("pre"),function(n){var i="";t.each(n.children,function(n){i+=n.type=="text"?n.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):n.tagName=="br"?"\n":u.$empty[n.tagName]?n.innerText():""}),n.innerText(i.replace(/(&nbsp;|\n)+$/,""))})}),r.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,highlightcode:1,insertcode:1,inserthtml:1,selectall:1},f=r.queryCommandState,r.queryCommandState=function(n){var t=this;return!t.notNeedCodeQuery[n.toLowerCase()]&&t.selection&&t.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)},r.addListener("beforeenterkeydown",function(){var u=r.selection.getRange(),t=n.findParentByTagName(u.startContainer,"pre",!0),a,h,c,v,s,e,l,f,o;if(t){if(r.fireEvent("saveScene"),u.collapsed||u.deleteContents(),i.ie)if(i.version>8)h=r.document.createTextNode("\n"),c=u.startContainer,u.startOffset==0?(v=c.previousSibling,v&&(u.insertNode(h),s=r.document.createTextNode(" "),u.setStartAfter(h).insertNode(s).setStart(s,0).collapse(!0).select(!0))):(u.insertNode(h).setStartAfter(h),s=r.document.createTextNode(" "),c=u.startContainer.childNodes[u.startOffset],c&&!/^\n/.test(c.nodeValue)&&u.setStartBefore(h),u.insertNode(s).setStart(s,0).collapse(!0).select(!0));else{for(e=r.document.createElement("br"),u.insertNode(e),u.insertNode(r.document.createTextNode(n.fillChar)),u.setStartAfter(e),t=e.previousSibling;t;)if(l=t,t=t.previousSibling,!t||t.nodeName=="BR"){t=l;break}if(t){for(f="";t&&t.nodeName!="BR"&&new RegExp("^[ "+n.fillChar+"]*$").test(t.nodeValue);)f+=t.nodeValue,t=t.nextSibling;t.nodeName!="BR"&&(o=t.nodeValue.match(new RegExp("^([ "+n.fillChar+"]+)")),o&&o[1]&&(f+=o[1])),f=r.document.createTextNode(f),u.insertNode(f).setStartAfter(f)}u.collapse(!0).select()}else{for(e=r.document.createElement("br"),u.insertNode(e).setStartAfter(e).collapse(!0),a=e.nextSibling,a?u.setStartAfter(e):u.insertNode(e.cloneNode(!1)),t=e.previousSibling;t;)if(l=t,t=t.previousSibling,!t||t.nodeName=="BR"){t=l;break}if(t){for(f="";t&&t.nodeName!="BR"&&new RegExp("^[\\s"+n.fillChar+"]*$").test(t.nodeValue);)f+=t.nodeValue,t=t.nextSibling;t.nodeName!="BR"&&(o=t.nodeValue.match(new RegExp("^([\\s"+n.fillChar+"]+)")),o&&o[1]&&(f+=o[1])),f&&(f=r.document.createTextNode(f),u.insertNode(f).setStartAfter(f))}u.collapse(!0).select(!0)}return r.fireEvent("saveScene"),!0}}),r.addListener("tabkeydown",function(t,i){var o=r.selection.getRange(),f=n.findParentByTagName(o.startContainer,"pre",!0),e,u,s,h;if(f){if(r.fireEvent("saveScene"),!i.shiftKey)if(o.collapsed)h=r.document.createTextNode("    "),o.insertNode(h).setStartAfter(h).collapse(!0).select(!0);else{for(e=o.createBookmark(),u=e.start.previousSibling;u;){if(f.firstChild===u&&!n.isBr(u)){f.insertBefore(r.document.createTextNode("    "),u);break}if(n.isBr(u)){f.insertBefore(r.document.createTextNode("    "),u.nextSibling);break}u=u.previousSibling}for(s=e.end,u=e.start.nextSibling,f.firstChild===e.start&&f.insertBefore(r.document.createTextNode("    "),u.nextSibling);u&&u!==s;){if(n.isBr(u)&&u.nextSibling){if(u.nextSibling===s)break;f.insertBefore(r.document.createTextNode("    "),u.nextSibling)}u=u.nextSibling}o.moveToBookmark(e).select()}return r.fireEvent("saveScene"),!0}}),r.addListener("beforeinserthtml",function(r,f){var s=this,h=s.selection.getRange(),l=n.findParentByTagName(h.startContainer,"pre",!0),e,c,o;if(l)return h.collapsed||h.deleteContents(),e="",i.ie&&i.version>8?(t.each(UE.filterNode(UE.htmlparser(f),s.options.filterTxtRules).children,function(n){n.type=="element"?n.tagName=="br"?e+="\n":u.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="\n":u.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/\n$/.test(e)||(e+="\n")):e+=n.data+"\n",!n.nextSibling()&&/\n$/.test(e)&&(e=e.replace(/\n$/,""))}),c=s.document.createTextNode(t.html(e.replace(/&nbsp;/g," "))),h.insertNode(c).selectNode(c).select()):(o=s.document.createDocumentFragment(),t.each(UE.filterNode(UE.htmlparser(f),s.options.filterTxtRules).children,function(n){n.type=="element"?n.tagName=="br"?o.appendChild(s.document.createElement("br")):u.$empty[n.tagName]||(t.each(n.children,function(i){i.type=="element"?i.tagName=="br"?o.appendChild(s.document.createElement("br")):u.$empty[n.tagName]||o.appendChild(s.document.createTextNode(t.html(i.innerText().replace(/&nbsp;/g," ")))):o.appendChild(s.document.createTextNode(t.html(i.data.replace(/&nbsp;/g," "))))}),o.lastChild.nodeName!="BR"&&o.appendChild(s.document.createElement("br"))):o.appendChild(s.document.createTextNode(t.html(n.data.replace(/&nbsp;/g," ")))),n.nextSibling()||o.lastChild.nodeName!="BR"||o.removeChild(o.lastChild)}),h.insertNode(o).select()),!0}),r.addListener("keydown",function(t,i){var e=this,s=i.keyCode||i.which,r,f,o,u;if(s==40&&(r=e.selection.getRange(),o=r.startContainer,r.collapsed&&(f=n.findParentByTagName(r.startContainer,"pre",!0))&&!f.nextSibling)){for(u=f.lastChild;u&&u.nodeName=="BR";)u=u.previousSibling;(u===o||r.startContainer===f&&r.startOffset==f.childNodes.length)&&(e.execCommand("insertparagraph"),n.preventDefault(i))}}),r.addListener("delkeydown",function(t,i){var u=this.selection.getRange(),f,e;return u.txtToElmBoundary(!0),f=u.startContainer,n.isTagNode(f,"pre")&&u.collapsed&&n.isStartInblock(u)?(e=r.document.createElement("p"),n.fillNode(r.document,e),f.parentNode.insertBefore(e,f),n.remove(f),u.setStart(e,0).setCursor(!1,!0),n.preventDefault(i),!0):void 0})},UE.commands.cleardoc={execCommand:function(){var n=this,i=n.options.enterTag,t=n.selection.getRange();i=="br"?(n.body.innerHTML="<br/>",t.setStart(n.body,0).setCursor()):(n.body.innerHTML="<p>"+(f?"":"<br/>")+"<\/p>",t.setStart(n.body.firstChild,0).setCursor(!1,!0)),setTimeout(function(){n.fireEvent("clearDoc")},0)}},UE.plugins.anchor=function(){var i=this;i.ready(function(){t.cssRule("anchor",".anchorclass{background: url('"+i.options.UEDITOR_HOME_URL+"themes/default/images/anchor.gif') no-repeat scroll left center transparent;border: 1px dotted #0000FF;cursor: auto;display: inline-block;height: 16px;width: 15px;}",i.document)}),i.addOutputRule(function(n){t.each(n.getNodesByTagName("img"),function(n){var t;(t=n.getAttr("anchorname"))&&(n.tagName="a",n.setAttr({anchorname:"",name:t,"class":""}))})}),i.addInputRule(function(n){t.each(n.getNodesByTagName("a"),function(n){var t;(t=n.getAttr("name"))&&!n.getAttr("href")&&(n.tagName="img",n.setAttr({anchorname:n.getAttr("name"),"class":"anchorclass"}),n.setAttr("name"))})}),i.commands.anchor={execCommand:function(t,i){var u=this.selection.getRange(),r=u.getClosedNode(),f;r&&r.getAttribute("anchorname")?i?r.setAttribute("anchorname",i):(u.setStartBefore(r).setCursor(),n.remove(r)):i&&(f=this.document.createElement("img"),u.collapse(!0),n.setAttributes(f,{anchorname:i,"class":"anchorclass"}),u.insertNode(f).setStartAfter(f).setCursor(!1,!0))}}},UE.plugins.wordcount=function(){var t=this,i;t.addListener("contentchange",function(){t.fireEvent("wordcount")}),t.addListener("ready",function(){var t=this;n.on(t.body,"keyup",function(n){var r=n.keyCode||n.which;r in{"16":1,"18":1,"20":1,"37":1,"38":1,"39":1,"40":1}||(clearTimeout(i),i=setTimeout(function(){t.fireEvent("wordcount")},200))})})},UE.plugins.pagebreak=function(){function r(t){if(n.isEmptyBlock(t)){for(var r=t.firstChild,u;r&&r.nodeType==1&&n.isEmptyBlock(r);)u=r,r=r.firstChild;u||(u=t),n.fillNode(i.document,u)}}function u(n){return n&&n.nodeType==1&&n.tagName=="HR"&&n.className=="pagebreak"}var i=this,f=["td"];i.setOpt("pageBreakTag","_ueditor_page_break_tag_"),i.ready(function(){t.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",i.document)}),i.addInputRule(function(n){n.traversal(function(n){if(n.type=="text"&&n.data==i.options.pageBreakTag){var t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)}})}),i.addOutputRule(function(n){t.each(n.getNodesByTagName("hr"),function(n){if(n.getAttr("class")=="pagebreak"){var t=UE.uNode.createText(i.options.pageBreakTag);n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)}})}),i.commands.pagebreak={execCommand:function(){var o=i.selection.getRange(),t=i.document.createElement("hr"),l,a,y,h,e,s,c,v;if(n.setAttributes(t,{"class":"pagebreak",noshade:"noshade",size:"5"}),n.unSelectable(t),l=n.findParentByTagName(o.startContainer,f,!0),a=[],l)switch(l.tagName){case"TD":e=l.parentNode,e.previousSibling?(e.parentNode.insertBefore(t,e),a=n.findParents(t)):(y=n.findParentByTagName(e,"table"),y.parentNode.insertBefore(t,y),a=n.findParents(t,!0)),e=a[1],t!==e&&n.breakParent(t,e),i.fireEvent("afteradjusttable",i.document)}else{if(!o.collapsed)for(o.deleteContents(),h=o.startContainer;!n.isBody(h)&&n.isBlockElm(h)&&n.isEmptyNode(h);)o.setStartBefore(h).collapse(!0),n.remove(h),h=o.startContainer;for(o.insertNode(t),e=t.parentNode;!n.isBody(e);)n.breakParent(t,e),s=t.nextSibling,s&&n.isEmptyBlock(s)&&n.remove(s),e=t.parentNode;s=t.nextSibling,c=t.previousSibling,u(c)?n.remove(c):c&&r(c),s?(u(s)?n.remove(s):r(s),o.setEndAfter(t).collapse(!1)):(v=i.document.createElement("p"),t.parentNode.appendChild(v),n.fillNode(i.document,v),o.setStart(v,0).collapse(!0)),o.select(!0)}}}},UE.plugins.wordimage=function(){var i=this,r;i.addInputRule(function(n){t.each(n.getNodesByTagName("img"),function(n){var t=n.attrs,f=parseInt(t.width)<128||parseInt(t.height)<43,r=i.options,u=r.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";t._src&&t._src.indexOf("file:///")!==-1&&n.setAttr({width:t.width,height:t.height,alt:t.alt,word_img:t._src,src:u,_src:u,style:"background:url("+(f?r.themePath+r.theme+"/images/word.gif":r.langPath+r.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}),i.commands.wordimage={execCommand:function(){var t,f,e,u;for(r=n.getElementsByTagName(i.document.body,"img"),t=[],f=0;e=r[f++];)u=e.getAttribute("word_img"),u&&t.push(u);r.length&&(this.word_img=t)},queryCommandState:function(){r=n.getElementsByTagName(i.document.body,"img");for(var u=0,t;t=r[u++];)if(t.getAttribute("word_img"))return 1;return-1}}},UE.plugins.dragdrop=function(){var t=this;t.ready(function(){n.on(this.body,"dragend",function(){var f=t.selection.getRange(),u=f.getClosedNode()||t.selection.getStart(),r,i;if(u&&u.tagName=="IMG"){for(r=u.previousSibling;i=u.nextSibling;)if(i.nodeType!=1||i.tagName!="SPAN"||i.firstChild)break;else n.remove(i);(!r||r.nodeType!=1||n.isEmptyBlock(r))&&r||i&&(!i||n.isEmptyBlock(i))||(r&&r.tagName=="P"&&!n.isEmptyBlock(r)?(r.appendChild(u),n.moveChild(i,r),n.remove(i)):i&&i.tagName=="P"&&!n.isEmptyBlock(i)&&i.insertBefore(u,i.firstChild),r&&r.tagName=="P"&&n.isEmptyBlock(r)&&n.remove(r),i&&i.tagName=="P"&&n.isEmptyBlock(i)&&n.remove(i),f.selectNode(u).select(),t.fireEvent("saveScene"))}})}),t.addListener("keyup",function(i,r){var e=r.keyCode||r.which,f,u;e==13&&(f=t.selection.getRange(),(u=n.findParentByTagName(f.startContainer,"p",!0))&&n.getComputedStyle(u,"text-align")=="center"&&n.removeStyle(u,"text-align"))})},UE.plugins.undo=function(){function c(n,t){if(n.length!=t.length)return 0;for(var i=0,r=n.length;i<r;i++)if(n[i]!=t[i])return 0;return 1}function k(n,t){return n.collapsed!=t.collapsed?0:!c(n.startAddress,t.startAddress)||!c(n.endAddress,t.endAddress)?0:1}function d(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content)if(this.index--,this.index==0)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var r=this.editor,f=this.list[this.index],o=UE.htmlparser(f.content.replace(w,"")),u;r.options.autoClearEmptyNode=!1,r.filterInputRule(o),r.options.autoClearEmptyNode=h,r.document.body.innerHTML=o.toHtml(),r.fireEvent("afterscencerestore"),i.ie&&t.each(n.getElementsByTagName(r.document,"td th caption p"),function(t){n.isEmptyNode(t)&&n.fillNode(r.document,t)});try{u=new e.Range(r.document).moveToAddress(f.address),u.select(b[u.startContainer.nodeName.toLowerCase()])}catch(s){}this.update(),this.clearKey(),r.fireEvent("reset",!0)},this.getScene=function(){var n=this.editor,r=n.selection.getRange(),u=r.createAddress(!1,!0),t,i;return n.fireEvent("beforegetscene"),t=UE.htmlparser(n.body.innerHTML),n.options.autoClearEmptyNode=!1,n.filterOutputRule(t),n.options.autoClearEmptyNode=h,i=t.toHtml(),n.fireEvent("aftergetscene"),{address:u,content:i}},this.save=function(n,t){clearTimeout(o);var i=this.getScene(t),r=this.list[this.index];r&&r.content==i.content&&(n?1:k(r.address,i.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(i),this.list.length>y&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){s=0,v=null}}function l(){this.undoManger.save()}var o,r=this,y=r.options.maxUndoCount||20,p=r.options.maxInputCount||20,w=new RegExp(n.fillChar+"|<\/hr>","gi"),b={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},h=r.options.autoClearEmptyNode,f;r.undoManger=new d,r.undoManger.editor=r,r.addListener("saveScene",function(){var n=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,n)}),r.addListener("beforeexeccommand",l),r.addListener("afterexeccommand",l),r.addListener("reset",function(n,t){t||this.undoManger.reset()}),r.commands.redo=r.commands.undo={execCommand:function(n){this.undoManger[n]()},queryCommandState:function(n){return this.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var a={16:1,17:1,18:1,37:1,38:1,39:1,40:1},s=0,v,u=!1;r.addListener("ready",function(){n.on(this.body,"compositionstart",function(){u=!0});n.on(this.body,"compositionend",function(){u=!1})}),r.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"}),f=!0,r.addListener("keydown",function(n,t){var i=this,e=t.keyCode||t.which;if(!a[e]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(u)return;if(!i.selection.getRange().collapsed){i.undoManger.save(!1,!0),f=!1;return}i.undoManger.list.length==0&&i.undoManger.save(!0),clearTimeout(o);function r(n){n.selection.getRange().collapsed&&n.fireEvent("contentchange"),n.undoManger.save(!1,!0),n.fireEvent("selectionchange")}o=setTimeout(function(){if(u){var n=setInterval(function(){u||(r(i),clearInterval(n))},300);return}r(i)},200),v=e,s++,s>=p&&r(i)}}),r.addListener("keyup",function(n,t){var i=t.keyCode||t.which;if(!a[i]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(u)return;f||(this.undoManger.save(!1,!0),f=!0)}})},UE.plugins.paste=function(){function o(t){var u=this.document;if(!u.getElementById("baidu_pastebin")){var f=this.selection.getRange(),e=f.createBookmark(),r=u.createElement("div");r.id="baidu_pastebin",i.webkit&&r.appendChild(u.createTextNode(n.fillChar+n.fillChar)),u.body.appendChild(r),e.start.style.display="",r.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+n.getXY(e.start).y+"px",f.selectNodeContents(r).select(!0),setTimeout(function(){if(i.webkit)for(var s=0,h=u.querySelectorAll("#baidu_pastebin"),o;o=h[s++];)if(n.isEmptyNode(o))n.remove(o);else{r=o;break}try{r.parentNode.removeChild(r)}catch(c){}f.moveToBookmark(e).select(!0),t(r)},0)}}function s(o){var c,k,w,d,y,g,a,b,nt,v,tt,it,s,l,h,p;if(o.firstChild){for(k=n.getElementsByTagName(o,"span"),s=0;w=k[s++];)(w.id=="_baidu_cut_start"||w.id=="_baidu_cut_end")&&n.remove(w);if(i.webkit){for(v=o.querySelectorAll("div br"),s=0;d=v[s++];)y=d.parentNode,y.tagName=="DIV"&&y.childNodes.length==1&&(y.innerHTML="<p><br/><\/p>",n.remove(y));for(g=o.querySelectorAll("#baidu_pastebin"),s=0;a=g[s++];){for(b=r.document.createElement("p"),a.parentNode.insertBefore(b,a);a.firstChild;)b.appendChild(a.firstChild);n.remove(a)}for(nt=o.querySelectorAll("meta"),s=0;l=nt[s++];)n.remove(l);for(v=o.querySelectorAll("br"),s=0;l=v[s++];)/^apple-/i.test(l.className)&&n.remove(l)}if(i.gecko)for(tt=o.querySelectorAll("[_moz_dirty]"),s=0;l=tt[s++];)l.removeAttribute("_moz_dirty");if(!i.ie)for(it=o.querySelectorAll("span.Apple-style-span"),s=0;l=it[s++];)n.remove(l,!0);if(c=o.innerHTML,c=UE.filterWord(c),h=UE.htmlparser(c),r.options.filterRules&&UE.filterNode(h,r.options.filterRules),r.filterInputRule(h),i.webkit&&(p=h.lastChild(),p&&p.type=="element"&&p.tagName=="br"&&h.removeChild(p),t.each(r.body.querySelectorAll("div"),function(t){n.isEmptyBlock(t)&&n.remove(t)})),c={html:h.toHtml()},r.fireEvent("beforepaste",c,h),!c.html)return;h=UE.htmlparser(c.html,!0),r.queryCommandState("pasteplain")===1?r.execCommand("insertHtml",UE.filterNode(h,r.options.filterTxtRules).toHtml(),!0):(UE.filterNode(h,r.options.filterTxtRules),f=h.toHtml(),u=c.html,e=r.selection.getRange().createAddress(!0),r.execCommand("insertHtml",u,!0)),r.fireEvent("afterpaste",c)}}var r=this,f,u,e;r.addListener("pasteTransfer",function(i,o){var s,c,a,l,v,y,h,p;if(e&&f&&u&&f!=u){if(s=r.selection.getRange(),s.moveToAddress(e,!0),!s.collapsed){while(!n.isBody(s.startContainer)){if(c=s.startContainer,c.nodeType==1){if(c=c.childNodes[s.startOffset],!c){s.setStartBefore(s.startContainer);continue}a=c.previousSibling,a&&a.nodeType==3&&new RegExp("^[\n\r\t "+n.fillChar+"]*$").test(a.nodeValue)&&s.setStartBefore(a)}if(s.startOffset==0)s.setStartBefore(s.startContainer);else break}while(!n.isBody(s.endContainer)){if(l=s.endContainer,l.nodeType==1){if(l=l.childNodes[s.endOffset],!l){s.setEndAfter(s.endContainer);continue}v=l.nextSibling,v&&v.nodeType==3&&new RegExp("^[\n\r\t"+n.fillChar+"]*$").test(v.nodeValue)&&s.setEndAfter(v)}if(s.endOffset==s.endContainer[s.endContainer.nodeType==3?"nodeValue":"childNodes"].length)s.setEndAfter(s.endContainer);else break}}for(s.deleteContents(),s.select(!0),r.__hasEnterExecCommand=!0,y=u,o===2?y=y.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(n,i,r,u){return(r=r.toLowerCase(),{img:1}[r])?n:(u=u.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(n,t,i){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+i+" ":""}),{span:1,div:1}[r]?"":"<"+i+r+" "+t.trim(u)+">")}):o&&(y=f),r.execCommand("inserthtml",y,!0),r.__hasEnterExecCommand=!1,h=r.selection.getRange();!n.isBody(h.startContainer)&&!h.startOffset&&h.startContainer[h.startContainer.nodeType==3?"nodeValue":"childNodes"].length;)h.setStartBefore(h.startContainer);p=h.createAddress(!0),e.endAddress=p.startAddress}}),r.addListener("ready",function(){n.on(r.body,"cut",function(){var n=r.selection.getRange();!n.collapsed&&r.undoManger&&r.undoManger.save()});n.on(r.body,i.ie||i.opera?"keydown":"paste",function(n){(i.ie||i.opera)&&(!n.ctrlKey&&!n.metaKey||n.keyCode!="86")||o.call(r,function(n){s(n)})})})},UE.plugins.list=function(){function y(n){var t=[],i;for(i in n)t.push(i);return t}function e(t){var i=t.className;return n.hasClass(t,/custom_/)?i.match(/custom_(\w+)/)[1]:n.getStyle(t,"list-style-type")}function p(i,r){t.each(n.getElementsByTagName(i,"ol ul"),function(u){var l,y,w,a,c,v,p;n.inDoc(u,i)&&(l=u.parentNode,l.tagName==u.tagName&&(y=e(u)||(u.tagName=="OL"?"decimal":"disc"),w=e(l)||(l.tagName=="OL"?"decimal":"disc"),y==w&&(a=t.indexOf(f[u.tagName],y),a=a+1==f[u.tagName].length?0:a+1,h(u,f[u.tagName][a]))),c=0,v=2,n.hasClass(u,/custom_/)?/[ou]l/i.test(l.tagName)&&n.hasClass(l,/custom_/)||(v=1):/[ou]l/i.test(l.tagName)&&n.hasClass(l,/custom_/)&&(v=3),p=n.getStyle(u,"list-style-type"),p&&(u.style.cssText="list-style-type:"+p),u.className=t.trim(u.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+v,t.each(n.getElementsByTagName(u,"li"),function(t){var r,i,f;if(t.style.cssText&&(t.style.cssText=""),!t.firstChild){n.remove(t);return}if(t.parentNode===u){if(c++,n.hasClass(u,/custom_/))if(r=1,i=e(u),u.tagName=="OL"){if(i)switch(i){case"cn":case"cn1":case"cn2":c>10&&(c%10==0||c>10&&c<20)?r=2:c>20&&(r=3);break;case"num2":c>9&&(r=2)}t.className="list-"+o[i]+c+" list-"+i+"-paddingleft-"+r}else t.className="list-"+o[i]+" list-"+i+"-paddingleft";else t.className=t.className.replace(/list-[\w\-]+/gi,"");f=t.getAttribute("class"),f===null||f.replace(/\s/g,"")||n.removeAttributes(t,"class")}}),r||s(u,u.tagName.toLowerCase(),e(u)||n.getStyle(u,"list-style-type"),!0))})}function s(t,i,r,u){var f=t.nextSibling,o;f&&f.nodeType==1&&f.tagName.toLowerCase()==i&&(e(f)||n.getStyle(f,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&(n.moveChild(f,t),f.childNodes.length==0&&n.remove(f)),f&&n.isFillChar(f)&&n.remove(f),o=t.previousSibling,o&&o.nodeType==1&&o.tagName.toLowerCase()==i&&(e(o)||n.getStyle(o,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&n.moveChild(t,o),o&&n.isFillChar(o)&&n.remove(o),!u&&n.isEmptyBlock(t)&&n.remove(t),e(t)&&p(t.ownerDocument,!0)}function h(t,i){o[i]&&(t.className="custom_"+i);try{n.setStyle(t,"list-style-type",i)}catch(r){}}function a(t){var i=t.previousSibling;i&&n.isEmptyBlock(i)&&n.remove(i),i=t.nextSibling,i&&n.isEmptyBlock(i)&&n.remove(i)}function w(t){while(t&&!n.isBody(t)){if(t.nodeName=="TABLE")return null;if(t.nodeName=="LI")return t;t=t.parentNode}}var r=this,v={TD:1,PRE:1,BLOCKQUOTE:1},o={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"},f,l,c;r.setOpt({insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1}),f={OL:y(r.options.insertorderedlist),UL:y(r.options.insertunorderedlist)},l=r.options.listiconpath;for(c in o)r.options.insertorderedlist.hasOwnProperty(c)||r.options.insertunorderedlist.hasOwnProperty(c)||delete o[c];r.ready(function(){var u=[],n,f;for(n in o){if(n=="dash"||n=="dot")u.push("li.list-"+o[n]+"{background-image:url("+l+o[n]+".gif)}"),u.push("ul.custom_"+n+"{list-style:none;}ul.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(f=0;f<99;f++)u.push("li.list-"+o[n]+f+"{background-image:url("+l+"list-"+o[n]+f+".gif)}");u.push("ol.custom_"+n+"{list-style:none;}ol.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(n){case"cn":u.push("li.list-"+n+"-paddingleft-1{padding-left:25px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}"),u.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn1":u.push("li.list-"+n+"-paddingleft-1{padding-left:30px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}"),u.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn2":u.push("li.list-"+n+"-paddingleft-1{padding-left:40px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:55px}"),u.push("li.list-"+n+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":u.push("li.list-"+n+"-paddingleft-1{padding-left:25px}");break;case"num2":u.push("li.list-"+n+"-paddingleft-1{padding-left:35px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}");break;case"dash":u.push("li.list-"+n+"-paddingleft{padding-left:35px}");break;case"dot":u.push("li.list-"+n+"-paddingleft{padding-left:20px}")}}u.push(".list-paddingleft-1{padding-left:0}"),u.push(".list-paddingleft-2{padding-left:"+r.options.listDefaultPaddingLeft+"px}"),u.push(".list-paddingleft-3{padding-left:"+r.options.listDefaultPaddingLeft*2+"px}"),t.cssRule("list","ol,ul{margin:0;pading:0;"+(i.ie?"":"width:95%")+"}li{clear:both;}"+u.join("\n"),r.document)}),r.ready(function(){n.on(r.body,"cut",function(){setTimeout(function(){var t=r.selection.getRange(),u,i,f,e;t.collapsed||(u=n.findParentByTagName(t.startContainer,"li",!0))&&!u.nextSibling&&n.isEmptyBlock(u)&&(i=u.parentNode,(f=i.previousSibling)?(n.remove(i),t.setStartAtLast(f).collapse(!0),t.select(!0)):(f=i.nextSibling)?(n.remove(i),t.setStartAtFirst(f).collapse(!0),t.select(!0)):(e=r.document.createElement("p"),n.fillNode(r.document,e),i.parentNode.insertBefore(e,i),n.remove(i),t.setStart(e,0).collapse(!0),t.select(!0)))})})}),r.addListener("beforepaste",function(i,r){var l=this,a=l.selection.getRange(),h,s=UE.htmlparser(r.html,!0),u,c;(h=n.findParentByTagName(a.startContainer,"li",!0))&&(u=h.parentNode,c=u.tagName=="OL"?"ul":"ol",t.each(s.getNodesByTagName(c),function(n){var h,r,c;n.tagName=u.tagName,n.setAttr(),n.parentNode===s?i=e(u)||(u.tagName=="OL"?"decimal":"disc"):(h=n.parentNode.getAttr("class"),i=h&&/custom_/.test(h)?h.match(/custom_(\w+)/)[1]:n.parentNode.getStyle("list-style-type"),i||(i=u.tagName=="OL"?"decimal":"disc")),r=t.indexOf(f[u.tagName],i),n.parentNode!==s&&(r=r+1==f[u.tagName].length?0:r+1),c=f[u.tagName][r],o[c]?n.setAttr("class","custom_"+c):n.setStyle("list-style-type",c)})),r.html=s.toHtml()}),r.addInputRule(function(n){function s(n,t){var r=t.firstChild(),i;if(r&&r.type=="element"&&r.tagName=="span"&&/Wingdings|Symbol/.test(r.getStyle("font-family"))){for(i in e)if(e[i]==r.data)return i;return"disc"}for(i in f)if(f[i].test(n))return i}t.each(n.getNodesByTagName("li"),function(n){for(var t=UE.uNode.createElement("p"),f,o,e,r=0;f=n.children[r];)f.type=="text"||u.p[f.tagName]?t.appendChild(f):t.firstChild()?(n.insertBefore(t,f),t=UE.uNode.createElement("p"),r=r+2):r++;(!t.firstChild()||t.parentNode)&&n.firstChild()||n.appendChild(t),t.firstChild()||t.innerHTML(i.ie?"&nbsp;":"<br/>"),o=n.firstChild(),e=o.lastChild(),e&&e.type=="text"&&/^\s*$/.test(e.data)&&o.removeChild(e)});var f={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},e={square:"n"};t.each(n.getNodesByTagName("p"),function(n){function l(n,t,r){var u,e;n.tagName=="ol"?i.ie?(u=t.firstChild(),u.type=="element"&&u.tagName=="span"&&f[r].test(u.innerText())&&t.removeChild(u)):t.innerHTML(t.innerHTML().replace(f[r],"")):t.removeChild(t.firstChild()),e=UE.uNode.createElement("li"),e.appendChild(t),n.appendChild(e)}var h,e,c,t,u;if(n.getAttr("class")=="MsoListParagraph"){if(n.setStyle("margin",""),n.setStyle("margin-left",""),n.setAttr("class",""),h=n,c=n,n.parentNode.tagName!="li"&&(e=s(n.innerText(),n))){for(t=UE.uNode.createElement(r.options.insertorderedlist.hasOwnProperty(e)?"ol":"ul"),o[e]?t.setAttr("class","custom_"+e):t.setStyle("list-style-type",e);n&&n.parentNode.tagName!="li"&&s(n.innerText(),n);)h=n.nextSibling(),h||n.parentNode.insertBefore(t,n),l(t,n,e),n=h;!t.parentNode&&n&&n.parentNode&&n.parentNode.insertBefore(t,n)}u=c.firstChild(),u&&u.type=="element"&&u.tagName=="span"&&/^\s*(&nbsp;)+\s*$/.test(u.innerText())&&u.parentNode.removeChild(u)}})}),r.addListener("contentchange",function(){p(r.document)}),r.addListener("keydown",function(t,i){function d(){i.preventDefault?i.preventDefault():i.returnValue=!1,r.fireEvent("contentchange"),r.undoManger&&r.undoManger.save()}function it(t,i){while(t&&!n.isBody(t)){if(i(t))return null;if(t.nodeType==1&&/[ou]l/i.test(t.tagName))return t;t=t.parentNode}return null}var g=i.keyCode||i.which,tt,y,f,c,v,k,s,h,o,p;if(g==13&&!i.shiftKey){var nt=r.selection.getRange(),w=n.findParent(nt.startContainer,function(t){return n.isBlockElm(t)},!0),f=n.findParentByTagName(nt.startContainer,"li",!0);w&&w.tagName!="PRE"&&!f&&(tt=w.innerHTML.replace(new RegExp(n.fillChar,"g"),""),/^\s*1\s*\.[^\d]/.test(tt)&&(w.innerHTML=tt.replace(/^\s*1\s*\./,""),nt.setStartAtLast(w).collapse(!0).select(),r.__hasEnterExecCommand=!0,r.execCommand("insertorderedlist"),r.__hasEnterExecCommand=!1));var e=r.selection.getRange(),l=it(e.startContainer,function(n){return n.tagName=="TABLE"}),b=e.collapsed?l:it(e.endContainer,function(n){return n.tagName=="TABLE"});if(l&&b&&l===b){if(!e.collapsed)if(l=n.findParentByTagName(e.startContainer,"li",!0),b=n.findParentByTagName(e.endContainer,"li",!0),l&&b&&l===b){if(e.deleteContents(),f=n.findParentByTagName(e.startContainer,"li",!0),f&&n.isEmptyBlock(f)){s=f.previousSibling,next=f.nextSibling,h=r.document.createElement("p"),n.fillNode(r.document,h),o=f.parentNode,s&&next?(e.setStart(next,0).collapse(!0).select(!0),n.remove(f)):((s||next)&&s?f.parentNode.parentNode.insertBefore(h,o.nextSibling):o.parentNode.insertBefore(h,o),n.remove(f),o.firstChild||n.remove(o),e.setStart(h,0).setCursor()),d();return}}else{y=e.cloneRange(),p=y.collapse(!1).createBookmark(),e.deleteContents(),y.moveToBookmark(p),f=n.findParentByTagName(y.startContainer,"li",!0),a(f),y.select(),d();return}if(f=n.findParentByTagName(e.startContainer,"li",!0),f){if(n.isEmptyBlock(f)){if(p=e.createBookmark(),o=f.parentNode,f!==o.lastChild?(n.breakParent(f,o),a(f)):(o.parentNode.insertBefore(f,o.nextSibling),n.isEmptyNode(o)&&n.remove(o)),!u.$list[f.parentNode.tagName])if(n.isBlockElm(f.firstChild))n.remove(f,!0);else{for(h=r.document.createElement("p"),f.parentNode.insertBefore(h,f);f.firstChild;)h.appendChild(f.firstChild);n.remove(f)}e.moveToBookmark(p).select()}else{if(c=f.firstChild,!c||!n.isBlockElm(c)){for(h=r.document.createElement("p"),f.firstChild||n.fillNode(r.document,h);f.firstChild;)h.appendChild(f.firstChild);f.appendChild(h),c=h}v=r.document.createElement("span"),e.insertNode(v),n.breakParent(v,f),k=v.nextSibling,c=k.firstChild,c||(h=r.document.createElement("p"),n.fillNode(r.document,h),k.appendChild(h),c=h),n.isEmptyNode(c)&&(c.innerHTML="",n.fillNode(r.document,c)),e.setStart(c,0).collapse(!0).shrinkBoundary().select(),n.remove(v),s=k.previousSibling,s&&n.isEmptyBlock(s)&&(s.innerHTML="<p><\/p>",n.fillNode(r.document,s.firstChild))}d()}}}if(g==8&&(e=r.selection.getRange(),e.collapsed&&n.isStartInblock(e)&&(y=e.cloneRange().trimBoundary(),f=n.findParentByTagName(e.startContainer,"li",!0),f&&n.isStartInblock(y)))){if(l=n.findParentByTagName(e.startContainer,"p",!0),l&&l!==f.firstChild){o=n.findParentByTagName(l,["ol","ul"]),n.breakParent(l,o),a(l),r.fireEvent("contentchange"),e.setStart(l,0).setCursor(!1,!0),r.fireEvent("saveScene"),n.preventDefault(i);return}if(f&&(s=f.previousSibling)){if(g==46&&f.childNodes.length)return;if(u.$list[s.tagName]&&(s=s.lastChild),r.undoManger&&r.undoManger.save(),c=f.firstChild,n.isBlockElm(c))if(n.isEmptyNode(c))for(s.appendChild(c),e.setStart(c,0).setCursor(!1,!0);f.firstChild;)s.appendChild(f.firstChild);else v=r.document.createElement("span"),e.insertNode(v),n.isEmptyBlock(s)&&(s.innerHTML=""),n.moveChild(f,s),e.setStartBefore(v).collapse(!0).select(!0),n.remove(v);else if(n.isEmptyNode(f))h=r.document.createElement("p"),s.appendChild(h),e.setStart(h,0).setCursor();else for(e.setEnd(s,s.childNodes.length).collapse().select(!0);f.firstChild;)s.appendChild(f.firstChild);n.remove(f),r.fireEvent("contentchange"),r.fireEvent("saveScene"),n.preventDefault(i);return}if(f&&!f.previousSibling){if(o=f.parentNode,p=e.createBookmark(),n.isTagNode(o.parentNode,"ol ul"))o.parentNode.insertBefore(f,o),n.isEmptyNode(o)&&n.remove(o);else{while(f.firstChild)o.parentNode.insertBefore(f.firstChild,o);n.remove(f),n.isEmptyNode(o)&&n.remove(o)}e.moveToBookmark(p).setCursor(!1,!0),r.fireEvent("contentchange"),r.fireEvent("saveScene"),n.preventDefault(i);return}}}),r.addListener("keyup",function(t,i){var o=i.keyCode||i.which,f,u;o==8&&(f=r.selection.getRange(),(u=n.findParentByTagName(f.startContainer,["ol","ul"],!0))&&s(u,u.tagName.toLowerCase(),e(u)||n.getComputedStyle(u,"list-style-type"),!0))}),r.addListener("tabkeydown",function(){function b(n){if(r.options.maxListLevel!=-1){for(var t=n.parentNode,i=0;/[ou]l/i.test(t.tagName);)i++,t=t.parentNode;if(i>=r.options.maxListLevel)return!0}}var l=r.selection.getRange(),i=n.findParentByTagName(l.startContainer,"li",!0),a,y,k,p,d,w,o;if(i)if(l.collapsed){if(b(i))return!0;var c=i.parentNode,u=r.document.createElement(c.tagName),v=t.indexOf(f[u.tagName],e(c)||n.getComputedStyle(c,"list-style-type"));if(v=v+1==f[u.tagName].length?0:v+1,y=f[u.tagName][v],h(u,y),n.isStartInblock(l))return r.fireEvent("saveScene"),a=l.createBookmark(),c.insertBefore(u,i),u.appendChild(i),s(u,u.tagName.toLowerCase(),y),r.fireEvent("contentchange"),l.moveToBookmark(a).select(!0),!0}else{for(r.fireEvent("saveScene"),a=l.createBookmark(),k=0,d=n.findParents(i);w=d[k++];)if(n.isTagNode(w,"ol ul")){p=w;break}if(o=i,a.end)while(o&&!(n.getPosition(o,a.end)&n.POSITION_FOLLOWING)){if(b(o)){o=n.getNextDomNode(o,!1,null,function(n){return n!==p});continue}var c=o.parentNode,u=r.document.createElement(c.tagName),v=t.indexOf(f[u.tagName],e(c)||n.getComputedStyle(c,"list-style-type")),g=v+1==f[u.tagName].length?0:v+1,y=f[u.tagName][g];for(h(u,y),c.insertBefore(u,o);o&&!(n.getPosition(o,a.end)&n.POSITION_FOLLOWING);){if(i=o.nextSibling,u.appendChild(o),!i||n.isTagNode(i,"ol ul")){if(i){while(i=i.firstChild)if(i.tagName=="LI")break}else i=n.getNextDomNode(o,!1,null,function(n){return n!==p});break}o=i}s(u,u.tagName.toLowerCase(),y),o=i}return r.fireEvent("contentchange"),l.moveToBookmark(a).select(),!0}}),r.commands.insertorderedlist=r.commands.insertunorderedlist={execCommand:function(i,r){var ft,wt,lt,it,et,ot,at,rt,d,ht,tt,kt;r||(r=i.toLowerCase()=="insertorderedlist"?"decimal":"disc");var l=this,y=this.selection.getRange(),ut=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},st=i.toLowerCase()=="insertorderedlist"?"ol":"ul",a=l.document.createDocumentFragment();y.adjustmentBoundary().shrinkBoundary();var nt=y.createBookmark(!0),f=w(l.document.getElementById(nt.start)),yt=0,p=w(l.document.getElementById(nt.end)),pt=0,b,g,k,o;if(f||p){if(f&&(b=f.parentNode),nt.end||(p=f),p&&(g=p.parentNode),b===g){while(f!==p){if(o=f,f=f.nextSibling,!n.isBlockElm(o.firstChild)){for(ft=l.document.createElement("p");o.firstChild;)ft.appendChild(o.firstChild);o.appendChild(ft)}a.appendChild(o)}if(o=l.document.createElement("span"),b.insertBefore(o,p),!n.isBlockElm(p.firstChild)){for(ft=l.document.createElement("p");p.firstChild;)ft.appendChild(p.firstChild);p.appendChild(ft)}if(a.appendChild(p),n.breakParent(o,b),n.isEmptyNode(o.previousSibling)&&n.remove(o.previousSibling),n.isEmptyNode(o.nextSibling)&&n.remove(o.nextSibling),wt=e(b)||n.getComputedStyle(b,"list-style-type")||(i.toLowerCase()=="insertorderedlist"?"decimal":"disc"),b.tagName.toLowerCase()==st&&wt==r){for(ht=0,lt=l.document.createDocumentFragment();tt=a.childNodes[ht++];)if(n.isTagNode(tt,"ol ul"))t.each(n.getElementsByTagName(tt,"li"),function(n){while(n.firstChild)lt.appendChild(n.firstChild)});else while(tt.firstChild)lt.appendChild(tt.firstChild);o.parentNode.insertBefore(lt,o)}else k=l.document.createElement(st),h(k,r),k.appendChild(a),o.parentNode.insertBefore(k,o);n.remove(o),k&&s(k,st,r),y.moveToBookmark(nt).select();return}if(f){while(f){if(o=f.nextSibling,n.isTagNode(f,"ol ul"))a.appendChild(f);else{for(it=l.document.createDocumentFragment(),et=0;f.firstChild;)n.isBlockElm(f.firstChild)&&(et=1),it.appendChild(f.firstChild);et?a.appendChild(it):(ot=l.document.createElement("p"),ot.appendChild(it),a.appendChild(ot)),n.remove(f)}f=o}b.parentNode.insertBefore(a,b.nextSibling),n.isEmptyNode(b)?(y.setStartBefore(b),n.remove(b)):y.setStartAfter(b),yt=1}if(p&&n.inDoc(g,l.document)){for(f=g.firstChild;f&&f!==p;){if(o=f.nextSibling,n.isTagNode(f,"ol ul"))a.appendChild(f);else{for(it=l.document.createDocumentFragment(),et=0;f.firstChild;)n.isBlockElm(f.firstChild)&&(et=1),it.appendChild(f.firstChild);et?a.appendChild(it):(ot=l.document.createElement("p"),ot.appendChild(it),a.appendChild(ot)),n.remove(f)}f=o}at=n.createElement(l.document,"div",{tmpDiv:1}),n.moveChild(p,at),a.appendChild(at),n.remove(p),g.parentNode.insertBefore(a,g),y.setEndBefore(g),n.isEmptyNode(g)&&n.remove(g),pt=1}}yt||y.setStartBefore(l.document.getElementById(nt.start)),nt.end&&!pt&&y.setEndAfter(l.document.getElementById(nt.end)),y.enlarge(!0,function(n){return v[n.tagName]}),a=l.document.createDocumentFragment();for(var ct=y.createBookmark(),c=n.getNextDomNode(ct.start,!1,ut),vt=y.cloneRange(),d,bt=n.isBlockElm;c&&c!==ct.end&&n.getPosition(c,ct.end)&n.POSITION_PRECEDING;)if(c.nodeType==3||u.li[c.tagName]){if(c.nodeType==1&&u.$list[c.tagName]){while(c.firstChild)a.appendChild(c.firstChild);d=n.getNextDomNode(c,!1,ut),n.remove(c),c=d;continue}for(d=c,vt.setStartBefore(c);c&&c!==ct.end&&(!bt(c)||n.isBookmarkNode(c));)d=c,c=n.getNextDomNode(c,!1,null,function(n){return!v[n.tagName]});if(c&&bt(c)&&(o=n.getNextDomNode(d,!1,ut),o&&n.isBookmarkNode(o)&&(c=n.getNextDomNode(o,!1,ut),d=o)),vt.setEndAfter(d),c=n.getNextDomNode(d,!1,ut),rt=y.document.createElement("li"),rt.appendChild(vt.extractContents()),n.isEmptyNode(rt)){for(d=y.document.createElement("p");rt.firstChild;)d.appendChild(rt.firstChild);rt.appendChild(d)}a.appendChild(rt)}else c=n.getNextDomNode(c,!0,ut);for(y.moveToBookmark(ct).collapse(!0),k=l.document.createElement(st),h(k,r),k.appendChild(a),y.insertNode(k),s(k,st,r),ht=0,kt=n.getElementsByTagName(k,"div");tt=kt[ht++];)tt.getAttribute("tmpDiv")&&n.remove(tt,!0);y.moveToBookmark(nt).select()},queryCommandState:function(n){for(var r=n.toLowerCase()=="insertorderedlist"?"ol":"ul",u=this.selection.getStartElementPath(),t,i=0;t=u[i++];){if(t.nodeName=="TABLE")return 0;if(r==t.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(t){for(var f=t.toLowerCase()=="insertorderedlist"?"ol":"ul",o=this.selection.getStartElementPath(),i,r,u=0;r=o[u++];){if(r.nodeName=="TABLE"){i=null;break}if(f==r.nodeName.toLowerCase()){i=r;break}}return i?e(i)||n.getComputedStyle(i,"list-style-type"):null}}},function(){var r={textarea:function(n,t){var r=t.ownerDocument.createElement("textarea");return r.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",i.ie&&i.version<8&&(r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px",t.onresize=function(){r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px"}),t.appendChild(r),{setContent:function(n){r.value=n},getContent:function(){return r.value},select:function(){var n;i.ie?(n=r.createTextRange(),n.collapse(!0),n.select()):(r.setSelectionRange(0,0),r.focus())},dispose:function(){t.removeChild(r),t.onresize=null,r=null,t=null}}},codemirror:function(n,t){var i=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),r=i.getWrapperElement();return r.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',i.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",i.refresh(),{getCodeMirror:function(){return i},setContent:function(n){i.setValue(n)},getContent:function(){return i.getValue()},select:function(){i.focus()},dispose:function(){t.removeChild(r),r=null,i=null}}}};UE.plugins.source=function(){function v(n){return r[e.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](f,n)}var f=this,e=this.options,s=!1,o,c,l,h,a;e.sourceEditor=i.ie?"textarea":e.sourceEditor||"codemirror",f.setOpt({sourceEditorFirst:!1}),l=f.getContent,f.commands.source={execCommand:function(){var r,y,e,a,t;if(s=!s,s)h=f.selection.getRange().createAddress(!1,!0),f.undoManger&&f.undoManger.save(!0),i.gecko&&(f.body.contentEditable=!1),c=f.iframe.style.cssText,f.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",f.fireEvent("beforegetcontent"),r=UE.htmlparser(f.body.innerHTML),f.filterOutputRule(r),r.traversal(function(n){if(n.type=="element")switch(n.tagName){case"td":case"th":case"caption":n.children&&n.children.length==1&&n.firstChild().tagName=="br"&&n.removeChild(n.firstChild());break;case"pre":n.innerText(n.innerText().replace(/&nbsp;/g," "))}}),f.fireEvent("aftergetcontent"),y=r.toHtml(!0),o=v(f.iframe.parentNode),o.setContent(y),setTimeout(function(){o.select(),f.addListener("fullscreenchanged",function(){try{o.getCodeMirror().refresh()}catch(n){}})}),f.getContent=function(){return o.getContent()||"<p>"+(i.ie?"":"<br/>")+"<\/p>"};else if(f.iframe.style.cssText=c,e=o.getContent()||"<p>"+(i.ie?"":"<br/>")+"<\/p>",e=e.replace(new RegExp("[\\r\\t\\n ]*<\/?(\\w+)\\s*(?:[^>]*)>","g"),function(n,t){return t&&!u.$inlineWithA[t.toLowerCase()]?n.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):n.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")}),f.setContent(e),o.dispose(),o=null,f.getContent=l,a=f.body.firstChild,a||(f.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"<\/p>",a=f.body.firstChild),f.undoManger&&f.undoManger.save(!0),i.gecko)t=document.createElement("input"),t.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(t),f.body.contentEditable=!1,setTimeout(function(){n.setViewportOffset(t,{left:-32768,top:0}),t.focus(),setTimeout(function(){f.body.contentEditable=!0,f.selection.getRange().moveToAddress(h).select(!0),n.remove(t)})});else try{f.selection.getRange().moveToAddress(h).select(!0)}catch(p){}this.fireEvent("sourcemodechanged",s)},queryCommandState:function(){return s|0},notNeedUndo:1},a=f.queryCommandState,f.queryCommandState=function(n){return(n=n.toLowerCase(),s)?n in{source:1,fullscreen:1}?1:-1:a.apply(this,arguments)},e.sourceEditor=="codemirror"&&f.addListener("ready",function(){t.loadFile(document,{src:e.codeMirrorJsUrl||e.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e.sourceEditorFirst&&setTimeout(function(){f.execCommand("source")},0)}),t.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:e.codeMirrorCssUrl||e.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}(),UE.plugins.enterkey=function(){var r,t=this,f=t.options.enterTag;t.addListener("keyup",function(u,f){var v=f.keyCode||f.which,o,h,c,a,s,e,l;if(v==13)if(o=t.selection.getRange(),h=o.startContainer,i.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(r)){if(i.gecko)a=n.findParentByTagName(h,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0),a||(t.document.execCommand("formatBlock",!1,"<p>"),c=1);else if(h.nodeType==1){if(s=t.document.createTextNode(""),o.insertNode(s),e=n.findParentByTagName(s,"div",!0),e){for(l=t.document.createElement("p");e.firstChild;)l.appendChild(e.firstChild);e.parentNode.insertBefore(l,e),n.remove(e),o.setStartBefore(s).setCursor(),c=1}n.remove(s)}t.undoManger&&c&&t.undoManger.save()}i.opera&&o.select()}}),t.addListener("keydown",function(e,o){var y=o.keyCode||o.which,s,c,v;if(y==13){if(t.fireEvent("beforeenterkeydown")){n.preventDefault(o);return}if(t.fireEvent("saveScene",!0,!0),r="",s=t.selection.getRange(),!s.collapsed){var h=s.startContainer,p=s.endContainer,l=n.findParentByTagName(h,"td",!0),a=n.findParentByTagName(p,"td",!0);if(l&&a&&l!==a||!l&&a||l&&!a){o.preventDefault?o.preventDefault():o.returnValue=!1;return}}if(f=="p")i.ie||(h=n.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),h||i.opera?(r=h.tagName,h.tagName.toLowerCase()=="p"&&i.gecko&&n.removeDirtyAttr(h)):(t.document.execCommand("formatBlock",!1,"<p>"),i.gecko&&(s=t.selection.getRange(),h=n.findParentByTagName(s.startContainer,"p",!0),h&&n.removeDirtyAttr(h))));else if(o.preventDefault?o.preventDefault():o.returnValue=!1,s.collapsed)c=s.document.createElement("br"),s.insertNode(c),v=c.parentNode,v.lastChild===c?(c.parentNode.insertBefore(c.cloneNode(!0),c),s.setStartBefore(c)):s.setStartAfter(c),s.setCursor();else if(s.deleteContents(),h=s.startContainer,h.nodeType==1&&(h=h.childNodes[s.startOffset])){while(h.nodeType==1){if(u.$empty[h.tagName])return s.setStartBefore(h).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!h.firstChild)return c=s.document.createElement("br"),h.appendChild(c),s.setStart(h,0).setCursor(),t.undoManger&&t.undoManger.save(),!1;h=h.firstChild}h===s.startContainer.childNodes[s.startOffset]?(c=s.document.createElement("br"),s.insertNode(c).setCursor()):s.setStart(h,0).setCursor()}else c=s.document.createElement("br"),s.insertNode(c).setStartAfter(c).setCursor()}})},UE.plugins.keystrokes=function(){var t=this,r=!0;t.addListener("keydown",function(u,f){var c=f.keyCode||f.which,e=t.selection.getRange(),s,o,l,b,h,y,g,p,w,a,v;if(!e.collapsed&&!(f.ctrlKey||f.shiftKey||f.altKey||f.metaKey)&&(c>=65&&c<=90||c>=48&&c<=57||c>=96&&c<=111||{13:1,8:1,46:1}[c])&&(s=e.startContainer,n.isFillChar(s)&&e.setStartBefore(s),s=e.endContainer,n.isFillChar(s)&&e.setEndAfter(s),e.txtToElmBoundary(),e.endContainer&&e.endContainer.nodeType==1&&(s=e.endContainer.childNodes[e.endOffset],s&&n.isBr(s)&&e.setEndAfter(s)),e.startOffset==0&&(s=e.startContainer,n.isBoundaryNode(s,"firstChild")&&(s=e.endContainer,e.endOffset==(s.nodeType==3?s.nodeValue.length:s.childNodes.length)&&n.isBoundaryNode(s,"lastChild"))))){t.fireEvent("saveScene"),t.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"<\/p>",e.setStart(t.body.firstChild,0).setCursor(!1,!0),t._selectionChange();return}if(c==8){if(e=t.selection.getRange(),r=e.collapsed,t.fireEvent("delkeydown",f))return;if(e.collapsed&&e.inFillChar()&&(o=e.startContainer,n.isFillChar(o)?(e.setStartBefore(o).shrinkBoundary(!0).collapse(!0),n.remove(o)):(o.nodeValue=o.nodeValue.replace(new RegExp("^"+n.fillChar),""),e.startOffset--,e.collapse(!0).select(!0))),o=e.getClosedNode()){t.fireEvent("saveScene"),e.setStartBefore(o),n.remove(o),e.setCursor(),t.fireEvent("saveScene"),n.preventDefault(f);return}if(!i.ie&&(o=n.findParentByTagName(e.startContainer,"table",!0),l=n.findParentByTagName(e.endContainer,"table",!0),o&&!l||!o&&l||o!==l)){f.preventDefault();return}}if(c==9){if(b={ol:1,ul:1,table:1},t.fireEvent("tabkeydown",f)){n.preventDefault(f);return}h=t.selection.getRange(),t.fireEvent("saveScene");for(var k=0,d="",nt=t.options.tabSize||4,tt=t.options.tabNode||"&nbsp;";k<nt;k++)d+=tt;if(y=t.document.createElement("span"),y.innerHTML=d+n.fillChar,h.collapsed)h.insertNode(y.cloneNode(!0).firstChild).setCursor(!0);else if(o=n.findParent(h.startContainer,p),l=n.findParent(h.endContainer,p),o&&l&&o===l)h.deleteContents(),h.insertNode(y.cloneNode(!0).firstChild).setCursor(!0);else{for(g=h.createBookmark(),p=function(t){return n.isBlockElm(t)&&!b[t.tagName.toLowerCase()]},h.enlarge(!0),w=h.createBookmark(),a=n.getNextDomNode(w.start,!1,p);a&&!(n.getPosition(a,w.end)&n.POSITION_FOLLOWING);)a.insertBefore(y.cloneNode(!0).firstChild,a.firstChild),a=n.getNextDomNode(a,!1,p);h.moveToBookmark(w).moveToBookmark(g).select()}n.preventDefault(f)}if(i.gecko&&c==46&&(h=t.selection.getRange(),h.collapsed&&(o=h.startContainer,n.isEmptyBlock(o)))){for(v=o.parentNode;n.getChildCount(v)==1&&!n.isBody(v);)o=v,v=v.parentNode;o===v.lastChild&&f.preventDefault();return}}),t.addListener("keyup",function(t,u){var a=u.keyCode||u.which,f,c=this,l,o,s,e,h;if(a==8){if(c.fireEvent("delkeyup"))return;if(f=c.selection.getRange(),f.collapsed){if(l=["h1","h2","h3","h4","h5","h6"],(e=n.findParentByTagName(f.startContainer,l,!0))&&n.isEmptyBlock(e)){if(o=e.previousSibling,o&&o.nodeName!="TABLE"){n.remove(e),f.setStartAtLast(o).setCursor(!1,!0);return}if(s=e.nextSibling,s&&s.nodeName!="TABLE"){n.remove(e),f.setStartAtFirst(s).setCursor(!1,!0);return}}n.isBody(f.startContainer)&&(e=n.createElement(c.document,"p",{innerHTML:i.ie?n.fillChar:"<br/>"}),f.insertNode(e).setStart(e,0).setCursor(!1,!0))}!r&&(f.startContainer.nodeType==3||f.startContainer.nodeType==1&&n.isEmptyBlock(f.startContainer))&&(i.ie?(h=f.document.createElement("span"),f.insertNode(h).setStartBefore(h).collapse(!0),f.select(),n.remove(h)):f.select())}})},UE.plugins.fiximgclick=function(){var n=this;i.webkit&&n.addListener("click",function(t,i){if(i.target.tagName=="IMG"){var r=new e.Range(n.document);r.selectNode(i.target).select()}})},UE.plugins.autolink=function(){var u=0,r;i.ie||(r=this,r.addListener("reset",function(){u=0}),r.addListener("keydown",function(i,u){var v=u.keyCode||u.which,e,o,a,s;if(v==32||v==13){for(var h=r.selection.getNative(),f=h.getRangeAt(0).cloneRange(),c,l,e=f.startContainer;e.nodeType==1&&f.startOffset>0;){if(e=f.startContainer.childNodes[f.startOffset-1],!e)break;f.setStart(e,e.nodeType==1?e.childNodes.length:e.nodeValue.length),f.collapse(!0),e=f.startContainer}do{if(f.startOffset==0){for(e=f.startContainer.previousSibling;e&&e.nodeType==1;)e=e.lastChild;if(!e||n.isFillChar(e))break;c=e.nodeValue.length}else e=f.startContainer,c=f.startOffset;f.setStart(e,c-1),l=f.toString().charCodeAt(0)}while(l!=160&&l!=32);if(f.toString().replace(new RegExp(n.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(f.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(f.toString()))break;try{f.setStart(f.startContainer,f.startOffset+1)}catch(y){for(e=f.startContainer;!(next=e.nextSibling);){if(n.isBody(e))return;e=e.parentNode}f.setStart(next,0)}}if(n.findParentByTagName(f.startContainer,"a",!0))return;o=r.document.createElement("a"),a=r.document.createTextNode(" "),r.undoManger&&r.undoManger.save(),o.appendChild(f.extractContents()),o.href=o.innerHTML=o.innerHTML.replace(/<[^>]+>/g,""),s=o.getAttribute("href").replace(new RegExp(n.fillChar,"g"),""),s=/^(?:https?:\/\/)/ig.test(s)?s:"http://"+s,o.setAttribute("_src",t.html(s)),o.href=t.html(s),f.insertNode(o),o.parentNode.insertBefore(a,o.nextSibling),f.setStart(a,0),f.collapse(!0),h.removeAllRanges(),h.addRange(f),r.undoManger&&r.undoManger.save()}}}))},UE.plugins.autoheight=function(){function r(){var t=this;(clearTimeout(c),l)||(c=setTimeout(function(){(!t.queryCommandState||t.queryCommandState&&t.queryCommandState("source")!=1)&&(u||(u=t.document.createElement("span"),u.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",u.innerHTML="."),f=u.cloneNode(!0),t.body.appendChild(f),e=Math.max(n.getXY(f).y+f.offsetHeight,Math.max(s.minFrameHeight,s.initialFrameHeight)),e!=o&&(t.setHeight(e,!0),o=e),n.remove(f))},50))}var t=this,h,u,f,o,s,e,c,l;(t.autoHeightEnabled=t.options.autoHeightEnabled!==!1,t.autoHeightEnabled)&&(o=0,s=t.options,t.addListener("fullscreenchanged",function(n,t){l=t}),t.addListener("destroy",function(){t.removeListener("contentchange afterinserthtml keyup mouseup",r)}),t.enableAutoHeight=function(){var n=this,t;n.autoHeightEnabled&&(t=n.document,n.autoHeightEnabled=!0,h=t.body.style.overflowY,t.body.style.overflowY="hidden",n.addListener("contentchange afterinserthtml keyup mouseup",r),setTimeout(function(){r.call(n)},i.gecko?100:0),n.fireEvent("autoheightchanged",n.autoHeightEnabled))},t.disableAutoHeight=function(){t.body.style.overflowY=h||"",t.removeListener("contentchange",r),t.removeListener("keyup",r),t.removeListener("mouseup",r),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.addListener("ready",function(){t.enableAutoHeight();var u;n.on(i.ie?t.body:t.document,i.webkit?"dragover":"drop",function(){clearTimeout(u),u=setTimeout(function(){r.call(this)},100)})}))},UE.plugins.autofloat=function(){function d(){return UE.ui?1:(alert(w.autofloatMsg),0)}function g(){var n=document.body.style;n.backgroundImage='url("about:blank")',n.backgroundAttachment="fixed"}function nt(){var e=n.getXY(r),t=n.getComputedStyle(r,"position"),h=n.getComputedStyle(r,"left");r.style.width=r.offsetWidth+"px",r.style.zIndex=u.options.zIndex*1+1,r.parentNode.insertBefore(f,r),a||k&&i.ie?(r.style.position!="absolute"&&(r.style.position="absolute"),r.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-y+s+"px"):(i.ie7Compat&&o&&(o=!1,r.style.left=n.getXY(r).x-document.documentElement.getBoundingClientRect().left+2+"px"),r.style.position!="fixed"&&(r.style.position="fixed",r.style.top=s+"px",(t=="absolute"||t=="relative")&&parseFloat(h)&&(r.style.left=e.x+"px")))}function p(){o=!0,f.parentNode&&f.parentNode.removeChild(f),r.style.cssText=v}function e(){var n=h(u.container),t=u.options.toolbarTopOffset||0;n.top<0&&n.bottom-r.offsetHeight>t?nt():p()}var u=this,w=u.getLang(),l,s,v,f,r,y,h,o,c;if(u.setOpt({topOffset:0}),l=u.options.autoFloatEnabled!==!1,s=u.options.topOffset,l){var b=UE.ui.uiUtils,a=i.ie&&i.version<=6,k=i.quirks;f=document.createElement("div"),o=!0,c=t.defer(function(){e()},i.ie?200:100,!0),u.addListener("destroy",function(){n.un(window,["scroll","resize"],e),u.removeListener("keydown",c)}),u.addListener("ready",function(){if(d(u)){h=b.getClientRect,r=u.ui.getDom("toolbarbox"),y=h(r).top,v=r.style.cssText,f.style.height=r.offsetHeight+"px",a&&g();n.on(window,["scroll","resize"],e);u.addListener("keydown",c),u.addListener("beforefullscreenchange",function(n,t){t&&p()}),u.addListener("fullscreenchanged",function(n,t){t||e()}),u.addListener("sourcemodechanged",function(){setTimeout(function(){e()},0)}),u.addListener("clearDoc",function(){setTimeout(function(){e()},0)})}})}},UE.plugins.pasteplain=function(){var t=this,n;t.setOpt({pasteplain:!1,filterTxtRules:function(){function n(n){n.tagName="p",n.setStyle()}function t(n){n.parentNode.removeChild(n,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(n){for(var i,t=UE.uNode.createElement("p");i=n.firstChild();)i.type!="text"&&UE.dom.dtd.$block[i.tagName]?t.firstChild()?(n.parentNode.insertBefore(t,n),t=UE.uNode.createElement("p")):n.parentNode.insertBefore(i,n):t.appendChild(i);t.firstChild()&&n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:n,th:n,tr:n,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,td:function(n){var t=!!n.innerText();t&&n.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),n),n.parentNode.removeChild(n,n.innerText())}}}()}),n=t.options.pasteplain,t.commands.pasteplain={queryCommandState:function(){return n?1:0},execCommand:function(){n=!n|0},notNeedUndo:1}},UE.plugins.video=function(){function r(n,t,r,u,f,e){return e?'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+n+'" width="'+t+'" height="'+r+'"'+(f?' style="float:'+f+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(u?'id="'+u+'"':"")+' width="'+t+'" height="'+r+'" _url="'+n+'" class="edui-faked-video" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+i.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(f?"float:"+f+";":"")+'" />'}function u(n,i){t.each(n.getNodesByTagName(i?"img":"embed"),function(n){if(n.getAttr("class")=="edui-faked-video"){var t=r(i?n.getAttr("_url"):n.getAttr("src"),n.getAttr("width"),n.getAttr("height"),null,n.getStyle("float")||"",i);n.parentNode.replaceChild(UE.uNode.createElement(t),n)}})}var i=this;i.addOutputRule(function(n){u(n,!0)}),i.addInputRule(function(n){u(n)}),i.commands.insertvideo={execCommand:function(u,f){var h,l,s,a,e,o,c;for(f=t.isArray(f)?f:[f],h=[],l="tmpVedio",e=0,o=f.length;e<o;e++)s=f[e],h.push(r(s.url,s.width||420,s.height||280,l+e,null,!1));for(i.execCommand("inserthtml",h.join(""),!0),a=this.selection.getRange(),e=0,o=f.length;e<o;e++)c=this.document.getElementById("tmpVedio"+e),n.removeAttributes(c,"id"),a.selectNode(c).select(),i.execCommand("imagefloat",f[e].align)},queryCommandState:function(){var n=i.selection.getRange().getClosedNode(),t=n&&n.className=="edui-faked-video";return t?1:0}}},function(){function f(){}var r=UE.UETable=function(n){this.table=n,this.indexTable=[],this.selectedTds=[],this.cellsRange={},this.update(n)};r.removeSelectedClass=function(i){t.each(i,function(t){n.removeClasses(t,"selectTdClass")})},r.addSelectedClass=function(i){t.each(i,function(t){n.addClass(t,"selectTdClass")})},r.isEmptyBlock=function(t){var f=new RegExp(n.fillChar,"g"),r;if(t[i.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(f,"").length>0)return 0;for(r in u.$isNotEmpty)if(u.$isNotEmpty.hasOwnProperty(r)&&t.getElementsByTagName(r).length)return 0;return 1},r.getWidth=function(t){return t?parseInt(n.getComputedStyle(t,"width"),10):0},r.getTableCellAlignState=function(n){t.isArray(n)||(n=[n]);var i={},f=["align","valign"],r=null,u=!0;return t.each(n,function(n){return t.each(f,function(t){if(r=n.getAttribute(t),!i[t]&&r)i[t]=r;else if(!i[t]||r!==i[t])return u=!1,!1}),u}),u?i:null},r.getTableItemsByRange=function(t){var i=t.selection.getStart();i&&i.id&&i.id.indexOf("_baidu_bookmark_start_")===0&&(i=i.nextSibling);var r=i&&n.findParentByTagName(i,["td","th"],!0),u=r&&r.parentNode,f=i&&n.findParentByTagName(i,"caption",!0),e=f?f.parentNode:u&&u.parentNode.parentNode;return{cell:r,tr:u,table:e,caption:f}},r.getUETableBySelected=function(n){var t=r.getTableItemsByRange(n).table;return t&&t.ueTable&&t.ueTable.selectedTds.length?t.ueTable:null},r.getDefaultValue=function(t,i){var u={thin:"0px",medium:"1px",thick:"2px"},e,o,s,r,f;return i?(f=i.getElementsByTagName("td")[0],r=n.getComputedStyle(i,"border-left-width"),e=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"padding-left"),o=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"border-left-width"),s=parseInt(u[r]||r,10),{tableBorder:e,tdPadding:o,tdBorder:s}):(i=t.document.createElement("table"),i.insertRow(0).insertCell(0).innerHTML="xxx",t.body.appendChild(i),f=i.getElementsByTagName("td")[0],r=n.getComputedStyle(i,"border-left-width"),e=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"padding-left"),o=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"border-left-width"),s=parseInt(u[r]||r,10),n.remove(i),{tableBorder:e,tdPadding:o,tdBorder:s})},r.getUETable=function(t){var i=t.tagName.toLowerCase();return t=i=="td"||i=="th"||i=="caption"?n.findParentByTagName(t,"table",!0):t,t.ueTable||(t.ueTable=new r(t)),t.ueTable},r.cloneCell=function(i,r,u){var e,f;return!i||t.isString(i)?this.table.ownerDocument.createElement(i||"td"):(e=n.hasClass(i,"selectTdClass"),e&&n.removeClasses(i,"selectTdClass"),f=i.cloneNode(!0),r&&(f.rowSpan=f.colSpan=1),u||n.removeAttributes(f,"width height"),u||n.removeAttributes(f,"style"),f.style.borderLeftStyle="",f.style.borderTopStyle="",f.style.borderLeftColor=i.style.borderRightColor,f.style.borderLeftWidth=i.style.borderRightWidth,f.style.borderTopColor=i.style.borderBottomColor,f.style.borderTopWidth=i.style.borderBottomWidth,e&&n.addClass(i,"selectTdClass"),f)},r.prototype={getMaxRows:function(){for(var e=this.table.rows,i=1,r,t,u,f,n=0;r=e[n];n++){for(t=1,u=0;f=r.cells[u++];)t=Math.max(f.rowSpan||1,t);i=Math.max(t+n,i)}return i},getMaxCols:function(){for(var s=this.table.rows,f=0,r={},e,u,o,t,i,n=0;e=s[n];n++){for(u=0,o=0;t=e.cells[o++];)if(u+=t.colSpan||1,t.rowSpan&&t.rowSpan>1)for(i=1;i<t.rowSpan;i++)r["row_"+(n+i)]?r["row_"+(n+i)]++:r["row_"+(n+i)]=t.colSpan||1;u+=r["row_"+n]||0,f=Math.max(u,f)}return f},getCellColIndex:function(){},getHSideCell:function(n,t){try{var i=this.getCellInfo(n),e,o,r=this.selectedTds.length,u=this.cellsRange;return!t&&(r?!u.beginColIndex:!i.colIndex)||t&&(r?u.endColIndex==this.colsNum-1:i.colIndex==this.colsNum-1)?null:(e=r?u.beginRowIndex:i.rowIndex,o=t?r?u.endColIndex+1:i.colIndex+1:r?u.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[e][o].rowIndex,this.indexTable[e][o].cellIndex))}catch(s){f(s)}},getTabNextCell:function(n,t){var u=this.getCellInfo(n),i=t||u.rowIndex,r=u.colIndex+1+(u.colSpan-1),f;try{f=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(e){try{i=i*1+1,r=0,f=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(e){}}return f},getVSideCell:function(n,t,i){try{var r=this.getCellInfo(n),o,s,u=this.selectedTds.length&&!i,e=this.cellsRange;return!t&&r.rowIndex==0||t&&(u?e.endRowIndex==this.rowsNum-1:r.rowIndex+r.rowSpan>this.rowsNum-1)?null:(o=t?u?e.endRowIndex+1:r.rowIndex+r.rowSpan:u?e.beginRowIndex-1:r.rowIndex-1,s=u?e.beginColIndex:r.colIndex,this.getCell(this.indexTable[o][s].rowIndex,this.indexTable[o][s].cellIndex))}catch(h){f(h)}},getSameEndPosCells:function(t,i){var e,l,u,o;try{var r=i.toLowerCase()==="x",s=n.getXY(t)[r?"x":"y"]+t["offset"+(r?"Width":"Height")],a=this.table.rows,h=null,c=[];for(e=0;e<this.rowsNum;e++)for(h=a[e].cells,l=0;u=h[l++];){if(o=n.getXY(u)[r?"x":"y"]+u["offset"+(r?"Width":"Height")],o>s&&r)break;if((t==u||s==o)&&(u[r?"colSpan":"rowSpan"]==1&&c.push(u),r))break}return c}catch(v){f(v)}},setCellContent:function(t,r){t.innerHTML=r||(i.ie?n.fillChar:"<br />")},cloneCell:r.cloneCell,getSameStartPosXCells:function(t){var i,h,r,u;try{var e=n.getXY(t).x+t.offsetWidth,c=this.table.rows,o,s=[];for(i=0;i<this.rowsNum;i++)for(o=c[i].cells,h=0;r=o[h++];){if(u=n.getXY(r).x,u>e)break;if(u==e&&r.colSpan==1){s.push(r);break}}return s}catch(l){f(l)}},update:function(i){var a,w,o,s,l,r,b,u,f,g,e;this.table=i||this.table,this.selectedTds=[],this.cellsRange={},this.indexTable=[];for(var h=this.table.rows,c=this.getMaxRows(),tt=c-h.length,p=this.getMaxCols();tt--;)this.table.insertRow(h.length);for(this.rowsNum=c,this.colsNum=p,a=0,w=h.length;a<w;a++)this.indexTable[a]=new Array(p);for(o=0;s=h[o];o++)for(l=0,b=s.cells;r=b[l];l++){r.rowSpan>c&&(r.rowSpan=c);for(var v=l,k=r.rowSpan||1,d=r.colSpan||1;this.indexTable[o][v];)v++;for(u=0;u<k;u++)for(f=0;f<d;f++)this.indexTable[o+u][v+f]={rowIndex:o,cellIndex:l,colIndex:v,rowSpan:k,colSpan:d}}for(u=0;u<c;u++)for(f=0;f<p;f++)this.indexTable[u][f]===undefined&&(s=h[u],r=s.cells[s.cells.length-1],r=r?r.cloneNode(!0):this.table.ownerDocument.createElement("td"),this.setCellContent(r),r.colSpan!==1&&(r.colSpan=1),r.rowSpan!==1&&(r.rowSpan=1),s.appendChild(r),this.indexTable[u][f]={rowIndex:u,cellIndex:r.cellIndex,colIndex:f,rowSpan:1,colSpan:1});if(g=n.getElementsByTagName(this.table,"td"),e=[],t.each(g,function(t){n.hasClass(t,"selectTdClass")&&e.push(t)}),e.length){var it=e[0],rt=e[e.length-1],nt=this.getCellInfo(it),y=this.getCellInfo(rt);this.selectedTds=e,this.cellsRange={beginRowIndex:nt.rowIndex,beginColIndex:nt.colIndex,endRowIndex:y.rowIndex+y.rowSpan-1,endColIndex:y.colIndex+y.colSpan-1}}},getCellInfo:function(n){var t,i;if(n){var r=n.cellIndex,u=n.parentNode.rowIndex,f=this.indexTable[u],e=this.colsNum;for(t=r;t<e;t++)if(i=f[t],i.rowIndex===u&&i.cellIndex===r)return i}},getCell:function(n,t){return n<this.rowsNum&&this.table.rows[n].cells[t]||null},deleteCell:function(n,t){t=typeof t=="number"?t:n.parentNode.rowIndex;var i=this.table.rows[t];i.deleteCell(n.cellIndex)},getCellsRange:function(n,t){function f(n,t,i,u){var h=n,c=t,l=i,a=u,s,o,e;if(n>0)for(o=t;o<u;o++)s=r.indexTable[n][o],e=s.rowIndex,e<n&&(h=Math.min(e,h));if(u<r.colsNum)for(e=n;e<i;e++)s=r.indexTable[e][u],o=s.colIndex+s.colSpan-1,o>u&&(a=Math.max(o,a));if(i<r.rowsNum)for(o=t;o<u;o++)s=r.indexTable[i][o],e=s.rowIndex+s.rowSpan-1,e>i&&(l=Math.max(e,l));if(t>0)for(e=n;e<i;e++)s=r.indexTable[e][t],o=s.colIndex,o<t&&(c=Math.min(s.colIndex,c));return h!=n||c!=t||l!=i||a!=u?f(h,c,l,a):{beginRowIndex:n,beginColIndex:t,endRowIndex:i,endColIndex:u}}var r,i;try{if(r=this,i=r.getCellInfo(n),n===t)return{beginRowIndex:i.rowIndex,beginColIndex:i.colIndex,endRowIndex:i.rowIndex+i.rowSpan-1,endColIndex:i.colIndex+i.colSpan-1};var u=r.getCellInfo(t),e=Math.min(i.rowIndex,u.rowIndex),o=Math.min(i.colIndex,u.colIndex),s=Math.max(i.rowIndex+i.rowSpan-1,u.rowIndex+u.rowSpan-1),h=Math.max(i.colIndex+i.colSpan-1,u.colIndex+u.colSpan-1);return f(e,o,s,h)}catch(c){}},getCells:function(n){var r,u,e;this.clearSelected();var l=n.beginRowIndex,a=n.beginColIndex,o=n.endRowIndex,s=n.endColIndex,t,i,f,h={},c=[];for(r=l;r<=o;r++)for(u=a;u<=s;u++)if(t=this.indexTable[r][u],i=t.rowIndex,f=t.colIndex,e=i+"|"+f,!h[e]){if(h[e]=1,i<r||f<u||i+t.rowSpan-1>o||f+t.colSpan-1>s)return null;c.push(this.getCell(i,t.cellIndex))}return c},clearSelected:function(){r.removeSelectedClass(this.selectedTds),this.selectedTds=[],this.cellsRange={}},setSelected:function(n){var t=this.getCells(n);r.addSelectedClass(t),this.selectedTds=t,this.cellsRange=n},isFullRow:function(){var n=this.cellsRange;return n.endColIndex-n.beginColIndex+1==this.colsNum},isFullCol:function(){var t=this.cellsRange,i=this.table,r=i.getElementsByTagName("th"),n=t.endRowIndex-t.beginRowIndex+1;return r.length?n==this.rowsNum||n==this.rowsNum-1:n==this.rowsNum},getNextCell:function(n,t,i){try{var r=this.getCellInfo(n),o,s,u=this.selectedTds.length&&!i,e=this.cellsRange;return!t&&r.rowIndex==0||t&&(u?e.endRowIndex==this.rowsNum-1:r.rowIndex+r.rowSpan>this.rowsNum-1)?null:(o=t?u?e.endRowIndex+1:r.rowIndex+r.rowSpan:u?e.beginRowIndex-1:r.rowIndex-1,s=u?e.beginColIndex:r.colIndex,this.getCell(this.indexTable[o][s].rowIndex,this.indexTable[o][s].cellIndex))}catch(h){f(h)}},getPreviewCell:function(n,t){try{var i=this.getCellInfo(n),e,o,r=this.selectedTds.length,u=this.cellsRange;return!t&&(r?!u.beginColIndex:!i.colIndex)||t&&(r?u.endColIndex==this.colsNum-1:i.rowIndex>this.colsNum-1)?null:(e=t?r?u.beginRowIndex:i.rowIndex<1?0:i.rowIndex-1:r?u.beginRowIndex:i.rowIndex,o=t?r?u.endColIndex+1:i.colIndex:r?u.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[e][o].rowIndex,this.indexTable[e][o].cellIndex))}catch(s){f(s)}},moveContent:function(n,t){if(!r.isEmptyBlock(t)){if(r.isEmptyBlock(n)){n.innerHTML=t.innerHTML;return}var i=n.lastChild;for(i.nodeType!=3&&u.$block[i.tagName]||n.appendChild(n.ownerDocument.createElement("br"));i=t.firstChild;)n.appendChild(i)}},mergeRight:function(n){var t=this.getCellInfo(n),u=t.colIndex+t.colSpan,i=this.indexTable[t.rowIndex][u],r=this.getCell(i.rowIndex,i.cellIndex);n.colSpan=t.colSpan+i.colSpan,n.removeAttribute("width"),this.moveContent(n,r),this.deleteCell(r,i.rowIndex),this.update()},mergeDown:function(n){var t=this.getCellInfo(n),u=t.rowIndex+t.rowSpan,i=this.indexTable[u][t.colIndex],r=this.getCell(i.rowIndex,i.cellIndex);n.rowSpan=t.rowSpan+i.rowSpan,n.removeAttribute("height"),this.moveContent(n,r),this.deleteCell(r,i.rowIndex),this.update()},mergeRange:function(){var t=this.cellsRange,n=this.getCell(t.beginRowIndex,this.indexTable[t.beginRowIndex][t.beginColIndex].cellIndex),r,u,h,f,e,i,o,s;for(n.tagName=="TH"&&t.endRowIndex!==t.beginRowIndex&&(r=this.indexTable,u=this.getCellInfo(n),n=this.getCell(1,r[1][u.colIndex].cellIndex),t=this.getCellsRange(n,this.getCell(r[this.rowsNum-1][u.colIndex].rowIndex,r[this.rowsNum-1][u.colIndex].cellIndex))),h=this.getCells(t),i=0;f=h[i++];)f!==n&&(this.moveContent(n,f),this.deleteCell(f));if(n.rowSpan=t.endRowIndex-t.beginRowIndex+1,n.rowSpan>1&&n.removeAttribute("height"),n.colSpan=t.endColIndex-t.beginColIndex+1,n.colSpan>1&&n.removeAttribute("width"),n.rowSpan==this.rowsNum&&n.colSpan!=1&&(n.colSpan=1),n.colSpan==this.colsNum&&n.rowSpan!=1){if(e=n.parentNode.rowIndex,this.table.deleteRow)for(var i=e+1,c=e+1,o=n.rowSpan;i<o;i++)this.table.deleteRow(c);else for(i=0,o=n.rowSpan-1;i<o;i++)s=this.table.rows[e+1],s.parentNode.removeChild(s);n.rowSpan=1}this.update()},insertRow:function(n,t){var u=this.colsNum,o=this.table,e=o.insertRow(n),i,c=parseInt((o.offsetWidth-u*20-u-1)/u,10),r,s,h,f;if(n==0||n==this.rowsNum)for(r=0;r<u;r++)i=this.cloneCell(t,!0),this.setCellContent(i),i.getAttribute("vAlign")&&i.setAttribute("vAlign",i.getAttribute("vAlign")),e.appendChild(i);else for(s=this.indexTable[n],h=0,r=0;r<u;r++)f=s[r],f.rowIndex<n?(i=this.getCell(f.rowIndex,f.cellIndex),i.rowSpan=f.rowSpan+1):(i=this.cloneCell(t,!0),this.setCellContent(i),e.appendChild(i));return this.update(),e},deleteRow:function(i){for(var a=this.table.rows[i],s=this.indexTable[i],v=this.colsNum,y=0,e,u,f,h,c,l,r=0;r<v;){if(e=s[r],u=this.getCell(e.rowIndex,e.cellIndex),u.rowSpan>1&&e.rowIndex==i){f=u.cloneNode(!0),f.rowSpan=u.rowSpan-1,f.innerHTML="",u.rowSpan=1;var p=i+1,o=this.table.rows[p],w,b=this.getPreviewMergedCellsNum(p,r)-y;b<r?(w=r-b-1,n.insertAfter(o.cells[w],f)):o.cells.length&&o.insertBefore(f,o.cells[0]),y+=1}r+=u.colSpan||1}for(h=[],c={},r=0;r<v;r++){var k=s[r].rowIndex,d=s[r].cellIndex,g=k+"_"+d;c[g]||(c[g]=1,u=this.getCell(k,d),h.push(u))}l=[],t.each(h,function(n){n.rowSpan==1?n.parentNode.removeChild(n):l.push(n)}),t.each(l,function(n){n.rowSpan--}),a.parentNode.removeChild(a),this.update()},insertCol:function(t,i,r){function c(t,i,r){var u,f;t==0?(u=i.nextSibling||i.previousSibling,u.tagName=="TH"&&(u=i.ownerDocument.createElement("th"),u.appendChild(i.firstChild),r.insertBefore(u,i),n.remove(i))):i.tagName=="TH"&&(f=i.ownerDocument.createElement("td"),f.appendChild(i.firstChild),r.insertBefore(f,i),n.remove(i))}var h=this.rowsNum,e=0,f,u,l=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),o,s;if(t==0||t==this.colsNum)for(;e<h;e++)f=this.table.rows[e],o=f.cells[t==0?t:f.cells.length],u=this.cloneCell(i,!0),this.setCellContent(u),u.setAttribute("vAlign",u.getAttribute("vAlign")),o&&u.setAttribute("width",o.getAttribute("width")),t?n.insertAfter(f.cells[f.cells.length-1],u):f.insertBefore(u,f.cells[0]),c(e,u,f);else for(;e<h;e++)s=this.indexTable[e][t],s.colIndex<t?(u=this.getCell(s.rowIndex,s.cellIndex),u.colSpan=s.colSpan+1):(f=this.table.rows[e],o=f.cells[s.cellIndex],u=this.cloneCell(i,!0),this.setCellContent(u),u.setAttribute("vAlign",u.getAttribute("vAlign")),o&&u.setAttribute("width",o.getAttribute("width")),o?f.insertBefore(u,o):f.appendChild(u)),c(e,u,f);this.update(),this.updateWidth(l,r||{tdPadding:10,tdBorder:1})},updateWidth:function(i,u){var f=this.table,e=r.getWidth(f)-u.tdPadding*2-u.tdBorder+i,o;if(e<f.ownerDocument.body.offsetWidth){f.setAttribute("width",e);return}o=n.getElementsByTagName(this.table,"td"),t.each(o,function(n){n.setAttribute("width",i)})},deleteCol:function(n){for(var o=this.indexTable,s=this.table.rows,h=this.table.getAttribute("width"),u=0,c=this.rowsNum,f={},i,r=0;r<c;){var l=o[r],t=l[n],e=t.rowIndex+"_"+t.colIndex;f[e]||(f[e]=1,i=this.getCell(t.rowIndex,t.cellIndex),u||(u=i&&parseInt(i.offsetWidth/i.colSpan,10).toFixed(0)),i.colSpan>1?i.colSpan--:s[r].deleteCell(t.cellIndex),r+=t.rowSpan||1)}this.table.setAttribute("width",h-u),this.update()},splitToCells:function(n){var i=this,r=this.splitToRows(n);t.each(r,function(n){i.splitToCols(n)})},splitToRows:function(n){var r=this.getCellInfo(n),u=r.rowIndex,e=r.colIndex,f=[],i,o,s,t;for(n.rowSpan=1,f.push(n),i=u,o=u+r.rowSpan;i<o;i++)i!=u&&(s=this.table.rows[i],t=s.insertCell(e-this.getPreviewMergedCellsNum(i,e)),t.colSpan=r.colSpan,this.setCellContent(t),t.setAttribute("vAlign",n.getAttribute("vAlign")),t.setAttribute("align",n.getAttribute("align")),n.style.cssText&&(t.style.cssText=n.style.cssText),f.push(t));return this.update(),f},getPreviewMergedCellsNum:function(n,t){for(var u=this.indexTable[n],f=0,r,e,i=0;i<t;)r=u[i].colSpan,e=u[i].rowIndex,f+=r-(e==n?1:0),i+=r;return f},splitToCols:function(t){var h=(t.offsetWidth/t.colSpan-22).toFixed(0),f=this.getCellInfo(t),c=f.rowIndex,e=f.colIndex,o=[],r,l,s,i,u;for(t.colSpan=1,t.setAttribute("width",h),o.push(t),r=e,l=e+f.colSpan;r<l;r++)r!=e&&(s=this.table.rows[c],i=s.insertCell(this.indexTable[c][r].cellIndex+1),i.rowSpan=f.rowSpan,this.setCellContent(i),i.setAttribute("vAlign",t.getAttribute("vAlign")),i.setAttribute("align",t.getAttribute("align")),i.setAttribute("width",h),t.style.cssText&&(i.style.cssText=t.style.cssText),t.tagName=="TH"&&(u=t.ownerDocument.createElement("th"),u.appendChild(i.firstChild),u.setAttribute("vAlign",t.getAttribute("vAlign")),u.rowSpan=i.rowSpan,s.insertBefore(u,i),n.remove(i)),o.push(i));return this.update(),o},isLastCell:function(n,t,i){t=t||this.rowsNum,i=i||this.colsNum;var r=this.getCellInfo(n);return r.rowIndex+r.rowSpan==t&&r.colIndex+r.colSpan==i},getLastCell:function(n){n=n||this.table.getElementsByTagName("td");var s=this.getCellInfo(n[0]),e=this,i=n[0],o=i.parentNode,u=0,r=0,f;return t.each(n,function(n){n.parentNode==o&&(r+=n.colSpan||1),u+=n.rowSpan*n.colSpan||1}),f=u/r,t.each(n,function(n){if(e.isLastCell(n,f,r))return i=n,!1}),i},selectRow:function(n){var t=this.indexTable[n],i=this.getCell(t[0].rowIndex,t[0].cellIndex),r=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),u=this.getCellsRange(i,r);this.setSelected(u)},selectTable:function(){var n=this.table.getElementsByTagName("td"),t=this.getCellsRange(n[0],n[n.length-1]);this.setSelected(t)},sortTable:function(n,i){var c=this.table,o=c.rows,u=[],v=o[0].cells[0].tagName==="TH",l=0,f,r,s,h,e,a;if(this.selectedTds.length){for(f=this.cellsRange,e=f.endRowIndex+1,r=f.beginRowIndex;r<e;r++)u[r]=o[r];u.splice(0,f.beginRowIndex),l=f.endRowIndex+1===this.rowsNum?0:f.endRowIndex+1}else for(r=0,e=o.length;r<e;r++)u[r]=o[r];for(v&&u.splice(0,1),u=t.sort(u,function(t,r){var u=function(n){return n.innerText||n.textContent};return i?typeof i=="number"?i:i.call(this,t.cells[n],r.cells[n]):function(){var i=u(t.cells[n]),f=u(r.cells[n]);return i.localeCompare(f)}()}),s=c.ownerDocument.createDocumentFragment(),h=0,e=u.length;h<e;h++)s.appendChild(u[h]);a=c.getElementsByTagName("tbody")[0],l?a.insertBefore(s,o[l-f.endRowIndex+f.beginRowIndex-1]):a.appendChild(s)},setBackground:function(n,i){var f,u,e;if(typeof i=="string")t.each(n,function(n){n.style.backgroundColor=i});else if(typeof i=="object"){i=t.extend({repeat:!0,colorList:["#ddd","#fff"]},i);var o=this.getCellInfo(n[0]).rowIndex,r=0,s=i.colorList,h=function(n,t,i){return n[t]?n[t]:i?n[t%n.length]:""};for(f=0;u=n[f++];)e=this.getCellInfo(u),u.style.backgroundColor=h(s,o+r==e.rowIndex?r:++r,i.repeat)}},removeBackground:function(n){t.each(n,function(n){n.style.backgroundColor=""})}}}(),function(){function h(n,i){var r=n.getElementsByTagName("td");t.each(r,function(n){n.removeAttribute("width")}),n.setAttribute("width",c(i,!0,s(i,n))),setTimeout(function(){t.each(r,function(n){n.colSpan==1&&n.setAttribute("width",n.offsetWidth+"")})},0)}function c(t,i,r){var u=t.body;return u.offsetWidth-(i?parseInt(n.getComputedStyle(u,"margin-left"),10)*2:0)-r.tableBorder*2-(t.options.offsetWidth||0)}function f(n){var t=r(n).cell,i;return t?(i=u(t),i.selectedTds.length?i.selectedTds:[t]):[]}var o=UE.UETable,r=function(n){return o.getTableItemsByRange(n)},e=function(n){return o.getUETableBySelected(n)},s=function(n,t){return o.getDefaultValue(n,t)},u=function(n){return o.getUETable(n)};UE.commands.inserttable={queryCommandState:function(){return r(this).table?-1:0},execCommand:function(r,u){function o(t,r){for(var u=[],o=t.numRows,s=t.numCols,e,f=0;f<o;f++){for(u.push("<tr>"),e=0;e<s;e++)u.push('<td width="'+r+'"  vAlign="'+t.tdvalign+'" >'+(i.ie?n.fillChar:"<br/>")+"<\/td>");u.push("<\/tr>")}return"<table><tbody>"+u.join("")+"<\/tbody><\/table>"}u||(u=t.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));var f=this,h=this.selection.getRange(),c=h.startContainer,l=n.findParent(c,function(t){return n.isBlockElm(t)},!0)||f.body,e=s(f),a=l.offsetWidth,v=Math.floor(a/u.numCols-e.tdPadding*2-e.tdBorder);u.tdvalign||(u.tdvalign=f.options.tdvalign),f.execCommand("inserthtml",o(u,v))}},UE.commands.insertparagraphbeforetable={queryCommandState:function(){return r(this).cell?0:-1},execCommand:function(){var t=r(this).table,n;t&&(n=this.document.createElement("p"),n.innerHTML=i.ie?"&nbsp;":"<br />",t.parentNode.insertBefore(n,t),this.selection.getRange().setStart(n,0).setCursor())}},UE.commands.deletetable={queryCommandState:function(){var t=this.selection.getRange();return n.findParentByTagName(t.startContainer,"table",!0)?0:-1},execCommand:function(t,r){var f=this.selection.getRange(),u;r=r||n.findParentByTagName(f.startContainer,"table",!0),r&&(u=r.nextSibling,u||(u=n.createElement(this.document,"p",{innerHTML:i.ie?n.fillChar:"<br/>"}),r.parentNode.insertBefore(u,r)),n.remove(r),f=this.selection.getRange(),u.nodeType==3?f.setStartBefore(u):f.setStart(u,0),f.setCursor(!1,!0),this.fireEvent("tablehasdeleted"))}},UE.commands.cellalign={queryCommandState:function(){return f(this).length?0:-1},execCommand:function(n,t){var i=f(this),r,u;if(i.length)for(r=0;u=i[r++];)u.setAttribute("align",t)}},UE.commands.cellvalign={queryCommandState:function(){return f(this).length?0:-1},execCommand:function(n,t){var i=f(this),r,u;if(i.length)for(r=0;u=i[r++];)u.setAttribute("vAlign",t)}},UE.commands.insertcaption={queryCommandState:function(){var n=r(this).table;return n?n.getElementsByTagName("caption").length==0?1:-1:-1},execCommand:function(){var u=r(this).table,t,f;u&&(t=this.document.createElement("caption"),t.innerHTML=i.ie?n.fillChar:"<br/>",u.insertBefore(t,u.firstChild),f=this.selection.getRange(),f.setStart(t,0).setCursor())}},UE.commands.deletecaption={queryCommandState:function(){var i=this.selection.getRange(),t=n.findParentByTagName(i.startContainer,"table");return t?t.getElementsByTagName("caption").length==0?-1:1:-1},execCommand:function(){var r=this.selection.getRange(),t=n.findParentByTagName(r.startContainer,"table"),i;t&&(n.remove(t.getElementsByTagName("caption")[0]),i=this.selection.getRange(),i.setStart(t.rows[0].cells[0],0).setCursor())}},UE.commands.inserttitle={queryCommandState:function(){var n=r(this).table,t;return n?(t=n.rows[0],t.getElementsByTagName("th").length==0?0:-1):-1},execCommand:function(){var n=r(this).table,t;n&&u(n).insertRow(0,"th"),t=n.getElementsByTagName("th")[0],this.selection.getRange().setStart(t,0).setCursor(!1,!0)}},UE.commands.deletetitle={queryCommandState:function(){var n=r(this).table,t;return n?(t=n.rows[0],t.getElementsByTagName("th").length?0:-1):-1},execCommand:function(){var t=r(this).table,i;t&&n.remove(t.rows[0]),i=t.getElementsByTagName("td")[0],this.selection.getRange().setStart(i,0).setCursor(!1,!0)}},UE.commands.mergeright={queryCommandState:function(){var i=r(this),t,n,f,e;return i.cell?(t=u(i.table),t.selectedTds.length)?-1:(n=t.getCellInfo(i.cell),f=n.colIndex+n.colSpan,f>=t.colsNum)?-1:(e=t.indexTable[n.rowIndex][f],e.rowIndex==n.rowIndex&&e.rowSpan==n.rowSpan?0:-1):-1},execCommand:function(){var n=this.selection.getRange(),i=n.createBookmark(!0),t=r(this).cell,f=u(t);f.mergeRight(t),n.moveToBookmark(i).select()}},UE.commands.mergedown={queryCommandState:function(){var i=r(this),o=i.cell,t,n,f,e;return!o||o.tagName=="TH"?-1:(t=u(i.table),t.selectedTds.length)?-1:(n=t.getCellInfo(i.cell),f=n.rowIndex+n.rowSpan,f>=t.rowsNum)?-1:(e=t.indexTable[f][n.colIndex],e.colIndex==n.colIndex&&e.colSpan==n.colSpan&&i.cell.tagName!=="TH"?0:-1)},execCommand:function(){var n=this.selection.getRange(),i=n.createBookmark(!0),t=r(this).cell,f=u(t);f.mergeDown(t),n.moveToBookmark(i).select()}},UE.commands.mergecells={queryCommandState:function(){return e(this)?0:-1},execCommand:function(){var t=e(this),i,r;t&&t.selectedTds.length&&(i=t.selectedTds[0],t.mergeRange(),r=this.selection.getRange(),n.isEmptyBlock(i)?r.setStart(i,0).collapse(!0):r.selectNodeContents(i),r.select())}},UE.commands.insertrow={queryCommandState:function(){var n=r(this),t=n.cell;return t&&t.tagName=="TD"&&u(n.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var o=this.selection.getRange(),c=o.createBookmark(!0),s=r(this),i=s.cell,f=s.table,n=u(f),l=n.getCellInfo(i),t,e,h;if(n.selectedTds.length)for(t=n.cellsRange,e=0,h=t.endRowIndex-t.beginRowIndex+1;e<h;e++)n.insertRow(t.beginRowIndex,i);else n.insertRow(l.rowIndex,i);o.moveToBookmark(c).select(),f.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",f)}},UE.commands.insertrownext={queryCommandState:function(){var n=r(this),t=n.cell;return t&&t.tagName=="TD"&&u(n.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var o=this.selection.getRange(),l=o.createBookmark(!0),s=r(this),i=s.cell,f=s.table,n=u(f),h=n.getCellInfo(i),t,e,c;if(n.selectedTds.length)for(t=n.cellsRange,e=0,c=t.endRowIndex-t.beginRowIndex+1;e<c;e++)n.insertRow(t.endRowIndex+1,i);else n.insertRow(h.rowIndex+h.rowSpan,i);o.moveToBookmark(l).select(),f.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",f)}},UE.commands.deleterow={queryCommandState:function(){var n=r(this);if(!n.cell)return-1},execCommand:function(){var s=r(this).cell,i=u(s),f=i.cellsRange,e=i.getCellInfo(s),v=i.getVSideCell(s),y=i.getVSideCell(s,!0),h=this.selection.getRange(),c,o,l,a;if(t.isEmptyObject(f))i.deleteRow(e.rowIndex);else for(c=f.beginRowIndex;c<f.endRowIndex+1;c++)i.deleteRow(f.beginRowIndex);o=i.table,o.getElementsByTagName("td").length?e.rowSpan==1||e.rowSpan==f.endRowIndex-f.beginRowIndex+1?(y||v)&&h.selectNodeContents(y||v).setCursor(!1,!0):(a=i.getCell(e.rowIndex,i.indexTable[e.rowIndex][e.colIndex].cellIndex),a&&h.selectNodeContents(a).setCursor(!1,!0)):(l=o.nextSibling,n.remove(o),l&&h.setStart(l,0).setCursor(!1,!0)),o.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",o)}},UE.commands.insertcol={queryCommandState:function(){var t=r(this),n=t.cell;return n&&(n.tagName=="TD"||n.tagName=="TH")&&u(t.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(n){var o=this.selection.getRange(),h=o.createBookmark(!0),f,e,s;if(this.queryCommandState(n)!=-1){var i=r(this).cell,t=u(i),c=t.getCellInfo(i);if(t.selectedTds.length)for(f=t.cellsRange,e=0,s=f.endColIndex-f.beginColIndex+1;e<s;e++)t.insertCol(f.beginColIndex,i);else t.insertCol(c.colIndex,i);o.moveToBookmark(h).select(!0)}}},UE.commands.insertcolnext={queryCommandState:function(){var n=r(this),t=n.cell;return t&&u(n.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e=this.selection.getRange(),h=e.createBookmark(!0),t=r(this).cell,n=u(t),o=n.getCellInfo(t),i,f,s;if(n.selectedTds.length)for(i=n.cellsRange,f=0,s=i.endColIndex-i.beginColIndex+1;f<s;f++)n.insertCol(i.endColIndex+1,t);else n.insertCol(o.colIndex+o.colSpan,t);e.moveToBookmark(h).select()}},UE.commands.deletecol={queryCommandState:function(){var n=r(this);if(!n.cell)return-1},execCommand:function(){var f=r(this).cell,i=u(f),o=i.cellsRange,v=i.getCellInfo(f),h=i.getHSideCell(f),c=i.getHSideCell(f,!0),l,s,e,a;if(t.isEmptyObject(o))i.deleteCol(v.colIndex);else for(l=o.beginColIndex;l<o.endColIndex+1;l++)i.deleteCol(o.beginColIndex);s=i.table,e=this.selection.getRange(),s.getElementsByTagName("td").length?n.inDoc(f,this.document)?e.setStart(f,0).setCursor(!1,!0):c&&n.inDoc(c,this.document)?e.selectNodeContents(c).setCursor(!1,!0):h&&n.inDoc(h,this.document)&&e.selectNodeContents(h).setCursor(!0,!0):(a=s.nextSibling,n.remove(s),a&&e.setStart(a,0).setCursor(!1,!0))}},UE.commands.splittocells={queryCommandState:function(){var t=r(this),n=t.cell,i;return n?(i=u(t.table),i.selectedTds.length>0)?-1:n&&(n.colSpan>1||n.rowSpan>1)?0:-1:-1},execCommand:function(){var n=this.selection.getRange(),i=n.createBookmark(!0),t=r(this).cell,f=u(t);f.splitToCells(t),n.moveToBookmark(i).select()}},UE.commands.splittorows={queryCommandState:function(){var t=r(this),n=t.cell,i;return n?(i=u(t.table),i.selectedTds.length>0)?-1:n&&n.rowSpan>1?0:-1:-1},execCommand:function(){var n=this.selection.getRange(),i=n.createBookmark(!0),t=r(this).cell,f=u(t);f.splitToRows(t),n.moveToBookmark(i).select()}},UE.commands.splittocols={queryCommandState:function(){var t=r(this),n=t.cell,i;return n?(i=u(t.table),i.selectedTds.length>0)?-1:n&&n.colSpan>1?0:-1:-1},execCommand:function(){var n=this.selection.getRange(),i=n.createBookmark(!0),t=r(this).cell,f=u(t);f.splitToCols(t),n.moveToBookmark(i).select()}},UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return r(this).table?0:-1},execCommand:function(i){var e=r(this),u=e.table,f;u&&(i=="adaptbywindow"?h(u,this):(f=n.getElementsByTagName(u,"td th"),t.each(f,function(n){n.removeAttribute("width")}),u.removeAttribute("width")))}},UE.commands.averagedistributecol={queryCommandState:function(){var n=e(this);return n?n.isFullRow()||n.isFullCol()?0:-1:-1},execCommand:function(){function u(){var e=i.table,t=0,u=0,o=s(r,e),h,c,f,n;if(i.isFullRow())t=e.offsetWidth,u=i.colsNum;else for(h=i.cellsRange.beginColIndex,c=i.cellsRange.endColIndex,n=h;n<=c;)f=i.selectedTds[n],t+=f.offsetWidth,n+=f.colSpan,u+=1;return Math.ceil(t/u)-o.tdBorder*2-o.tdPadding*2}function f(r){t.each(n.getElementsByTagName(i.table,"th"),function(n){n.setAttribute("width","")});var u=i.isFullRow()?n.getElementsByTagName(i.table,"td"):i.selectedTds;t.each(u,function(n){n.colSpan==1&&n.setAttribute("width",r)})}var r=this,i=e(r);i&&i.selectedTds.length&&f(u())}},UE.commands.averagedistributerow={queryCommandState:function(){var n=e(this);return n?n.selectedTds&&/th/ig.test(n.selectedTds[0].tagName)?-1:n.isFullRow()||n.isFullCol()?0:-1:-1},execCommand:function(){function f(){var f,e=0,t=r.table,y=s(u,t),p=parseInt(n.getComputedStyle(t.getElementsByTagName("td")[0],"padding-top")),c,o,l,a,h;if(r.isFullCol())c=n.getElementsByTagName(t,"caption"),o=n.getElementsByTagName(t,"th"),c.length>0&&(l=c[0].offsetHeight),o.length>0&&(a=o[0].offsetHeight),e=t.offsetHeight-(l||0)-(a||0),f=o.length==0?r.rowsNum:r.rowsNum-1;else{var w=r.cellsRange.beginRowIndex,b=r.cellsRange.endRowIndex,v=0,k=n.getElementsByTagName(t,"tr");for(h=w;h<=b;h++)e+=k[h].offsetHeight,v+=1;f=v}return i.ie&&i.version<9?Math.ceil(e/f):Math.ceil(e/f)-y.tdBorder*2-p*2}function o(i){var u=r.isFullCol()?n.getElementsByTagName(r.table,"td"):r.selectedTds;t.each(u,function(n){n.rowSpan==1&&n.setAttribute("height",i)})}var u=this,r=e(u);r&&r.selectedTds.length&&o(f())}},UE.commands.cellalignment={queryCommandState:function(){return r(this).table?0:-1},execCommand:function(i,r){var f=this,s=e(f),o,u;s?t.each(s.selectedTds,function(t){n.setAttributes(t,r)}):(o=f.selection.getStart(),u=o&&n.findParentByTagName(o,["td","th","caption"],!0),/caption/ig.test(u.tagName)?(u.style.textAlign=r.align,u.style.verticalAlign=r.vAlign):n.setAttributes(u,r),f.selection.getRange().setCursor(!0))},queryCommandValue:function(){var n=r(this).cell,t;return n||(n=f(this)[0]),n?(t=UE.UETable.getUETable(n).selectedTds,t.length||(t=n),UE.UETable.getTableCellAlignState(t)):null}},UE.commands.tablealignment={queryCommandState:function(){return i.ie&&i.version<8?-1:r(this).table?0:-1},execCommand:function(t,i){var f=this,r=f.selection.getStart(),u=r&&n.findParentByTagName(r,["table"],!0);u&&u.setAttribute("align",i)}},UE.commands.edittable={queryCommandState:function(){return r(this).table?0:-1},execCommand:function(i,r){var e=this.selection.getRange(),u=n.findParentByTagName(e.startContainer,"table"),f;u&&(f=n.getElementsByTagName(u,"td").concat(n.getElementsByTagName(u,"th"),n.getElementsByTagName(u,"caption")),t.each(f,function(n){n.style.borderColor=r}))}},UE.commands.edittd={queryCommandState:function(){return r(this).table?0:-1},execCommand:function(i,r){var o=this,s=e(o),u,f;s?t.each(s.selectedTds,function(n){n.style.backgroundColor=r}):(u=o.selection.getStart(),f=u&&n.findParentByTagName(u,["td","th","caption"],!0),f&&(f.style.backgroundColor=r))}},UE.commands.sorttable={queryCommandState:function(){var e=this,t=r(e),i,u,f,n;if(!t.cell)return-1;for(i=t.table,u=i.getElementsByTagName("td"),f=0;n=u[f++];)if(n.rowSpan!=1||n.colSpan!=1)return-1;return 0},execCommand:function(n,t){var i=this,f=i.selection.getRange(),s=f.createBookmark(!0),e=r(i),h=e.cell,o=u(e.table),c=o.getCellInfo(h);o.sortTable(c.cellIndex,t),f.moveToBookmark(s).select()}},UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(){return r(this).table?0:-1},execCommand:function(n){var t=r(this).table;t.setAttribute("data-sort",n=="enablesort"?"sortEnabled":"sortDisabled")}},UE.commands.settablebackground={queryCommandState:function(){return f(this).length>1?0:-1},execCommand:function(n,t){var i,r;i=f(this),r=u(i[0]),r.setBackground(i,t)}},UE.commands.cleartablebackground={queryCommandState:function(){var n=f(this),t,i;if(!n.length)return-1;for(t=0;i=n[t++];)if(i.style.backgroundColor!=="")return 0;return-1},execCommand:function(){var n=f(this),t=u(n[0]);t.removeBackground(n)}},UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(n){var i=r(this).table,t;return i?(t=i.getAttribute("interlaced"),n=="interlacetable"?t==="enabled"?-1:0:!t||t==="disabled"?-1:0):-1},execCommand:function(n,t){var i=r(this).table;n=="interlacetable"?(i.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",i,t)):(i.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",i))}}}(),UE.plugins.table=function(){function yt(){}function ri(n){ui(n,"width",!0),ui(n,"height",!0)}function ui(n,t,i){n.style[t]&&(i&&n.setAttribute(t,parseInt(n.style[t],10)),n.style[t]="")}function bt(t){if(t.tagName=="TD"||t.tagName=="TH")return t;var i;return(i=n.findParentByTagName(t,"td",!0)||n.findParentByTagName(t,"th",!0))?i:null}function ot(t){var f=new RegExp(n.fillChar,"g"),r;if(t[i.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(f,"").length>0)return 0;for(r in u.$isNotEmpty)if(t.getElementsByTagName(r).length)return 0;return 1}function w(n){return n.pageX||n.pageY?{x:n.pageX,y:n.pageY}:{x:n.clientX+r.document.body.scrollLeft-r.document.body.clientLeft,y:n.clientY+r.document.body.scrollTop-r.document.body.clientTop}}function yi(t){var u,o,f,e,s;if(!ht())try{if(u=bt(t.target||t.srcElement),tt&&(r.body.style.webkitUserSelect="none",(Math.abs(d.x-t.clientX)>ni||Math.abs(d.y-t.clientY)>ni)&&(kt(),tt=!1,c=0,ei(t))),p&&a){c=0,r.body.style.webkitUserSelect="none",r.selection.getNative()[i.ie?"empty":"removeAllRanges"](),o=w(t),b(r,!0,p,o,u),p=="h"?v.style.left=bi(a,t)+"px":p=="v"&&(v.style.top=ki(a,t)+"px");return}if(u){if(r.fireEvent("excludetable",u)===!0)return;if(o=w(t),f=st(u,o),e=n.findParentByTagName(u,"table",!0),it(e,u,t,!0)){if(r.fireEvent("excludetable",e)===!0)return;r.body.style.cursor="url("+r.options.cursorpath+"h.png),pointer"}else if(it(e,u,t)){if(r.fireEvent("excludetable",e)===!0)return;r.body.style.cursor="url("+r.options.cursorpath+"v.png),pointer"}else r.body.style.cursor="text",s=u,/\d/.test(f)&&(f=f.replace(/\d/,""),u=h(u).getPreviewCell(u,f=="v")),b(r,u?!!f:!1,u?f:"",o,u)}else fi(!1,e,r)}catch(l){yt(l)}}function fi(n,t,i){if(n)wi(t,i);else{if(et)return;pi=setTimeout(function(){!et&&f&&f.parentNode&&f.parentNode.removeChild(f)},2e3)}}function wi(t,i){function o(n,u){clearTimeout(r),r=setTimeout(function(){i.fireEvent("tableClicked",t,u)},300)}function s(){clearTimeout(r);var n=h(t),u=t.rows[0].cells[0],f=n.getLastCell(),e=n.getCellsRange(u,f);i.selection.getRange().setStart(u,0).setCursor(!1,!0),n.setSelected(e)}var u=n.getXY(t),e=t.ownerDocument,r;if(f&&f.parentNode)return f;f=e.createElement("div"),f.contentEditable=!1,f.innerHTML="",f.style.cssText="width:15px;height:15px;background-image:url("+i.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(u.y-15)+"px;left:"+u.x+"px;",n.unSelectable(f),f.onmouseover=function(){et=!0},f.onmouseout=function(){et=!1};n.on(f,"click",function(n,t){o(t,this)});n.on(f,"dblclick",function(n,t){s(t)});n.on(f,"dragstart",function(t,i){n.preventDefault(i)});e.body.appendChild(f)}function it(t,i,r,u){var f=w(r),o=st(i,f),e,s;return u?(e=t.getElementsByTagName("caption")[0],s=e?e.offsetHeight:0,o=="v1"&&f.y-n.getXY(t).y-s<8):o=="h1"&&f.x-n.getXY(t).x<8}function bi(t,i){var u=h(t);if(u){var c=u.getSameEndPosCells(t,"x")[0],f=u.getSameStartPosXCells(t)[0],e=w(i).x,o=(c?n.getXY(c).x:n.getXY(u.table).x)+20,s=f?n.getXY(f).x+f.offsetWidth-20:r.body.offsetWidth+5||parseInt(n.getComputedStyle(r.body,"width"),10);return o+=at,s-=at,e<o?o:e>s?s:e}}function ki(t,i){try{var r=n.getXY(t).y,u=w(i).y;return u<r?r:u}catch(f){yt(f)}}function b(n,t,r,u,f){try{n.body.style.cursor=r=="h"?"col-resize":r=="v"?"row-resize":"text",i.ie&&(!r||g||l(n)?nt(n):(ci(n,n.document),li(r,f))),pt=t}catch(e){yt(e)}}function st(t,i){var r=n.getXY(t);return r?r.x+t.offsetWidth-i.x<k?"h":i.x-r.x<k?"h1":r.y+t.offsetHeight-i.y<k?"v":i.y-r.y<k?"v1":"":""}function di(i,u){var f,o,e;ht()||(d={x:u.clientX,y:u.clientY},u.button==2?(f=l(r),o=!1,f&&(e=ai(r,u),t.each(f.selectedTds,function(n){n===e&&(o=!0)}),o?(e=f.selectedTds[0],setTimeout(function(){r.selection.getRange().setStart(e,0).setCursor(!1,!0)},0)):(ft(n.getElementsByTagName(r.body,"th td")),f.clearSelected()))):nr(u))}function gi(i){var u,e,a,o,l;if(c=0,i=i||r.window.event,u=bt(i.target||i.srcElement),u&&(e=st(u,w(i)))&&(nt(r),e=="h1"&&(e="h",it(n.findParentByTagName(u,"table"),u,i)?r.execCommand("adaptbywindow"):(u=h(u).getPreviewCell(u),u&&(a=r.selection.getRange(),a.selectNodeContents(u).setCursor(!0,!0)))),e=="h")){var s=h(u),v=s.table,f=hi(u,v,!0);f=ir(f,"left"),s.width=s.offsetWidth,o=[],l=[],t.each(f,function(n){o.push(n.offsetWidth)}),t.each(f,function(n){n.removeAttribute("width")}),window.setTimeout(function(){var n=!0,i;t.each(f,function(t,i){var r=t.offsetWidth;if(r>o[i])return n=!1,!1;l.push(r)}),i=n?l:o,t.each(f,function(n,t){n.width=i[t]-ct()})},0)}}function nr(i){if(ft(n.getElementsByTagName(r.body,"td th")),t.each(r.document.getElementsByTagName("table"),function(n){n.ueTable=null}),o=ai(r,i),o){var u=n.findParentByTagName(o,"table",!0);ut=h(u),ut&&ut.clearSelected(),pt?tr(i):(r.document.body.style.webkitUserSelect="",g=!0,r.addListener("mouseover",si))}}function tr(n){i.ie&&(n=rr(n)),kt(),tt=!0,rt=setTimeout(function(){ei(n)},ti)}function ir(n,t){for(var u=[],r=null,i=0,f=n.length;i<f;i++)r=n[i][t],r&&u.push(r);return u}function kt(){rt&&clearTimeout(rt),rt=null}function rr(n){var f=["pageX","pageY","clientX","clientY","srcElement","target"],u={},t,i,r;if(n)for(t=0;i=f[t];t++)r=n[i],r&&(u[i]=r);return u}function ei(n){if(tt=!1,o){var t=Math.abs(d.x-n.clientX)>=Math.abs(d.y-n.clientY)?"h":"v";/\d/.test(t)&&(t=t.replace(/\d/,""),o=h(o).getPreviewCell(o,t=="v")),nt(r),ci(r,r.document),r.fireEvent("saveScene"),li(t,o),g=!0,p=t,a=o}}function oi(t,r){var b,k,y,it,w,s,l;if(!ht()){if(kt(),tt=!1,pt&&(c=++c%3,d={x:r.clientX,y:r.clientY},vi=setTimeout(function(){c>0&&c--},ti),c===2)){c=0,gi(r);return}if(r.button!=2){var u=this,f=u.selection.getRange(),s=n.findParentByTagName(f.startContainer,"table",!0),l=n.findParentByTagName(f.endContainer,"table",!0);if((s||l)&&(s===l?(s=n.findParentByTagName(f.startContainer,["td","th","caption"],!0),l=n.findParentByTagName(f.endContainer,["td","th","caption"],!0),s!==l&&u.selection.clearRange()):u.selection.clearRange()),g=!1,u.document.body.style.webkitUserSelect="",p&&a){u.selection.getNative()[i.ie?"empty":"removeAllRanges"](),c=0,v=u.document.getElementById("ue_tableDragLine"),b=n.getXY(a),k=n.getXY(v);switch(p){case"h":fr(a,k.x-b.x);break;case"v":er(a,k.y-b.y-a.offsetHeight)}p="",a=null,nt(u),u.fireEvent("saveScene");return}if(o)it=h(o),w=it?it.selectedTds[0]:null,w?(f=new e.Range(u.document),n.isEmptyBlock(w)?f.setStart(w,0).setCursor(!1,!0):f.selectNodeContents(w).shrinkBoundary().setCursor(!1,!0)):(f=u.selection.getRange().shrinkBoundary(),f.collapsed||(s=n.findParentByTagName(f.startContainer,["td","th"],!0),l=n.findParentByTagName(f.endContainer,["td","th"],!0),(s&&!l||!s&&l||s&&l&&s!==l)&&f.setCursor(!1,!0))),o=null,u.removeListener("mouseover",si);else if(y=n.findParentByTagName(r.target||r.srcElement,"td",!0),y||(y=n.findParentByTagName(r.target||r.srcElement,"th",!0)),y&&(y.tagName=="TD"||y.tagName=="TH")){if(u.fireEvent("excludetable",y)===!0)return;f=new e.Range(u.document),f.setStart(y,0).setCursor(!1,!0)}u._selectionChange(250,r)}}}function si(t,r){var u,e,f,s;ht()||(u=this,e=r.target||r.srcElement,y=n.findParentByTagName(e,"td",!0)||n.findParentByTagName(e,"th",!0),o&&y&&(o.tagName=="TD"&&y.tagName=="TD"||o.tagName=="TH"&&y.tagName=="TH")&&n.findParentByTagName(o,"table")==n.findParentByTagName(y,"table")&&(f=h(y),o!=y?(u.document.body.style.webkitUserSelect="none",u.selection.getNative()[i.ie?"empty":"removeAllRanges"](),s=f.getCellsRange(o,y),f.setSelected(s)):(u.document.body.style.webkitUserSelect="",f.clearSelected())),r.preventDefault?r.preventDefault():r.returnValue=!1)}function ur(t,i,r){var u=parseInt(n.getComputedStyle(t,"line-height"),10),f=r+i;i=f<u?u:f,t.style.height&&(t.style.height=""),t.rowSpan==1?t.setAttribute("height",i):t.removeAttribute&&t.removeAttribute("height")}function fr(n,i){var f=h(n),r,u,e;f&&(r=f.table,u=hi(n,r),r.style.width="",r.removeAttribute("width"),i=or(i,n,u),n.nextSibling?(e=0,t.each(u,function(n){n.left.width=+n.left.width+i,n.right&&(n.right.width=+n.right.width-i)})):t.each(u,function(n){n.left.width-=-i}))}function ht(){return r.body.contentEditable==="false"}function er(n,t){var r,i,u,f,e;if(!(Math.abs(t)<10)&&(r=h(n),r))for(i=r.getSameEndPosCells(n,"y"),u=i[0]?i[0].offsetHeight:0,f=0;e=i[f++];)ur(e,t,u)}function hi(i,r,u){var e;if(r||(r=n.findParentByTagName(i,"table")),!r)return null;for(var h=n.getNodeIndex(i),f=i,s=r.rows,o=0;f;)f.nodeType===1&&(o+=f.colSpan||1),f=f.previousSibling;return f=null,e=[],t.each(s,function(n){var r=n.cells,i=0;t.each(r,function(n){return(i+=n.colSpan||1,i===o)?(e.push({left:n,right:n.nextSibling||null}),!1):i>o?(u&&e.push({left:n}),!1):void 0})}),e}function or(n,i,r){if(n-=ct(),n<0)return 0;n-=dt(i);var u=n<0?"left":"right";return n=Math.abs(n),t.each(r,function(t){var i=t[u];i&&(n=Math.min(n,dt(i)-at))}),n=n<0?0:n,u==="left"?-n:n}function dt(n){var t=0,t=n.offsetWidth-ct();n.nextSibling||(t-=sr(n)),t=t<0?0:t;try{n.width=t}catch(i){}return t}function sr(t){if(tab=n.findParentByTagName(t,"table",!1),tab.offsetVal===undefined){var i=t.previousSibling;tab.offsetVal=i?t.offsetWidth-i.offsetWidth===s.borderWidth?s.borderWidth:0:0}return tab.offsetVal}function ct(){var e;if(s.tabcellSpace===undefined){var n=r.document.createElement("table"),u=r.document.createElement("tbody"),i=r.document.createElement("tr"),t=r.document.createElement("td"),f=null;t.style.cssText="border: 0;",t.width=1,i.appendChild(t),i.appendChild(f=t.cloneNode(!1)),u.appendChild(i),n.appendChild(u),n.style.cssText="visibility: hidden;",r.body.appendChild(n),s.paddingSpace=t.offsetWidth-1,e=n.offsetWidth,t.style.cssText="",f.style.cssText="",s.borderWidth=(n.offsetWidth-e)/3,s.tabcellSpace=s.paddingSpace+s.borderWidth,r.body.removeChild(n)}return ct=function(){return s.tabcellSpace},s.tabcellSpace}function ci(t){g||(v=t.document.createElement("div"),n.setAttributes(v,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"}),t.body.appendChild(v))}function nt(t){if(!g)for(var i;i=t.document.getElementById("ue_tableDragLine");)n.remove(i)}function li(t,i){if(i){var r=n.findParentByTagName(i,"table"),u=r.getElementsByTagName("caption"),s=r.offsetWidth,h=r.offsetHeight-(u.length>0?u[0].offsetHeight:0),e=n.getXY(r),o=n.getXY(i),f;switch(t){case"h":f="height:"+h+"px;top:"+(e.y+(u.length>0?u[0].offsetHeight:0))+"px;left:"+(o.x+i.offsetWidth),v.style.cssText=f+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":f="width:"+s+"px;left:"+e.x+"px;top:"+(o.y+i.offsetHeight),v.style.cssText=f+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"}}}function gt(t,i){for(var o=n.getElementsByTagName(t.body,"table"),f,r,u,e=0;r=o[e++];)u=n.getElementsByTagName(r,"td"),u[0]&&(i?(f=u[0].style.borderColor.replace(/\s/g,""),/(#ffffff)|(rgb\(255,f55,255\))/ig.test(f)&&n.addClass(r,"noBorderTable")):n.removeClasses(r,"noBorderTable"))}function hr(t,i,r){var u=t.body;return u.offsetWidth-(i?parseInt(n.getComputedStyle(u,"margin-left"),10)*2:0)-r.tableBorder*2-(t.options.offsetWidth||0)}function ai(t,i){var r=n.findParentByTagName(i.target||i.srcElement,["td","th"],!0),f=null,e,u,o;return r?(f=st(r,w(i)),!r)?null:(f==="h1"&&r.previousSibling?(u=n.getXY(r),e=r.offsetWidth,Math.abs(u.x+e-i.clientX)>e/3&&(r=r.previousSibling)):f==="v1"&&r.parentNode.previousSibling&&(u=n.getXY(r),o=r.offsetHeight,Math.abs(u.y+o-i.clientY)>o/3&&(r=r.parentNode.previousSibling.firstChild)),r&&!(t.fireEvent("excludetable",r)===!0)?r:null):null}var r=this,lt=null,rt=null,vi=null,at=5,tt=!1,k=5,ni=10,c=0,d=null,ti=360,s=UE.UETable,h=function(n){return s.getUETable(n)},l=function(n){return s.getUETableBySelected(n)},vt=function(n,t){return s.getDefaultValue(n,t)},ft=function(n){return s.removeSelectedClass(n)},ii,pi;r.ready(function(){var n=this,r=n.selection.getText;n.selection.getText=function(){var f=l(n),u;return f?(u="",t.each(f.selectedTds,function(n){u+=n[i.ie?"innerText":"textContent"]}),u):r.call(n.selection)}});var o=null,y=null,p="",pt=!1,f=null,et=!1,v=null,a=null,g=!1,wt=!0;r.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:r.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]}),r.getUETable=h,ii={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1},r.ready(function(){var u,c,a,y,o,v;t.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:2px solid #BBB;background:#F7F7F7;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",r.document),r.addListener("keydown",function(t,i){var r=this,w=i.keyCode||i.which,b,s,o,e,y,f,p,h,v;if(w==8&&(f=l(r),f&&f.selectedTds.length&&(f.isFullCol()?r.execCommand("deletecol"):f.isFullRow()?r.execCommand("deleterow"):r.fireEvent("delcells"),n.preventDefault(i)),o=n.findParentByTagName(r.selection.getStart(),"caption",!0),b=r.selection.getRange(),b.collapsed&&o&&ot(o)&&(r.fireEvent("saveScene"),e=o.parentNode,n.remove(o),e&&b.setStart(e.rows[0].cells[0],0).setCursor(!1,!0),r.fireEvent("saveScene"))),w==46&&(f=l(r),f)){for(r.fireEvent("saveScene"),h=0;v=f.selectedTds[h++];)n.fillNode(r.document,v);r.fireEvent("saveScene"),n.preventDefault(i)}if(w==13){if(s=r.selection.getRange(),o=n.findParentByTagName(s.startContainer,"caption",!0),o){e=n.findParentByTagName(o,"table"),s.collapsed?o&&s.setStart(e.rows[0].cells[0],0).setCursor(!1,!0):(s.deleteContents(),r.fireEvent("saveScene")),n.preventDefault(i);return}if(s.collapsed&&(e=n.findParentByTagName(s.startContainer,"table"),e)){var g=e.rows[0].cells[0],d=n.findParentByTagName(r.selection.getStart(),["td","th"],!0),k=e.previousSibling;g===d&&(!k||k.nodeType==1&&k.tagName=="TABLE")&&n.isStartInblock(s)&&(y=n.findParent(r.selection.getStart(),function(t){return n.isBlockElm(t)},!0),y&&(/t(h|d)/i.test(y.tagName)||y===d.firstChild)&&(r.execCommand("insertparagraphbeforetable"),n.preventDefault(i)))}}if((i.ctrlKey||i.metaKey)&&i.keyCode=="67"&&(u=null,f=l(r),f))for(p=f.selectedTds,c=f.isFullCol(),a=f.isFullRow(),u=[[f.cloneCell(p[0],null,!0)]],h=1;v=p[h];h++)v.parentNode!==p[h-1].parentNode?u.push([f.cloneCell(v,null,!0)]):u[u.length-1].push(f.cloneCell(v,null,!0))}),r.addListener("tablehasdeleted",function(){b(this,!1,"",null),f&&n.remove(f)}),r.addListener("beforepaste",function(r,f){var y=this,it=y.selection.getRange(),tt,v,rt,ht,w,ft,d,et,g,ut,b,p,nt,o,e,ct,lt,k,st;if(n.findParentByTagName(it.startContainer,"caption",!0)){k=y.document.createElement("div"),k.innerHTML=f.html,f.html=k[i.ie?"innerText":"textContent"];return}if(tt=l(y),u){if(y.fireEvent("saveScene"),it=y.selection.getRange(),v=n.findParentByTagName(it.startContainer,["td","th"],!0),v){if(w=h(v),a)for(ft=w.getCellInfo(v).rowIndex,v.tagName=="TH"&&ft++,b=0;p=u[b++];){for(nt=w.insertRow(ft++,"td"),o=0;e=p[o];o++)d=nt.cells[o],d||(d=nt.insertCell(o)),d.innerHTML=e.innerHTML,e.getAttribute("width")&&d.setAttribute("width",e.getAttribute("width")),e.getAttribute("vAlign")&&d.setAttribute("vAlign",e.getAttribute("vAlign")),e.getAttribute("align")&&d.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(d.style.cssText=e.style.cssText);for(o=0;e=nt.cells[o];o++){if(!p[o])break;e.innerHTML=p[o].innerHTML,p[o].getAttribute("width")&&e.setAttribute("width",p[o].getAttribute("width")),p[o].getAttribute("vAlign")&&e.setAttribute("vAlign",p[o].getAttribute("vAlign")),p[o].getAttribute("align")&&e.setAttribute("align",p[o].getAttribute("align")),p[o].style.cssText&&(e.style.cssText=p[o].style.cssText)}}else{if(c){for(ut=w.getCellInfo(v),et=0,o=0,p=u[0];e=p[o++];)et+=e.colSpan||1;for(y.__hasEnterExecCommand=!0,b=0;b<et;b++)y.execCommand("insertcol");y.__hasEnterExecCommand=!1,v=w.table.rows[0].cells[ut.cellIndex],v.tagName=="TH"&&(v=w.table.rows[1].cells[ut.cellIndex])}for(b=0;p=u[b++];){for(rt=v,o=0;e=p[o++];)v?(v.innerHTML=e.innerHTML,e.getAttribute("width")&&v.setAttribute("width",e.getAttribute("width")),e.getAttribute("vAlign")&&v.setAttribute("vAlign",e.getAttribute("vAlign")),e.getAttribute("align")&&v.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(v.style.cssText=e.style.cssText),ht=v,v=v.nextSibling):(g=e.cloneNode(!0),n.removeAttributes(g,["class","rowSpan","colSpan"]),ht.parentNode.appendChild(g));if(v=w.getNextCell(rt,!0,!0),!u[b])break;v||(ut=w.getCellInfo(rt),w.table.insertRow(w.table.rows.length),w.update(),v=w.getVSideCell(rt,!0))}}w.update()}else{for(tt=y.document.createElement("table"),b=0;p=u[b++];){for(nt=tt.insertRow(tt.rows.length),o=0;e=p[o++];)g=s.cloneCell(e,null,!0),n.removeAttributes(g,["class"]),nt.appendChild(g);o==2&&g.rowSpan>1&&(g.rowSpan=1)}ct=vt(y),lt=y.body.offsetWidth-(wt?parseInt(n.getComputedStyle(y.body,"margin-left"),10)*2:0)-ct.tableBorder*2-(y.options.offsetWidth||0),y.execCommand("insertHTML","<table  "+(c&&a?'width="'+lt+'"':"")+">"+tt.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"<\/table>")}return y.fireEvent("contentchange"),y.fireEvent("saveScene"),f.html="",!0}k=y.document.createElement("div"),k.innerHTML=f.html,st=k.getElementsByTagName("table"),n.findParentByTagName(y.selection.getStart(),"table")?(t.each(st,function(t){n.remove(t)}),n.findParentByTagName(y.selection.getStart(),"caption",!0)&&(k.innerHTML=k[i.ie?"innerText":"textContent"])):t.each(st,function(i){ri(i,!0),n.removeAttributes(i,["style","border"]),t.each(n.getElementsByTagName(i,"td"),function(t){ot(t)&&n.fillNode(y.document,t),ri(t,!0)})}),f.html=k.innerHTML}),r.addListener("afterpaste",function(){t.each(n.getElementsByTagName(r.body,"table"),function(t){if(t.offsetWidth>r.body.offsetWidth){var i=vt(r,t);t.style.width=r.body.offsetWidth-(wt?parseInt(n.getComputedStyle(r.body,"margin-left"),10)*2:0)-i.tableBorder*2-(r.options.offsetWidth||0)+"px"}})}),r.addListener("blur",function(){u=null}),r.addListener("keydown",function(){clearTimeout(y),y=setTimeout(function(){var u=r.selection.getRange(),t=n.findParentByTagName(u.startContainer,["th","td"],!0),i;t&&(i=t.parentNode.parentNode.parentNode,i.offsetWidth>i.getAttribute("width")&&(t.style.wordBreak="break-all"))},100)}),r.addListener("selectionchange",function(){b(r,!1,"",null)}),r.addListener("contentchange",function(){var r=this,f,u;(nt(r),l(r))||(f=r.selection.getRange(),u=f.startContainer,u=n.findParentByTagName(u,["td","th"],!0),t.each(n.getElementsByTagName(r.document,"table"),function(f){r.fireEvent("excludetable",f)!==!0&&(f.ueTable=new s(f),t.each(n.getElementsByTagName(r.document,"td"),function(t){n.isEmptyBlock(t)&&t!==u&&(n.fillNode(r.document,t),i.ie&&i.version==6&&(t.innerHTML="&nbsp;"))}),t.each(n.getElementsByTagName(r.document,"th"),function(t){n.isEmptyBlock(t)&&t!==u&&(n.fillNode(r.document,t),i.ie&&i.version==6&&(t.innerHTML="&nbsp;"))}),f.onmouseover=function(){r.fireEvent("tablemouseover",f)},f.onmousemove=function(){r.fireEvent("tablemousemove",f),r.options.tableDragable&&fi(!0,this,r)},f.onmouseout=function(){r.fireEvent("tablemouseout",f),b(r,!1,"",null),nt(r)},f.onclick=function(n){var i,e,o;if(n=r.window.event||n,i=bt(n.target||n.srcElement),i){var t=h(i),c=t.table,s=t.getCellInfo(i),u,f=r.selection.getRange();if(it(c,i,n,!0)){e=t.getCell(t.indexTable[t.rowsNum-1][s.colIndex].rowIndex,t.indexTable[t.rowsNum-1][s.colIndex].cellIndex),n.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==e?(u=t.getCellsRange(t.selectedTds[0],e),t.setSelected(u)):f&&f.selectNodeContents(e).select():i!==e?(u=t.getCellsRange(i,e),t.setSelected(u)):f&&f.selectNodeContents(e).select();return}it(c,i,n)&&(o=t.getCell(t.indexTable[s.rowIndex][t.colsNum-1].rowIndex,t.indexTable[s.rowIndex][t.colsNum-1].cellIndex),n.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==o?(u=t.getCellsRange(t.selectedTds[0],o),t.setSelected(u)):f&&f.selectNodeContents(o).select():i!==o?(u=t.getCellsRange(i,o),t.setSelected(u)):f&&f.selectNodeContents(o).select())}})}),gt(r,!0))});n.on(r.document,"mousemove",yi);n.on(r.document,"mouseout",function(n){var t=n.target||n.srcElement;t.tagName=="TABLE"&&b(r,!1,"",null)});r.addListener("interlacetable",function(n,t,i){var r;if(t){var f=this,u=t.rows,e=u.length,o=function(n,t,i){return n[t]?n[t]:i?n[t%n.length]:""};for(r=0;r<e;r++)u[r].className=o(i||f.options.classList,r,!0)}}),r.addListener("uninterlacetable",function(t,i){var r;if(i){var f=this,u=i.rows,e=f.options.classList,o=u.length;for(r=0;r<o;r++)n.removeClasses(u[r],e)}}),r.addListener("mousedown",di),r.addListener("mouseup",oi);n.on(r.body,"dragstart",function(n){oi.call(r,"dragstart",n)});o=0,r.addListener("mousedown",function(){o=0}),r.addListener("tabkeydown",function(){var i=this.selection.getRange(),e=i.getCommonAncestor(!0,!0),f=n.findParentByTagName(e,"table"),t,s,u;if(f)return n.findParentByTagName(e,"caption",!0)?(t=n.getElementsByTagName(f,"th td"),t&&t.length&&i.setStart(t[0],0).setCursor(!1,!0)):(t=n.findParentByTagName(e,["td","th"],!0),s=h(t),o=t.rowSpan>1?o:s.getCellInfo(t).rowIndex,u=s.getTabNextCell(t,o),u?ot(u)?i.setStart(u,0).setCursor(!1,!0):i.selectNodeContents(u).select():(r.fireEvent("saveScene"),r.__hasEnterExecCommand=!0,this.execCommand("insertrownext"),r.__hasEnterExecCommand=!1,i=this.selection.getRange(),i.setStart(f.rows[f.rows.length-1].cells[0],0).setCursor(),r.fireEvent("saveScene"))),!0}),i.ie&&r.addListener("selectionchange",function(){b(this,!1,"",null)}),r.addListener("keydown",function(t,i){var f=this,e=i.keyCode||i.which,r,u;e!=8&&e!=46&&(r=!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey,r&&ft(n.getElementsByTagName(f.body,"td")),u=l(f),u)&&r&&u.clearSelected()}),r.addListener("beforegetcontent",function(){gt(this,!1),i.ie&&t.each(this.document.getElementsByTagName("caption"),function(t){n.isEmptyNode(t)&&(t.innerHTML="&nbsp;")})}),r.addListener("aftergetcontent",function(){gt(this,!0)}),r.addListener("getAllHtml",function(){ft(r.document.getElementsByTagName("td"))}),r.addListener("fullscreenchanged",function(i,u){if(!u){var f=this.body.offsetWidth/document.body.offsetWidth,e=n.getElementsByTagName(this.body,"table");t.each(e,function(i){var e,o,u,s;if(i.offsetWidth<r.body.offsetWidth)return!1;for(e=n.getElementsByTagName(i,"td"),o=[],t.each(e,function(n){o.push(n.offsetWidth)}),u=0;s=e[u];u++)s.setAttribute("width",Math.floor(o[u]*f));i.setAttribute("width",Math.floor(hr(r,wt,vt(r))))})}}),v=r.execCommand,r.execCommand=function(t){var i=this,b=arguments,s,h,w,c,a,r;t=t.toLowerCase();var y=l(i),u,f=new e.Range(i.document),p=i.commands[t]||UE.commands[t],o;if(p){if(!y||ii[t]||p.notNeedUndo||i.__hasEnterExecCommand)o=v.apply(i,arguments);else{for(i.__hasEnterExecCommand=!0,i.fireEvent("beforeexeccommand",t),u=y.selectedTds,s=-2,h=-2,a=0;r=u[a];a++)ot(r)?f.setStart(r,0).setCursor(!1,!0):f.selectNode(r).select(!0),c=i.queryCommandState(t),w=i.queryCommandValue(t),c!=-1&&((s!==c||h!==w)&&(i._ignoreContentChange=!0,o=v.apply(i,arguments),i._ignoreContentChange=!1),s=i.queryCommandState(t),h=i.queryCommandValue(t),n.isEmptyBlock(r)&&n.fillNode(i.document,r));f.setStart(u[0],0).shrinkBoundary(!0).setCursor(!1,!0),i.fireEvent("contentchange"),i.fireEvent("afterexeccommand",t),i.__hasEnterExecCommand=!1,i._selectionChange()}return o}}})},UE.plugins.contextmenu=function(){var r=this,t=r.getLang("contextMenu"),u,f=r.options.contextMenu||[{label:t.selectall,cmdName:"selectall"},{label:t.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:t.cleardoc,cmdName:"cleardoc",exec:function(){confirm(t.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:t.unlink,cmdName:"unlink"},"-",{group:t.paragraph,icon:"justifyjustify",subMenu:[{label:t.justifyleft,cmdName:"justify",value:"left"},{label:t.justifyright,cmdName:"justify",value:"right"},{label:t.justifycenter,cmdName:"justify",value:"center"},{label:t.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:t.table,icon:"table",subMenu:[{label:t.inserttable,cmdName:"inserttable"},{label:t.deletetable,cmdName:"deletetable"},"-",{label:t.deleterow,cmdName:"deleterow"},{label:t.deletecol,cmdName:"deletecol"},{label:t.insertcol,cmdName:"insertcol"},{label:t.insertcolnext,cmdName:"insertcolnext"},{label:t.insertrow,cmdName:"insertrow"},{label:t.insertrownext,cmdName:"insertrownext"},"-",{label:t.insertcaption,cmdName:"insertcaption"},{label:t.deletecaption,cmdName:"deletecaption"},{label:t.inserttitle,cmdName:"inserttitle"},{label:t.deletetitle,cmdName:"deletetitle"},"-",{label:t.mergecells,cmdName:"mergecells"},{label:t.mergeright,cmdName:"mergeright"},{label:t.mergedown,cmdName:"mergedown"},"-",{label:t.splittorows,cmdName:"splittorows"},{label:t.splittocols,cmdName:"splittocols"},{label:t.splittocells,cmdName:"splittocells"},"-",{label:t.averageDiseRow,cmdName:"averagedistributerow"},{label:t.averageDisCol,cmdName:"averagedistributecol"},"-",{label:t.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this),this.getDialog("edittd").open()}},{label:t.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this),this.getDialog("edittable").open()}}]},{group:t.tablesort,icon:"tablesort",subMenu:[{label:t.reversecurrent,cmdName:"sorttable",value:1},{label:t.orderbyasc,cmdName:"sorttable"},{label:t.reversebyasc,cmdName:"sorttable",exec:function(){this.execCommand("sorttable",function(n,t){var i=n.innerHTML,r=t.innerHTML;return r.localeCompare(i)})}},{label:t.orderbynum,cmdName:"sorttable",exec:function(){this.execCommand("sorttable",function(n,t){var r=n[i.ie?"innerText":"textContent"].match(/\d+/),u=t[i.ie?"innerText":"textContent"].match(/\d+/);return r&&(r=+r[0]),u&&(u=+u[0]),(r||0)-(u||0)})}},{label:t.reversebynum,cmdName:"sorttable",exec:function(){this.execCommand("sorttable",function(n,t){var r=n[i.ie?"innerText":"textContent"].match(/\d+/),u=t[i.ie?"innerText":"textContent"].match(/\d+/);return r&&(r=+r[0]),u&&(u=+u[0]),(u||0)-(r||0)})}}]},{group:t.borderbk,icon:"borderBack",subMenu:[{label:t.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:t.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:t.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:t.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:t.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:t.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:t.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:t.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:t.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:t.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:t.tableright,value:"right"}]},"-",{label:t.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:t.insertparagraphafter,cmdName:"insertparagraph"},{label:t.copy,cmdName:"copy",exec:function(){alert(t.copymsg)},query:function(){return 0}},{label:t.paste,cmdName:"paste",exec:function(){alert(t.pastemsg)},query:function(){return 0}},{label:t.highlightcode,cmdName:"highlightcode",exec:function(){UE.ui.highlightcode&&new UE.ui.highlightcode(this),this.ui._dialogs.highlightcodeDialog.open()}}],o;f.length&&(o=UE.ui.uiUtils,r.addListener("contextmenu",function(s,h){var w=o.getViewportOffsetByEvent(h),a,y,c,l,v,p;for(r.fireEvent("beforeselectionchange"),u&&u.destroy(),a=0,c=[];y=f[a];a++)(function(n){if(n=="-")(l=c[c.length-1])&&l!=="-"&&c.push("-");else if(n.hasOwnProperty("group")){for(var u=0,f,i=[];f=n.subMenu[u];u++)(function(n){n=="-"?(l=i[i.length-1])&&l!=="-"?i.push("-"):i.splice(i.length-1):(r.commands[n.cmdName]||UE.commands[n.cmdName]||n.query)&&(n.query?n.query():r.queryCommandState(n.cmdName))>-1&&i.push({label:n.label||r.getLang("contextMenu."+n.cmdName+(n.value||""))||"",className:"edui-for-"+n.cmdName+(n.className?" edui-for-"+n.cmdName+"-"+n.className:""),onclick:n.exec?function(){n.exec.call(r)}:function(){r.execCommand(n.cmdName,n.value)}})})(f);if(i.length){function e(){switch(n.icon){case"table":return r.getLang("contextMenu.table");case"justifyjustify":return r.getLang("contextMenu.paragraph");case"aligntd":return r.getLang("contextMenu.aligntd");case"aligntable":return r.getLang("contextMenu.aligntable");case"tablesort":return t.tablesort;case"borderBack":return t.borderbk;default:return""}}c.push({label:e(),className:"edui-for-"+n.icon,subMenu:{items:i,editor:r}})}}else if((r.commands[n.cmdName]||UE.commands[n.cmdName]||n.query)&&(n.query?n.query.call(r):r.queryCommandState(n.cmdName))>-1){if(n.cmdName=="highlightcode"){if(r.queryCommandState(n.cmdName)==1&&n.icon!="deletehighlightcode")return;if(r.queryCommandState(n.cmdName)!=1&&n.icon=="deletehighlightcode")return}c.push({label:n.label||r.getLang("contextMenu."+n.cmdName),className:"edui-for-"+(n.icon?n.icon:n.cmdName+(n.value||"")),onclick:n.exec?function(){n.exec.call(r)}:function(){r.execCommand(n.cmdName,n.value)}})}})(y);if(c[c.length-1]=="-"&&c.pop(),u=new UE.ui.Menu({items:c,className:"edui-contextmenu",editor:r}),u.render(),u.showAt(w),r.fireEvent("aftershowcontextmenu",u),n.preventDefault(h),i.ie){try{v=r.selection.getNative().createRange()}catch(b){return}v.item&&(p=new e.Range(r.document),p.selectNode(v.item(0)).select(!0,!0))}}))},UE.plugins.shortcutmenu=function(){var u=this,t,f=u.options.shortcutMenu||[];f.length&&(u.addListener("contextmenu mouseup",function(u,o){var s=this,l={type:u,target:o.target||o.srcElement,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY},h,c;if(setTimeout(function(){var n=s.selection.getRange();(n.collapsed===!1||u=="contextmenu")&&(t||(t=new r.editor.ui.ShortCutMenu({editor:s,items:f,theme:s.options.theme,className:"edui-shortcutmenu"}),t.render(),s.fireEvent("afterrendershortcutmenu",t)),t.show(l,!!UE.plugins.contextmenu))}),u=="contextmenu"&&(n.preventDefault(o),i.ie)){try{h=s.selection.getNative().createRange()}catch(o){return}h.item&&(c=new e.Range(s.document),c.selectNode(h.item(0)).select(!0,!0))}u=="keydown"&&t&&!t.isHidden&&t.hide()}),u.addListener("keydown",function(n){n=="keydown"&&t&&!t.isHidden&&t.hide()}))},UE.plugins.basestyle=function(){var u={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},f=function(t,i){return n.filterNodeList(t.selection.getStartElementPath(),i)},i=this,r;i.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),i.addInputRule(function(n){t.each(n.getNodesByTagName("b i"),function(n){switch(n.tagName){case"b":n.tagName="strong";break;case"i":n.tagName="em"}})});for(r in u)(function(t,r){i.commands[t]={execCommand:function(t){var u=i.selection.getRange(),o=f(this,r),e,s;u.collapsed?(o?(e=i.document.createTextNode(""),u.insertNode(e).removeInlineStyle(r),u.setStartBefore(e),n.remove(e)):(s=u.document.createElement(r[0]),(t=="superscript"||t=="subscript")&&(e=i.document.createTextNode(""),u.insertNode(e).removeInlineStyle(["sub","sup"]).setStartBefore(e).collapse(!0)),u.insertNode(s).setStart(s,0)),u.collapse(!0)):((t=="superscript"||t=="subscript")&&(o&&o.tagName.toLowerCase()==t||u.removeInlineStyle(["sub","sup"])),o?u.removeInlineStyle(r):u.applyInlineStyle(r[0])),u.select()},queryCommandState:function(){return f(this,r)?1:0}}})(r,u[r])},UE.plugins.elementpath=function(){var t,i,n=this;(n.setOpt("elementPathEnabled",!0),n.options.elementPathEnabled)&&(n.commands.elementpath={execCommand:function(r,u){var f=i[u],e=n.selection.getRange();t=u*1,e.selectNode(f).select()},queryCommandValue:function(){var f=[].concat(this.selection.getStartElementPath()).reverse(),e=[],n,r,u;for(i=f,n=0;r=f[n];n++)if(r.nodeType!=3&&(u=r.tagName.toLowerCase(),u=="img"&&r.getAttribute("anchorname")&&(u="anchor"),e[n]=u,t==n)){t=-1;break}return e}})},UE.plugins.formatmatch=function(){function e(o,s){function p(n){return c&&n.selectNode(c),n.applyInlineStyle(r[r.length-1].tagName,null,r)}var a,h,l,v,c,y;i.webkit&&(a=s.target.tagName=="IMG"?s.target:null),t.undoManger&&t.undoManger.save(),h=t.selection.getRange(),l=a||h.getClosedNode(),u&&l&&l.tagName=="IMG"?(l.style.cssText+=";float:"+(u.style.cssFloat||u.style.styleFloat||"none")+";display:"+(u.style.display||"inline"),u=null):u||(v=h.collapsed,v&&(c=t.document.createTextNode("match"),h.insertNode(c).select()),t.__hasEnterExecCommand=!0,y=t.options.removeFormatAttributes,t.options.removeFormatAttributes="",t.execCommand("removeformat"),t.options.removeFormatAttributes=y,t.__hasEnterExecCommand=!1,h=t.selection.getRange(),r.length&&p(h),c&&h.setStartBefore(c).collapse(!0),h.select(),c&&n.remove(c)),t.undoManger&&t.undoManger.save(),t.removeListener("mouseup",e),f=0}var t=this,r=[],u,f=0;t.addListener("reset",function(){r=[],f=0}),t.commands.formatmatch={execCommand:function(){var i,s,o,h;if(f){f=0,r=[],t.removeListener("mouseup",e);return}if(i=t.selection.getRange(),u=i.getClosedNode(),!u||u.tagName!="IMG")for(i.collapse(!0).shrinkBoundary(),s=i.startContainer,r=n.findParents(s,!0,function(t){return!n.isBlockElm(t)&&t.nodeType==1}),o=0;h=r[o];o++)if(h.tagName=="A"){r.splice(o,1);break}t.addListener("mouseup",e),f=1},queryCommandState:function(){return f},notNeedUndo:1}},UE.plugins.searchreplace=function(){var n,r,u=this;u.addListener("reset",function(){n=null,r=null}),u.commands.searchreplace={execCommand:function(u,f){var s=this,p=s.selection,l,e,a=0,f=t.extend(f,{all:!1,casesensitive:!1,dir:1},!0),y=f.searchStr,v,h,o,k;if(i.ie)for(s.focus();;){if(e=s.document.selection.createRange(),o=e.duplicate(),o.moveToElementText(s.document.body),f.all?(r=0,f.dir=1,n?o.setEndPoint(f.dir==-1?"EndToStart":"StartToEnd",n):o.moveToElementText(s.document.body)):(o.setEndPoint(f.dir==-1?"EndToStart":"StartToEnd",e),f.hasOwnProperty("replaceStr")&&o.setEndPoint(f.dir==-1?"StartToEnd":"EndToStart",e)),e=o.duplicate(),/^\/[^/]+\/\w*$/.test(f.searchStr)){var w=o.text,b=new RegExp(f.searchStr.replace(/^\/|\/\w*$/g,""),"g"+(f.casesensitive?"":"i")),c=w.match(b);if(c&&c.length)y=f.dir<0?c[c.length-1]:c[0];else return n=null,a}if(!o.findText(y,f.dir,f.casesensitive?4:0))return n=null,o=s.document.selection.createRange(),o.scrollIntoView(),n=null,a;if(o.select(),f.hasOwnProperty("replaceStr")&&(l=p.getRange(),l.deleteContents().insertNode(l.document.createTextNode(f.replaceStr)).select(),n=p.getNative().createRange()),a++,!f.all)break}else for(v=s.window,h=p.getNative();;){if(f.all?(n?(n.collapse(!1),e=n):(e=s.document.createRange(),e.setStart(s.document.body,0),e.collapse(!0)),h.removeAllRanges(),h.addRange(e),r=0,f.dir=1):(i.safari&&s.selection.getRange().select(),h=v.getSelection(),e=h.rangeCount?h.getRangeAt(0):n||s._bakNativeRange,f.hasOwnProperty("replaceStr")&&e.collapse(f.dir==1?!0:!1)),r?h.removeAllRanges():(e.collapse(f.dir<0?!0:!1),h.removeAllRanges(),h.addRange(e)),/^\/[^/]+\/\w*$/.test(f.searchStr)){o=e.cloneRange(),f.dir<0?(e.collapse(!0),e.setStart(s.body,0)):e.setEnd(s.body,s.body.childNodes.length);var w=e+"",b=new RegExp(f.searchStr.replace(/^\/|\/\w*$/g,""),"g"+(f.casesensitive?"":"i")),c=w.match(b);if(c&&c.length)y=f.dir<0?c[c.length-1]:c[0];else return n=null,a;h.removeAllRanges(),e=o,h.addRange(e)}if(!v.find(y,f.casesensitive,f.dir<0?!0:!1))return n=null,h.removeAllRanges(),a;if(r=0,l=v.getSelection().getRangeAt(0),l.collapsed||(f.hasOwnProperty("replaceStr")&&(l.deleteContents(),k=v.document.createTextNode(f.replaceStr),l.insertNode(k),l.selectNode(k),h.addRange(l)),n=l.cloneRange()),a++,!f.all)break}return!0}}},UE.plugins.customstyle=function(){var t=this;t.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),t.commands.customstyle={execCommand:function(t,i){var e=this,h=i.tag,r=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")},!0),f,o,l={},v,a,p,k,s,w,b,c,y;for(v in i)i[v]!==undefined&&(l[v]=i[v]);if(delete l.tag,r&&r.getAttribute("label")==i.label){if(f=this.selection.getRange(),o=f.createBookmark(),f.collapsed)u.$block[r.tagName]?(c=e.document.createElement("p"),n.moveChild(r,c),r.parentNode.insertBefore(c,r),n.remove(r)):n.remove(r,!0);else{for(a=n.getCommonAncestor(o.start,o.end),p=n.getElementsByTagName(a,h),new RegExp(h,"i").test(a.tagName)&&p.push(a),k=0;s=p[k++];)s.getAttribute("label")==i.label&&(w=n.getPosition(s,o.start),b=n.getPosition(s,o.end),(w&n.POSITION_FOLLOWING||w&n.POSITION_CONTAINS)&&(b&n.POSITION_PRECEDING||b&n.POSITION_CONTAINS)&&u.$block[h]&&(c=e.document.createElement("p"),n.moveChild(s,c),s.parentNode.insertBefore(c,s)),n.remove(s,!0));r=n.findParent(a,function(n){return n.getAttribute("label")==i.label},!0),r&&n.remove(r,!0)}f.moveToBookmark(o).select()}else if(u.$block[h])this.execCommand("paragraph",h,l,"customstyle"),f=e.selection.getRange(),f.collapsed||(f.collapse(),r=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")==i.label},!0),y=e.document.createElement("p"),n.insertAfter(r,y),n.fillNode(e.document,y),f.setStart(y,0).setCursor());else{if(f=e.selection.getRange(),f.collapsed){r=e.document.createElement(h),n.setAttributes(r,l),f.insertNode(r).setStart(r,0).setCursor();return}o=f.createBookmark(),f.applyInlineStyle(h,l).moveToBookmark(o).select()}},queryCommandValue:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),function(n){return n.getAttribute("label")});return t?t.getAttribute("label"):""}},t.addListener("keyup",function(i,r){var s=r.keyCode||r.which,o,f,e;(s==32||s==13)&&(o=t.selection.getRange(),o.collapsed&&(f=n.findParent(t.selection.getStart(),function(n){return n.getAttribute("label")},!0),f&&u.$block[f.tagName]&&n.isEmptyNode(f)&&(e=t.document.createElement("p"),n.insertAfter(f,e),n.fillNode(t.document,e),n.remove(f),o.setStart(e,0).setCursor())))})},UE.plugins.catchremoteimage=function(){function e(n,u){var o=n.join(i),e={timeout:6e4,onsuccess:u.success,onerror:u.error};e[t.options.catchFieldName]=o,r.request(f,e)}var t;if(this.options.catchRemoteImageEnable!==!1){t=this,this.setOpt({localDomain:["127.0.0.1","localhost","img.baidu.com"],separater:"ue_separate_ue",catchFieldName:"upfile",catchRemoteImageEnable:!0});var r=UE.ajax,u=t.options.localDomain,f=t.options.catcherUrl,i=t.options.separater;t.addListener("afterpaste",function(){t.fireEvent("catchRemoteImage")}),t.addListener("catchRemoteImage",function(){for(var o=[],s=n.getElementsByTagName(t.document,"img"),c=function(n,t){for(var r=0,i;i=t[r++];)if(n.indexOf(i)!==-1)return!0;return!1},r,f,h=0;r=s[h++];)r.getAttribute("word_img")||(f=r.getAttribute("_src")||r.src||"",/^(https?|ftp):/i.test(f)&&!c(f,u)&&o.push(f));o.length&&e(o,{success:function(xhr){var info,srcUrls,urls,i,ci,src,j,cj,url,newSrc;try{info=eval("("+xhr.responseText+")")}catch(e){return}for(srcUrls=info.srcUrl.split(i),urls=info.url.split(i),i=0;ci=s[i++];)for(src=ci.getAttribute("_src")||ci.src||"",j=0;cj=srcUrls[j++];)if(url=urls[j-1],src==cj&&url!="error"){newSrc=t.options.catcherPath+url,n.setAttributes(ci,{src:newSrc,_src:newSrc});break}t.fireEvent("catchremotesuccess")},error:function(){t.fireEvent("catchremoteerror")}})})}},UE.plugins.snapscreen=function(){var t=this,i,n;t.setOpt({snapscreenServerPort:location.port,snapscreenImgAlign:"",snapscreenHost:location.hostname}),t.commands.snapscreen={execCommand:function(){var r=this,e=r.getLang("snapScreen_plugin"),u,f,o;if(!n){u=r.container,i=u.ownerDocument||u.document,n=i.createElement("object");try{n.type="application/x-pluginbaidusnap"}catch(h){return}n.style.cssText="position:absolute;left:-9999px;",n.setAttribute("width","0"),n.setAttribute("height","0"),u.appendChild(n)}var t=r.options,s=function(rs){try{rs=eval("("+rs+")")}catch(e){alert(e.callBackErrorMsg);return}if(rs.state!="SUCCESS"){alert(rs.state);return}r.execCommand("insertimage",{src:t.snapscreenPath+rs.url,floatStyle:t.snapscreenImgAlign,_src:t.snapscreenPath+rs.url})},c=function(){},l=function(){alert(e.uploadErrorMsg)};try{f=t.snapscreenServerPort+"",t.snapscreenServerUrl=t.snapscreenServerUrl.split(t.snapscreenHost),t.snapscreenServerUrl=t.snapscreenServerUrl[1]||t.snapscreenServerUrl[0],t.snapscreenServerUrl.indexOf(":"+f)===0&&(t.snapscreenServerUrl=t.snapscreenServerUrl.substring(f.length+1)),o=n.saveSnapshot(t.snapscreenHost,t.snapscreenServerUrl,f),s(o)}catch(h){r.ui._dialogs.snapscreenDialog.open()}}}},UE.commands.insertparagraph={execCommand:function(t,i){for(var e=this,o=e.selection.getRange(),u=o.startContainer,r,f;u;){if(n.isBody(u))break;r=u,u=u.parentNode}r&&(f=e.document.createElement("p"),i?r.parentNode.insertBefore(f,r):r.parentNode.insertBefore(f,r.nextSibling),n.fillNode(e.document,f),o.setStart(f,0).setCursor(!1,!0))}},UE.plugins.webapp=function(){function r(n,i,r){return i?'<iframe class="edui-faked-webapp" title="'+n.title+'" width="'+n.width+'" height="'+n.height+'"  scrolling="no" frameborder="0" src="'+n.url+'" logo_url = '+n.logo+"><\/iframe>":(r?"<p>":"")+'<img title="'+n.title+'" width="'+n.width+'" height="'+n.height+'" src="'+t.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+n.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+n.url+'" />'+(r?"<\/p>":"")}function i(i){for(var f,o=n.getElementsByTagName(t.document,i?"img":"iframe"),u,e=0;u=o[e++];)u.className=="edui-faked-webapp"&&(f=t.document.createElement("div"),f.innerHTML=r(i?{url:u.getAttribute("_url"),width:u.width,height:u.height,title:u.title,logo:u.style.backgroundImage.replace("url(","").replace(")","")}:{url:u.getAttribute("src",2),title:u.title,width:u.width,height:u.height,logo:u.getAttribute("logo_url")},i?!0:!1,!1),u.parentNode.replaceChild(f.firstChild,u))}var t=this;t.addListener("beforegetcontent",function(){i(!0)}),t.addListener("aftersetcontent",function(){i(!1)}),t.addListener("aftergetcontent",function(n){n=="aftergetcontent"&&t.queryCommandState("source")||i(!1)}),t.commands.webapp={execCommand:function(n,i){t.execCommand("inserthtml",r(i,!1,!0))}}},UE.plugins.template=function(){UE.commands.template={execCommand:function(n,t){t.html&&this.execCommand("inserthtml",t.html)}},this.addListener("click",function(t,i){var u=i.target||i.srcElement,f=this.selection.getRange(),r=n.findParent(u,function(t){if(t.className&&n.hasClass(t,"ue_t"))return t},!0);r&&f.selectNode(r).shrinkBoundary().select()}),this.addListener("keydown",function(t,i){var u=this.selection.getRange(),r;u.collapsed||i.ctrlKey||i.metaKey||i.shiftKey||i.altKey||(r=n.findParent(u.startContainer,function(t){if(t.className&&n.hasClass(t,"ue_t"))return t},!0),r&&n.removeClasses(r,["ue_t"]))})},UE.plugins.music=function(){function r(n,i,r,u,f,e){return f?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+n+'" width="'+i+'" height="'+r+'" align="'+u+'"'+(u!="none"?' style= "'+(u=="center"?"display:block;":" float: "+u)+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':(e?"<p "+(u!="none"?u=="center"?' style="text-align:center;" ':' style="float:"'+u:"")+">":"")+'<img align="'+u+'" width="'+i+'" height="'+r+'" _url="'+n+'" class="edui-faked-music" src="'+t.options.langPath+t.options.lang+'/images/music.png" />'+(e?"<\/p>":"")}function i(i){for(var e,s=n.getElementsByTagName(t.document,i?"img":"embed"),u,f,o=0;u=s[o++];)u.className=="edui-faked-music"&&(e=t.document.createElement("div"),f=n.getComputedStyle(u,"float"),f=f=="none"?u.getAttribute("align")||"":f,e.innerHTML=r(i?u.getAttribute("_url"):u.getAttribute("src"),u.width,u.height,f,i),u.parentNode.replaceChild(e.firstChild,u))}var t=this;t.addListener("beforegetcontent",function(){i(!0)}),t.addListener("aftersetcontent",function(){i(!1)}),t.addListener("aftergetcontent",function(n){n=="aftergetcontent"&&t.queryCommandState("source")||i(!1)}),t.commands.music={execCommand:function(n,t){var i=this,u=r(t.url,t.width||400,t.height||95,"none",!1,!0);i.execCommand("inserthtml",u)},queryCommandState:function(){var t=this,n=t.selection.getRange().getClosedNode(),i=n&&n.className=="edui-faked-music";return i?1:0}}},r=r||{},r.editor=r.editor||{},r.editor.ui={},function(){function f(){var n=document.getElementById("edui_fixedlayer");t.setViewportOffset(n,{left:0,top:0})}function h(){i.on(window,"scroll",f);i.on(window,"resize",r.editor.utils.defer(f,0,!0))}var n=r.editor.browser,i=r.editor.dom.domUtils,u="$EDITORUI",e=window[u]={},o="ID"+u,s=0,t=r.editor.ui.uiUtils={uid:function(n){return n?n[o]||(n[o]=++s):++s},hook:function(n,t){var i;return n&&n._callbacks?i=n:(i=function(){var t,r,u,f;for(n&&(t=n.apply(this,arguments)),r=i._callbacks,u=r.length;u--;)f=r[u].apply(this,arguments),t===undefined&&(t=f);return t},i._callbacks=[]),i._callbacks.push(t),i},createElementByHtml:function(n){var t=document.createElement("div");return t.innerHTML=n,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(n){var t,r,u;try{t=n.getBoundingClientRect()}catch(f){t={left:0,top:0,height:0,width:0}}for(r={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(u=n.ownerDocument)!==document&&(n=i.getWindow(u).frameElement);)t=n.getBoundingClientRect(),r.left+=t.left,r.top+=t.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},getViewportRect:function(){var n=t.getViewportElement(),i=(window.innerWidth||n.clientWidth)|0,r=(window.innerHeight||n.clientHeight)|0;return{left:0,top:0,height:r,width:i,bottom:r,right:i}},setViewportOffset:function(n,r){var u=t.getFixedLayer();n.parentNode===u?(n.style.left=r.left+"px",n.style.top=r.top+"px"):i.setViewportOffset(n,r)},getEventOffset:function(n){var u=n.target||n.srcElement,i=t.getClientRect(u),r=t.getViewportOffsetByEvent(n);return{left:r.left-i.left,top:r.top-i.top}},getViewportOffsetByEvent:function(n){var f=n.target||n.srcElement,e=i.getWindow(f).frameElement,r={left:n.clientX,top:n.clientY},u;return e&&f.ownerDocument!==document&&(u=t.getClientRect(e),r.left+=u.left,r.top+=u.top),r},setGlobal:function(n,t){return e[n]=t,u+'["'+n+'"]'},unsetGlobal:function(n){delete e[n]},copyAttributes:function(t,r){for(var f=r.attributes,e=f.length,u;e--;)u=f[e],u.nodeName!="style"&&u.nodeName!="class"&&(!n.ie||u.specified)&&t.setAttribute(u.nodeName,u.nodeValue);r.className&&i.addClass(t,r.className),r.style.cssText&&(t.style.cssText+=";"+r.style.cssText)},removeStyle:function(n,t){if(n.style.removeProperty)n.style.removeProperty(t);else if(n.style.removeAttribute)n.style.removeAttribute(t);else throw"";},contains:function(n,t){return n&&t&&(n===t?!1:n.contains?n.contains(t):n.compareDocumentPosition(t)&16)},startDrag:function(n,t,i){function u(n){var i=n.clientX-o,r=n.clientY-s;t.ondragmove(i,r,n);n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}var i=i||document,o=n.clientX,s=n.clientY,r;if(i.addEventListener){function f(){i.removeEventListener("mousemove",u,!0),i.removeEventListener("mouseup",f,!0),window.removeEventListener("mouseup",f,!0),t.ondragstop()}i.addEventListener("mousemove",u,!0),i.addEventListener("mouseup",f,!0),window.addEventListener("mouseup",f,!0),n.preventDefault()}else{r=n.srcElement,r.setCapture();function e(){r.releaseCapture(),r.detachEvent("onmousemove",u),r.detachEvent("onmouseup",e),r.detachEvent("onlosecaptrue",e),t.ondragstop()}r.attachEvent("onmousemove",u),r.attachEvent("onmouseup",e),r.attachEvent("onlosecaptrue",e),n.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var t=document.getElementById("edui_fixedlayer");return t==null&&(t=document.createElement("div"),t.id="edui_fixedlayer",document.body.appendChild(t),n.ie&&n.version<=8?(t.style.position="absolute",h(),setTimeout(f)):t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.width="0",t.style.height="0"),t},makeUnselectable:function(i){if(n.opera||n.ie&&n.version<9){if(i.unselectable="on",i.hasChildNodes())for(var r=0;r<i.childNodes.length;r++)i.childNodes[r].nodeType==1&&t.makeUnselectable(i.childNodes[r])}else i.style.MozUserSelect!==undefined?i.style.MozUserSelect="none":i.style.WebkitUserSelect!==undefined?i.style.WebkitUserSelect="none":i.style.KhtmlUserSelect!==undefined&&(i.style.KhtmlUserSelect="none")}}}(),function(){var i=r.editor.utils,t=r.editor.ui.uiUtils,f=r.editor.EventBase,u=r.editor.ui.UIBase=function(){};u.prototype={className:"",uiName:"",initOptions:function(n){var r=this,i;for(i in n)r[i]=n[i];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=i.unhtml(t.setGlobal(this.id,this))},render:function(i){for(var h=this.renderHtml(),r=t.createElementByHtml(h),c=n.getElementsByTagName(r,"*"),f="edui-"+(this.theme||this.editor.options.theme),e=document.getElementById("edui_fixedlayer"),s,u,o=0;s=c[o++];)n.addClass(s,f);n.addClass(r,f),e&&(e.className="",n.addClass(e,f)),u=this.getDom(),u!=null?(u.parentNode.replaceChild(r,u),t.copyAttributes(r,u)):(typeof i=="string"&&(i=document.getElementById(i)),i=i||t.getFixedLayer(),n.addClass(i,f),i.appendChild(r)),this.postRender()},getDom:function(n){return n?document.getElementById(this.id+"_"+n):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(n){var t="edui-"+this.uiName;return n.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var n=this.getDom();n&&r.editor.dom.domUtils.remove(n),t.unsetGlobal(this.id)}},i.inherits(u,f)}(),function(){var t=r.editor.utils,i=r.editor.ui.UIBase,n=r.editor.ui.Separator=function(n){this.initOptions(n),this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><\/div>'}},t.inherits(n,i)}(),function(){var t=r.editor.utils,i=r.editor.dom.domUtils,u=r.editor.ui.UIBase,f=r.editor.ui.uiUtils,n=r.editor.ui.Mask=function(n){this.initOptions(n),this.initUIBase()};n.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"><\/div>'},postRender:function(){var n=this;i.on(window,"resize",function(){setTimeout(function(){n.isHidden()||n._fill()})})},show:function(n){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=n},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_fill:function(){var n=this.getDom(),t=f.getViewportRect();n.style.width=t.width+"px",n.style.height=t.height+"px"}},t.inherits(n,u)}(),function(){function e(n,t){for(var r,u=0;u<i.length;u++)if(r=i[u],!r.isHidden()&&r.queryAutoHide(t)!==!1){if(n&&/scroll/ig.test(n.type)&&r.className=="edui-wordpastepop")return;r.hide()}i.length&&r.editor.fireEvent("afterhidepop")}var s=r.editor.utils,t=r.editor.ui.uiUtils,n=r.editor.dom.domUtils,u=r.editor.ui.UIBase,f=r.editor.ui.Popup=function(n){this.initOptions(n),this.initPopup()},i=[],o;f.postHide=e,o=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"],f.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),i.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"><\/iframe> <div class="edui-shadow"><\/div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  <\/div> <\/div><\/div>"},getContentHtmlTpl:function(){return this.content?typeof this.content=="string"?this.content:this.content.renderHtml():""},_UIBase_postRender:u.prototype.postRender,postRender:function(){if(this.content instanceof u&&this.content.postRender(),this.captureWheel&&!this.captured){this.captured=!0;for(var r=(document.documentElement.clientHeight||document.body.clientHeight)-80,i=this.getDom().offsetHeight,f=n.getXY(this.combox.getDom()).y,t=this.getDom("content"),e=this;f+i>r;)i-=30,t.style.height=i+"px";if(window.XMLHttpRequest)n.on(t,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(n){n.preventDefault?n.preventDefault():n.returnValue=!1,t.scrollTop-=n.wheelDelta?n.wheelDelta/2:n.detail*-20});else n.on(this.getDom(),"mousewheel",function(n){n.returnValue=!1,e.getDom("content").scrollTop-=n.wheelDelta/2})}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var n=this.getDom("content");return t.getClientRect(n)},fitSize:function(){var t,n;return this.captureWheel&&this.sized?this.__size:(this.sized=!0,t=this.getDom("body"),t.style.width="",t.style.height="",n=this.mesureSize(),t.style.width=this.captureWheel?-(-20-n.width)+"px":n.width+"px",t.style.height=n.height+"px",this.__size=n,this.captureWheel&&(this.getDom("content").style.overflow="auto"),n)},showAnchor:function(n,i){this.showAnchorRect(t.getClientRect(n),i)},showAnchorRect:function(i,u){var s,f,h,c,l,a,e;this._doAutoRender(),s=t.getViewportRect(),this._show(),f=this.fitSize(),u?(h=this.canSideLeft&&i.right+f.width>s.right&&i.left>f.width,c=this.canSideUp&&i.top+f.height>s.bottom&&i.bottom>f.height,l=h?i.left-f.width:i.right,a=c?i.bottom-f.height:i.top):(h=this.canSideLeft&&i.right+f.width>s.right&&i.left>f.width,c=this.canSideUp&&i.top+f.height>s.bottom&&i.bottom>f.height,l=h?i.right-f.width:i.left,a=c?i.top-f.height:i.bottom),e=this.getDom(),t.setViewportOffset(e,{left:l,top:a}),n.removeClasses(e,o),e.className+=" "+o[(c?1:0)*2+(h?1:0)],this.editor&&(e.style.zIndex=this.editor.container.style.zIndex*1+10,r.editor.ui.uiUtils.getFixedLayer().style.zIndex=e.style.zIndex-1)},showAt:function(n){var t=n.left,i=n.top,r={left:t,top:i,right:t,bottom:i,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var n=this.getDom();n.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(n){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,n||this.fireEvent("hide"))},queryAutoHide:function(n){return!n||!t.contains(this.getDom(),n)}},s.inherits(f,u);n.on(document,"mousedown",function(n){var t=n.target||n.srcElement;e(n,t)});n.on(window,"scroll",function(n,t){e(n,t)})}(),function(){function f(t,i){for(var u='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"><\/div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+t+'<\/div><\/div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+i.getLang("themeColor")+'<\/td> <\/tr><tr class="edui-colorpicker-tablefirstrow" >',r=0;r<n.length;r++)r&&r%10==0&&(u+="<\/tr>"+(r==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+i.getLang("standardColor")+"<\/td><\/tr>":"")+"<tr"+(r==60?' class="edui-colorpicker-tablefirstrow"':"")+">"),u+=r<70?'<td style="padding: 0 2px;"><a hidefocus title="'+n[r]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+n[r]+'" style="background-color:#'+n[r]+";border:solid #ccc;"+(r<10||r>=60?"border-width:1px;":r>=10&&r<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"><\/a><\/td>':"";return u+"<\/tr><\/table><\/div>"}var i=r.editor.utils,u=r.editor.ui.UIBase,t=r.editor.ui.ColorPicker=function(n){this.initOptions(n),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()},n;t.prototype={getHtmlTpl:function(){return f(this.noColorText,this.editor)},_onTableClick:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&this.fireEvent("pickcolor",t)},_onTableOver:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&(this.getDom("preview").style.backgroundColor=t)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},i.inherits(t,u),n="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")}(),function(){var u=r.editor.utils,n=r.editor.ui.uiUtils,t=r.editor.ui.UIBase,i=r.editor.ui.TablePicker=function(n){this.initOptions(n),this.initTablePicker()};i.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var n=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"><\/span><\/div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"><\/div><\/div><\/div><\/div>'},_UIBase_render:t.prototype.render,render:function(n){this._UIBase_render(n),this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(n,t){var i=this.getDom("overlay").style,r=this.lengthOfCellSide,u;i.width=n*r+"px",i.height=t*r+"px",u=this.getDom("label"),u.innerHTML=n+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row"),this.numCols=n,this.numRows=t},_onMouseOver:function(t,i){var r=t.relatedTarget||t.fromElement;n.contains(i,r)||i===r||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(t,i){var r=t.relatedTarget||t.toElement;n.contains(i,r)||i===r||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(t){var e=this.getDom("overlay").style,i=n.getEventOffset(t),r=this.lengthOfCellSide,u=Math.ceil(i.left/r),f=Math.ceil(i.top/r);this._track(u,f)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}},u.inherits(i,t)}(),function(){var i=r.editor.browser,n=r.editor.dom.domUtils,t=r.editor.ui.uiUtils,u='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(i.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');r.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var n=this._Stateful_dGetHtmlTpl();return n.replace(/stateful/g,function(){return u})},Stateful_onMouseEnter:function(n,t){this.target=t,(!this.isDisabled()||this.alwalysHoverable)&&(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(){(!this.isDisabled()||this.alwalysHoverable)&&(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(n,i){var r=n.relatedTarget;t.contains(i,r)||i===r||this.Stateful_onMouseEnter(n,i)},Stateful_onMouseOut:function(n,i){var r=n.relatedTarget;t.contains(i,r)||i===r||this.Stateful_onMouseLeave(n,i)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(t){return n.hasClass(this.getStateDom(),"edui-state-"+t)},addState:function(n){this.hasState(n)||(this.getStateDom().className+=" edui-state-"+n)},removeState:function(t){this.hasState(t)&&n.removeClasses(this.getStateDom(),["edui-state-"+t])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(n){!this.isDisabled()&&n?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(n){n?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var t=r.editor.utils,i=r.editor.ui.UIBase,u=r.editor.ui.Stateful,n=r.editor.ui.Button=function(n){this.initOptions(n),this.initButton()};n.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"><\/div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"<\/div>":"")+"<\/div><\/div><\/div><\/div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onClick:function(){this.isDisabled()||this.fireEvent("click")}},t.inherits(n,i),t.extend(n.prototype,u)}(),function(){var n=r.editor.utils,t=r.editor.ui.uiUtils,e=r.editor.dom.domUtils,u=r.editor.ui.UIBase,f=r.editor.ui.Stateful,i=r.editor.ui.SplitButton=function(n){this.initOptions(n),this.initSplitButton()};i.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){var t,n;this.initUIBase(),this.Stateful_init(),t=this,this.popup!=null&&(n=this.popup,this.popup=null,this.setPopup(n))},_UIBase_postRender:u.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(i){this.popup!==i&&(this.popup!=null&&this.popup.dispose(),i.addListener("show",n.bind(this._onPopupShow,this)),i.addListener("hide",n.bind(this._onPopupHide,this)),i.addListener("postrender",n.bind(function(){i.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width+20)+'px"><\/div>')),i.getDom().className+=" "+this.className},this)),this.popup=i)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"><\/div><\/div><div class="edui-box edui-splitborder"><\/div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"><\/div><\/div><\/div><\/div>'},showPopup:function(){var n=t.getClientRect(this.getDom());n.top-=this.popup.SHADOW_RADIUS,n.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(n)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},n.inherits(i,u),n.extend(i.prototype,f,!0)}(),function(){var i=r.editor.utils,u=r.editor.ui.uiUtils,f=r.editor.ui.ColorPicker,e=r.editor.ui.Popup,n=r.editor.ui.SplitButton,t=r.editor.ui.ColorButton=function(n){this.initOptions(n),this.initColorButton()};t.prototype={initColorButton:function(){var n=this;this.popup=new e({content:new f({noColorText:n.editor.getLang("clearColor"),editor:n.editor,onpickcolor:function(t,i){n._onPickColor(i)},onpicknocolor:function(t,i){n._onPickNoColor(i)}}),editor:n.editor}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(u.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"><\/div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(n){this.getDom("colorlump").style.backgroundColor=n,this.color=n},_onPickColor:function(n){this.fireEvent("pickcolor",n)!==!1&&(this.setColor(n),this.popup.hide())},_onPickNoColor:function(){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}},i.inherits(t,n)}(),function(){var t=r.editor.utils,i=r.editor.ui.Popup,u=r.editor.ui.TablePicker,f=r.editor.ui.SplitButton,n=r.editor.ui.TableButton=function(n){this.initOptions(n),this.initTableButton()};n.prototype={initTableButton:function(){var n=this;this.popup=new i({content:new u({editor:n.editor,onpicktable:function(t,i,r){n._onPickTable(i,r)}}),editor:n.editor}),this.initSplitButton()},_onPickTable:function(n,t){this.fireEvent("picktable",n,t)!==!1&&this.popup.hide()}},t.inherits(n,f)}(),function(){var i=r.editor.utils,n=r.editor.ui.UIBase,t=r.editor.ui.AutoTypeSetPicker=function(n){this.initOptions(n),this.initAutoTypeSetPicker()};t.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var t=this.editor,n=t.options.autotypeset,i=t.getLang("autoTypeSet"),u="textAlignValue"+t.uid,r="imageBlockLineValue"+t.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(n.mergeEmptyline?"checked":"")+">"+i.mergeLine+'<\/td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(n.removeEmptyline?"checked":"")+">"+i.delLine+'<\/td><\/tr><tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(n.removeClass?"checked":"")+">"+i.removeFormat+'<\/td><td colspan="2"><input type="checkbox" name="indent" '+(n.indent?"checked":"")+">"+i.indent+'<\/td><\/tr><tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(n.textAlign?"checked":"")+">"+i.alignment+'<\/td><td colspan="2" id="'+u+'"><input type="radio" name="'+u+'" value="left" '+(n.textAlign&&n.textAlign=="left"?"checked":"")+">"+t.getLang("justifyleft")+'<input type="radio" name="'+u+'" value="center" '+(n.textAlign&&n.textAlign=="center"?"checked":"")+">"+t.getLang("justifycenter")+'<input type="radio" name="'+u+'" value="right" '+(n.textAlign&&n.textAlign=="right"?"checked":"")+">"+t.getLang("justifyright")+' <\/tr><tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(n.imageBlockLine?"checked":"")+">"+i.imageFloat+'<\/td><td nowrap colspan="2" id="'+r+'"><input type="radio" name="'+r+'" value="none" '+(n.imageBlockLine&&n.imageBlockLine=="none"?"checked":"")+">"+t.getLang("default")+'<input type="radio" name="'+r+'" value="left" '+(n.imageBlockLine&&n.imageBlockLine=="left"?"checked":"")+">"+t.getLang("justifyleft")+'<input type="radio" name="'+r+'" value="center" '+(n.imageBlockLine&&n.imageBlockLine=="center"?"checked":"")+">"+t.getLang("justifycenter")+'<input type="radio" name="'+r+'" value="right" '+(n.imageBlockLine&&n.imageBlockLine=="right"?"checked":"")+">"+t.getLang("justifyright")+'<\/tr><tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(n.clearFontSize?"checked":"")+">"+i.removeFontsize+'<\/td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(n.clearFontFamily?"checked":"")+">"+i.removeFontFamily+'<\/td><\/tr><tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(n.removeEmptyNode?"checked":"")+">"+i.removeHtml+'<\/td><\/tr><tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(n.pasteFilter?"checked":"")+">"+i.pasteFilter+'<\/td><\/tr><tr><td nowrap colspan="4" align="right"><button >'+i.run+"<\/button><\/td><\/tr><\/table><\/div><\/div>"},_UIBase_render:n.prototype.render},i.inherits(t,n)}(),function(){function i(t){for(var i=t.editor.options.autotypeset,l=t.getDom(),w=t.editor.uid,a=null,r=null,v=n.getElementsByTagName(l,"input"),e,f,o,y,s,p,h,c,u=v.length-1;e=v[u--];)if(a=e.getAttribute("type"),a=="checkbox"&&(r=e.getAttribute("name"),i[r]&&delete i[r],e.checked))if(f=document.getElementById(r+"Value"+w),f){if(/input/ig.test(f.tagName))i[r]=f.value;else for(o=f.getElementsByTagName("input"),y=o.length-1;s=o[y--];)if(s.checked){i[r]=s.value;break}}else i[r]=!0;for(p=n.getElementsByTagName(l,"select"),u=0;h=p[u++];)c=h.getAttribute("name"),i[c]=i[c]?h.value:"";t.editor.options.autotypeset=i}var u=r.editor.utils,f=r.editor.ui.Popup,e=r.editor.ui.AutoTypeSetPicker,o=r.editor.ui.SplitButton,t=r.editor.ui.AutoTypeSetButton=function(n){this.initOptions(n),this.initAutoTypeSetButton()};t.prototype={initAutoTypeSetButton:function(){var n=this,t;this.popup=new f({content:new e({editor:n.editor}),editor:n.editor,hide:function(){!this._hidden&&this.getDom()&&(i(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}}),t=0,this.popup.addListener("postRenderAfter",function(){var r=this,u,f;t||(u=this.getDom(),f=u.getElementsByTagName("button")[0],f.onclick=function(){i(r),n.editor.execCommand("autotypeset"),r.hide()},t=1)}),this.initSplitButton()}},u.inherits(t,o)}(),function(){var t=r.editor.utils,u=r.editor.ui.Popup,f=r.editor.ui.Stateful,i=r.editor.ui.UIBase,n=r.editor.ui.CellAlignPicker=function(n){this.initOptions(n),this.initSelected(),this.initCellAlignPicker()};n.prototype={initSelected:function(){var n={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3};this.selected&&(this.selectedIndex=n.valign[this.selected.valign]*n.count+n.align[this.selected.align])},initCellAlignPicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){for(var u=["left","center","right"],r=null,t=-1,i=[],n=0;n<9;n++)r=this.selectedIndex===n?' class="edui-cellalign-selected" ':"",t=n%3,t===0&&i.push("<tr>"),i.push('<td index="'+n+'" '+r+' stateful><div class="edui-icon edui-'+u[t]+'"><\/div><\/td>'),t===2&&i.push("<\/tr>");return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+i.join("")+"<\/table><\/div><\/div>"},getStateDom:function(){return this.target},_onClick:function(n){var t=n.target||n.srcElement;/icon/.test(t.className)&&(this.items[t.parentNode.getAttribute("index")].onclick(),u.postHide(n))},_UIBase_render:i.prototype.render},t.inherits(n,i),t.extend(n.prototype,f,!0)}(),function(){var i=r.editor.utils,e=r.editor.ui.Stateful,u=r.editor.ui.uiUtils,f=r.editor.ui.UIBase,t=r.editor.ui.PastePicker=function(n){this.initOptions(n),this.initPastePicker()};t.prototype={initPastePicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"><\/div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'<\/div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"><\/div><\/div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"><\/div><\/div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"><\/div><\/div><\/div><\/div><\/div>'},getStateDom:function(){return this.target},format:function(n){this.editor.ui._isTransfer=!0,this.editor.fireEvent("pasteTransfer",n)},_onClick:function(t){var i=n.getNextDomNode(t),f=u.getViewportRect().height,r=u.getClientRect(i);i.style.top=r.top+r.height>f?-r.height-t.offsetHeight+"px":"",/hidden/ig.test(n.getComputedStyle(i,"visibility"))?(i.style.visibility="visible",n.addClass(t,"edui-state-opened")):(i.style.visibility="hidden",n.removeClasses(t,"edui-state-opened"))},_UIBase_render:f.prototype.render},i.inherits(t,f),i.extend(t.prototype,e,!0)}(),function(){var t=r.editor.utils,i=r.editor.ui.uiUtils,u=r.editor.ui.UIBase,n=r.editor.ui.Toolbar=function(n){this.initOptions(n),this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(n){this.items.push(n)},getHtmlTpl:function(){for(var t=[],n=0;n<this.items.length;n++)t[n]=this.items[n].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"<\/div>"},postRender:function(){for(var t=this.getDom(),n=0;n<this.items.length;n++)this.items[n].postRender();i.makeUnselectable(t)},_onMouseDown:function(){return!1}},t.inherits(n,u)}(),function(){var e=r.editor.utils,u=r.editor.dom.domUtils,t=r.editor.ui.uiUtils,o=r.editor.ui.UIBase,i=r.editor.ui.Popup,s=r.editor.ui.Stateful,h=r.editor.ui.CellAlignPicker,f=r.editor.ui.Menu=function(n){this.initOptions(n),this.initMenu()},c={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"><\/div><\/div>'},postRender:function(){},queryAutoHide:function(){return!0}},n;f.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var i,t=0;t<this.items.length;t++)i=this.items[t],i=="-"?this.items[t]=this.getSeparator():i instanceof n||(i.editor=this.editor,i.theme=this.editor.options.theme,this.items[t]=this.createItem(i))},getSeparator:function(){return c},createItem:function(t){return t.menu=this,new n(t)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){var t,n,i;if(this.items.length==0)return this._Popup_getContentHtmlTpl();for(t=[],n=0;n<this.items.length;n++)i=this.items[n],t[n]=i.renderHtml();return'<div class="%%-body">'+t.join("")+"<\/div>"},_Popup_postRender:i.prototype.postRender,postRender:function(){for(var r=this,i,n=0;n<this.items.length;n++)i=this.items[n],i.ownerMenu=this,i.postRender();u.on(this.getDom(),"mouseover",function(n){n=n||event;var i=n.relatedTarget||n.fromElement,u=r.getDom();t.contains(u,i)||u===i||r.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(n){var i,r;if(n){if(t.contains(this.getDom(),n))return!1;for(i=0;i<this.items.length;i++)if(r=this.items[i],r.queryAutoHide(n)===!1)return!1}},clearItems:function(){for(var n,t=0;t<this.items.length;t++)n=this.items[t],clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n.subMenu&&n.subMenu.destroy();this.items=[]},destroy:function(){this.getDom()&&u.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},e.inherits(f,i),n=r.editor.ui.MenuItem=function(n){if(this.initOptions(n),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof f))if(n.className&&n.className.indexOf("aligntd")!=-1){var t=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new i({content:new h(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){this.getDom()&&u.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){u.on(this.getDom(),"mouseover",function(){t.addState("opened")})})}else this.subMenu=new f(this.subMenu)},n.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"<\/div><\/div>"},postRender:function(){var n=this;this.addListener("over",function(){n.ownerMenu.fireEvent("submenuover",n),n.subMenu&&n.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){n.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(n._closingTimer),n._closingTimer=null,n.addState("opened")}),this.ownerMenu.addListener("hide",function(){n.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,i){i!==n&&n.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(i){return i&&t.contains(n.getDom(),i)?!1:this._bakQueryAutoHide(i)}),this.getDom().style.tabIndex="-1",t.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var n=this;n.isDisabled()||(n.addState("opened"),clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n._closingTimer=null,n._showingTimer=setTimeout(function(){n.showSubMenu()},250))},delayHideSubMenu:function(){var n=this;n.isDisabled()||(n.removeState("opened"),clearTimeout(n._showingTimer),n._closingTimer||(n._closingTimer=setTimeout(function(){n.hasState("opened")||n.hideSubMenu(),n._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"><\/div><div class="edui-box edui-icon"><\/div><div class="edui-box edui-label %%-label">'+(this.label||"")+"<\/div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(n){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(n)},_onClick:function(n,t){this.hasState("disabled")||this.fireEvent("click",n,t)!==!1&&(this.subMenu?this.showSubMenu():i.postHide(n))},showSubMenu:function(){var n=t.getClientRect(this.getDom());n.right-=5,n.left+=2,n.width-=7,n.top-=4,n.bottom+=4,n.height+=8,this.subMenu.showAnchorRect(n,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},e.inherits(n,o),e.extend(n.prototype,s,!0)}(),function(){var i=r.editor.utils,u=r.editor.ui.uiUtils,f=r.editor.ui.Menu,n=r.editor.ui.SplitButton,t=r.editor.ui.Combox=function(n){this.initOptions(n),this.initCombox()};t.prototype={uiName:"combox",initCombox:function(){var i=this,n,t;for(this.items=this.items||[],n=0;n<this.items.length;n++)t=this.items[n],t.uiName="listitem",t.index=n,t.onclick=function(){i.selectByIndex(this.index)};this.popup=new f({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var n=u.getClientRect(this.getDom());n.top+=1,n.bottom-=1,n.height-=2,this.popup.showAnchorRect(n)},getValue:function(){return this.value},setValue:function(n){var t=this.indexByValue(n);t!=-1?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(n)),this.value=n)},setLabel:function(n){this.getDom("button_body").innerHTML=n,this.label=n},getLabelForUnknowValue:function(n){return n},indexByValue:function(n){for(var t=0;t<this.items.length;t++)if(n==this.items[t].value)return t;return-1},getItem:function(n){return this.items[n]},selectByIndex:function(n){n<this.items.length&&this.fireEvent("select",n)!==!1&&(this.selectedIndex=n,this.value=this.items[n].value,this.setLabel(this.items[n].label))}},i.inherits(t,n)}(),function(){var f=r.editor.utils,n=r.editor.dom.domUtils,t=r.editor.ui.uiUtils,e=r.editor.ui.Mask,c=r.editor.ui.UIBase,u=r.editor.ui.Button,o=r.editor.ui.Dialog=function(n){this.initOptions(f.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()},holdScroll:!1},n)),this.initDialog()},s,h;o.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var i=this,t=this.editor.options.theme,n;if(this.initUIBase(),this.modalMask=s||(s=new e({className:"edui-dialog-modalmask",theme:t})),this.dragMask=h||(h=new e({className:"edui-dialog-dragmask",theme:t})),this.closeButton=new u({className:"edui-dialog-closebutton",title:i.closeDialog,theme:t,onclick:function(){i.close(!1)}}),this.buttons)for(n=0;n<this.buttons.length;n++)this.buttons[n]instanceof u||(this.buttons[n]=new u(this.buttons[n]))},fitSize:function(){var t=this.getDom("body"),n=this.mesureSize();return t.style.width=n.width+"px",t.style.height=n.height+"px",n},safeSetOffset:function(n){var o=this,f=o.getDom(),i=t.getViewportRect(),r=t.getClientRect(f),e=n.left,u;e+r.width>i.right&&(e=i.right-r.width),u=n.top,u+r.height>i.bottom&&(u=i.bottom-r.height),f.style.left=Math.max(e,0)+"px",f.style.top=Math.max(u,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var i=t.getViewportRect(),r=this.fitSize(),u=this.getDom("titlebar").offsetHeight|0,e=i.width/2-r.width/2,o=i.height/2-(r.height-u)/2-u,f=this.getDom();this.safeSetOffset({left:Math.max(e|0,0),top:Math.max(o|0,0)}),n.hasClass(f,"edui-state-centered")||(f.className+=" edui-state-centered"),this._show()},getContentHtml:function(){var n="";return typeof this.content=="string"?n=this.content:this.iframeUrl&&(n='<span id="'+this.id+'_contmask" class="dialogcontmask"><\/span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"><\/iframe>'),n},getHtmlTpl:function(){var i="",t,n;if(this.buttons){for(t=[],n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();i='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"<\/div><\/div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"><\/div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"<\/span><\/div>"+this.closeButton.renderHtml()+'<\/div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"<\/div>"+i+"<\/div><\/div><\/div>"},postRender:function(){var r,u;if(this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide()),r=this,this.addListener("show",function(){r.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){r.modalMask.hide()}),this.buttons)for(u=0;u<this.buttons.length;u++)this.buttons[u].postRender();n.on(window,"resize",function(){setTimeout(function(){r.isHidden()||r.safeSetOffset(t.getClientRect(r.getDom()))})});if(this.holdScroll)if(r.iframeUrl)r.addListener("dialogafterreset",function(){window.setTimeout(function(){var t=document.getElementById(r.id+"_iframe").contentWindow,u;if(i.ie)u=window.setInterval(function(){if(t.document&&t.document.body){window.clearInterval(u),u=null;n.on(t.document.body,i.gecko?"DOMMouseScroll":"mousewheel",function(t){n.preventDefault(t)})}},100);else n.on(t,i.gecko?"DOMMouseScroll":"mousewheel",function(t){n.preventDefault(t)})},1)});else n.on(document.getElementById(r.id+"_iframe"),i.gecko?"DOMMouseScroll":"mousewheel",function(t){n.preventDefault(t)});this._hide()},mesureSize:function(){var n=this.getDom("body"),i=t.getClientRect(this.getDom("content")).width,r=n.style;return r.width=i,t.getClientRect(n)},_onTitlebarMouseDown:function(i){if(this.draggable){var u,f=t.getViewportRect(),r=this;t.startDrag(i,{ondragstart:function(){u=t.getClientRect(r.getDom()),r.getDom("contmask").style.visibility="visible",r.dragMask.show(r.getDom().style.zIndex-1)},ondragmove:function(n,t){var i=u.left+n,f=u.top+t;r.safeSetOffset({left:i,top:f})},ondragstop:function(){r.getDom("contmask").style.visibility="hidden",n.removeClasses(r.getDom(),["edui-state-centered"]),r.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10),this._hidden=!1,this.fireEvent("show"),r.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){if(this.autoReset)try{this.reset()}catch(n){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(t){}},_onCloseButtonClick:function(){this.close(!1)},close:function(n){this.fireEvent("close",n)!==!1&&this._hide()}},f.inherits(o,c)}(),function(){var t=r.editor.utils,i=r.editor.ui.Menu,u=r.editor.ui.SplitButton,n=r.editor.ui.MenuButton=function(n){this.initOptions(n),this.initMenuButton()};n.prototype={initMenuButton:function(){var n=this;this.uiName="menubutton",this.popup=new i({items:n.items,className:n.className,editor:n.editor}),this.popup.addListener("show",function(){for(var i=this,t=0;t<i.items.length;t++)i.items[t].removeState("checked"),i.items[t].value==n._value&&(i.items[t].addState("checked"),this.value=n._value)}),this.initSplitButton()},setValue:function(n){this._value=n}},t.inherits(n,u)}(),function(){var e=r.editor.utils,n=r.editor.ui,b=n.Dialog,o,c,s,f,t,h,u,l,a,v,y,p,w;for(n.buttons={},n.Dialog=function(n){var t=new b(n);return t.addListener("hide",function(){var n,r,u;if(t.editor){n=t.editor;try{i.gecko?(r=n.window.scrollY,u=n.window.scrollX,n.body.focus(),n.window.scrollTo(u,r)):n.focus()}catch(f){}}}),t},o={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"},c=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable"],f=0;t=c[f++];)t=t.toLowerCase(),n[t]=function(t){return function(i){var r=new n.Button({className:"edui-for-"+t,title:i.options.labelMap[t]||i.getLang("labelMap."+t)||"",onclick:function(){i.execCommand(t)},theme:i.options.theme,showText:!1});return n.buttons[t]=r,i.addListener("selectionchange",function(n,u,f){var e=i.queryCommandState(t);e==-1?(r.setDisabled(!0),r.setChecked(!1)):f||(r.setDisabled(!1),r.setChecked(e))}),r}}(t);n.cleardoc=function(t){var i=new n.Button({className:"edui-for-cleardoc",title:t.options.labelMap.cleardoc||t.getLang("labelMap.cleardoc")||"",theme:t.options.theme,onclick:function(){confirm(t.getLang("confirmClear"))&&t.execCommand("cleardoc")}});return n.buttons.cleardoc=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("cleardoc")==-1)}),i},s={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(u in s)(function(t,i){for(var u=0,r;r=i[u++];)(function(i){n[t.replace("float","")+i]=function(r){var u=new n.Button({className:"edui-for-"+t.replace("float","")+i,title:r.options.labelMap[t.replace("float","")+i]||r.getLang("labelMap."+t.replace("float","")+i)||"",theme:r.options.theme,onclick:function(){r.execCommand(t,i)}});return n.buttons[t]=u,r.addListener("selectionchange",function(n,f,e){u.setDisabled(r.queryCommandState(t)==-1),u.setChecked(r.queryCommandValue(t)==i&&!e)}),u}})(r)})(u,s[u]);for(f=0;t=["backcolor","forecolor"][f++];)n[t]=function(t){return function(i){var r=new n.ColorButton({className:"edui-for-"+t,color:"default",title:i.options.labelMap[t]||i.getLang("labelMap."+t)||"",editor:i,onpickcolor:function(n,r){i.execCommand(t,r)},onpicknocolor:function(){i.execCommand(t,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){i.execCommand(t,this.color)}});return n.buttons[t]=r,i.addListener("selectionchange",function(){r.setDisabled(i.queryCommandState(t)==-1)}),r}}(t);h={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background"]};for(u in h)(function(t,r){for(var f=0,u;u=r[f++];)i.opera&&u==="searchreplace"||function(i){n[i]=function(r,u,f){var s,h;return u=u||(r.options.iframeUrlMap||{})[i]||o[i],f=r.options.labelMap[i]||r.getLang("labelMap."+i)||"",u&&(s=new n.Dialog(e.extend({iframeUrl:r.ui.mapUrl(u),editor:r,className:"edui-for-"+i,title:f,holdScroll:i==="insertimage",closeDialog:r.getLang("closeDialog")},t=="ok"?{buttons:[{className:"edui-okbutton",label:r.getLang("ok"),editor:r,onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:r.getLang("cancel"),editor:r,onclick:function(){s.close(!1)}}]}:{})),r.ui._dialogs[i+"Dialog"]=s),h=new n.Button({className:"edui-for-"+i,title:f,onclick:function(){if(s)switch(i){case"wordimage":r.execCommand("wordimage","word_img"),r.word_img&&(s.render(),s.open());break;case"scrawl":r.queryCommandState("scrawl")!=-1&&(s.render(),s.open());break;default:s.render(),s.open()}},theme:r.options.theme,disabled:i=="scrawl"&&r.queryCommandState("scrawl")==-1}),n.buttons[i]=h,r.addListener("selectionchange",function(){var n;i in{edittable:1}||(n=r.queryCommandState(i),h.getDom()&&(h.setDisabled(n==-1),h.setChecked(n)))}),h}}(u.toLowerCase())})(u,h[u]);for(n.snapscreen=function(t,i,r){var f,u;return r=t.options.labelMap.snapscreen||t.getLang("labelMap.snapscreen")||"",f=new n.Button({className:"edui-for-snapscreen",title:r,onclick:function(){t.execCommand("snapscreen")},theme:t.options.theme}),n.buttons.snapscreen=f,i=i||(t.options.iframeUrlMap||{}).snapscreen||o.snapscreen,i&&(u=new n.Dialog({iframeUrl:t.ui.mapUrl(i),editor:t,className:"edui-for-snapscreen",title:r,buttons:[{className:"edui-okbutton",label:t.getLang("ok"),editor:t,onclick:function(){u.close(!0)}},{className:"edui-cancelbutton",label:t.getLang("cancel"),editor:t,onclick:function(){u.close(!1)}}]}),u.render(),t.ui._dialogs.snapscreenDialog=u),t.addListener("selectionchange",function(){f.setDisabled(t.queryCommandState("snapscreen")==-1)}),f},n.insertcode=function(t,i,r){var f,u;return i=t.options.insertcode||[],r=t.options.labelMap.insertcode||t.getLang("labelMap.insertcode")||"",f=[],e.each(i,function(n,i){f.push({label:n,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"<\/div>"}})}),u=new n.Combox({editor:t,items:f,onselect:function(n,i){t.execCommand("insertcode",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:r,className:"edui-for-insertcode",indexByValue:function(n){if(n)for(var t=0,i;i=this.items[t];t++)if(i.value.indexOf(n)!=-1)return t;return-1}}),n.buttons.insertcode=u,t.addListener("selectionchange",function(n,i,f){var o,e;if(!f)if(o=t.queryCommandState("insertcode"),o==-1)u.setDisabled(!0);else{if(u.setDisabled(!1),e=t.queryCommandValue("insertcode"),!e){u.setValue(r);return}e&&(e=e.replace(/['"]/g,"").split(",")[0]),u.setValue(e)}}),u},n.fontfamily=function(t,i,r){var o,f,s,h,u;if(i=t.options.fontfamily||[],r=t.options.labelMap.fontfamily||t.getLang("labelMap.fontfamily")||"",i.length){for(o=0,s=[];f=i[o];o++)h=t.getLang("fontfamily")[f.name]||"",function(n,i){s.push({label:n,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+e.unhtml(this.value)+'">'+(this.label||"")+"<\/div>"}})}(f.label||h,f.val);return u=new n.Combox({editor:t,items:s,onselect:function(n,i){t.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:r,className:"edui-for-fontfamily",indexByValue:function(n){if(n)for(var t=0,i;i=this.items[t];t++)if(i.value.indexOf(n)!=-1)return t;return-1}}),n.buttons.fontfamily=u,t.addListener("selectionchange",function(n,i,r){var e,f;r||(e=t.queryCommandState("FontFamily"),e==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("FontFamily"),f&&(f=f.replace(/['"]/g,"").split(",")[0]),u.setValue(f)))}),u}},n.fontsize=function(t,i,r){var e,f,o,u;if(r=t.options.labelMap.fontsize||t.getLang("labelMap.fontsize")||"",i=i||t.options.fontsize||[],i.length){for(e=[],f=0;f<i.length;f++)o=i[f]+"px",e.push({label:o,value:o,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"<\/div>"}});return u=new n.Combox({editor:t,items:e,title:r,initValue:r,onselect:function(n,i){t.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"}),n.buttons.fontsize=u,t.addListener("selectionchange",function(n,i,r){if(!r){var f=t.queryCommandState("FontSize");f==-1?u.setDisabled(!0):(u.setDisabled(!1),u.setValue(t.queryCommandValue("FontSize")))}}),u}},n.paragraph=function(t,i,r){var o,f,u;if(r=t.options.labelMap.paragraph||t.getLang("labelMap.paragraph")||"",i=t.options.paragraph||[],!e.isEmptyObject(i)){o=[];for(f in i)o.push({value:f,label:i[f]||t.getLang("paragraph")[f],theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"<\/span><\/div>"}});return u=new n.Combox({editor:t,items:o,title:r,initValue:r,className:"edui-for-paragraph",onselect:function(n,i){t.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}}),n.buttons.paragraph=u,t.addListener("selectionchange",function(n,i,r){var e,f,o;r||(e=t.queryCommandState("Paragraph"),e==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("Paragraph"),o=u.indexByValue(f),o!=-1?u.setValue(f):u.setValue(u.initValue)))}),u}},n.customstyle=function(t){var u=t.options.customstyle||[],f=t.options.labelMap.customstyle||t.getLang("labelMap.customstyle")||"",e,o,r,s,i;if(u.length){for(e=t.getLang("customstyle"),o=0,r=[];s=u[o++];)(function(n){var i={};i.label=n.label?n.label:e[n.name],i.style=n.style,i.className=n.className,i.tag=n.tag,r.push({label:i.label,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+i.tag+" "+(i.className?' class="'+i.className+'"':"")+(i.style?' style="'+i.style+'"':"")+">"+i.label+"<\/"+i.tag+"><\/div>"}})})(s);return i=new n.Combox({editor:t,items:r,title:f,initValue:f,className:"edui-for-customstyle",onselect:function(n,i){t.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(n){for(var t=0,i;i=this.items[t++];)if(i.label==n)return t-1;return-1}}),n.buttons.customstyle=i,t.addListener("selectionchange",function(n,r,u){var e,f,o;u||(e=t.queryCommandState("customstyle"),e==-1?i.setDisabled(!0):(i.setDisabled(!1),f=t.queryCommandValue("customstyle"),o=i.indexByValue(f),o!=-1?i.setValue(f):i.setValue(i.initValue)))}),i}},n.inserttable=function(t,i,r){r=t.options.labelMap.inserttable||t.getLang("labelMap.inserttable")||"";var u=new n.TableButton({editor:t,title:r,className:"edui-for-inserttable",onpicktable:function(n,i,r){t.execCommand("InsertTable",{numRows:r,numCols:i,border:1})},onbuttonclick:function(){this.showPopup()}});return n.buttons.inserttable=u,t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState("inserttable")==-1)}),u},n.lineheight=function(t){var f=t.options.lineheight||[],e,r,u,i;if(f.length){for(e=0,u=[];r=f[e++];)u.push({label:r,value:r,theme:t.options.theme,onclick:function(){t.execCommand("lineheight",this.value)}});return i=new n.MenuButton({editor:t,className:"edui-for-lineheight",title:t.options.labelMap.lineheight||t.getLang("labelMap.lineheight")||"",items:u,onbuttonclick:function(){var n=t.queryCommandValue("LineHeight")||this.value;t.execCommand("LineHeight",n)}}),n.buttons.lineheight=i,t.addListener("selectionchange",function(){var r=t.queryCommandState("LineHeight"),n;r==-1?i.setDisabled(!0):(i.setDisabled(!1),n=t.queryCommandValue("LineHeight"),n&&i.setValue((n+"").replace(/cm/,"")),i.setChecked(r))}),i}},l=["top","bottom"],a=0;v=l[a++];)(function(t){n["rowspacing"+t]=function(i){var e=i.options["rowspacing"+t]||[],o,u,f,r;if(!e.length)return null;for(o=0,f=[];u=e[o++];)f.push({label:u,value:u,theme:i.options.theme,onclick:function(){i.execCommand("rowspacing",this.value,t)}});return r=new n.MenuButton({editor:i,className:"edui-for-rowspacing"+t,title:i.options.labelMap["rowspacing"+t]||i.getLang("labelMap.rowspacing"+t)||"",items:f,onbuttonclick:function(){var n=i.queryCommandValue("rowspacing",t)||this.value;i.execCommand("rowspacing",n,t)}}),n.buttons[t]=r,i.addListener("selectionchange",function(){var u=i.queryCommandState("rowspacing",t),n;u==-1?r.setDisabled(!0):(r.setDisabled(!1),n=i.queryCommandValue("rowspacing",t),n&&r.setValue((n+"").replace(/%/,"")),r.setChecked(u))}),r}})(v);for(y=["insertorderedlist","insertunorderedlist"],p=0;w=y[p++];)(function(t){n[t]=function(i){var f=i.options[t],o=function(){i.execCommand(t,this.value)},e=[],u,r;for(u in f)e.push({label:f[u]||i.getLang()[t][u]||"",value:u,theme:i.options.theme,onclick:o});return r=new n.MenuButton({editor:i,className:"edui-for-"+t,title:i.getLang("labelMap."+t)||"",items:e,onbuttonclick:function(){var n=i.queryCommandValue(t)||this.value;i.execCommand(t,n)}}),n.buttons[t]=r,i.addListener("selectionchange",function(){var n=i.queryCommandState(t),u;n==-1?r.setDisabled(!0):(r.setDisabled(!1),u=i.queryCommandValue(t),r.setValue(u),r.setChecked(n))}),r}})(w);n.fullscreen=function(t,i){i=t.options.labelMap.fullscreen||t.getLang("labelMap.fullscreen")||"";var r=new n.Button({className:"edui-for-fullscreen",title:i,theme:t.options.theme,onclick:function(){t.ui&&t.ui.setFullScreen(!t.ui.isFullScreen()),this.setChecked(t.ui.isFullScreen())}});return n.buttons.fullscreen=r,t.addListener("selectionchange",function(){var n=t.queryCommandState("fullscreen");r.setDisabled(n==-1),r.setChecked(t.ui.isFullScreen())}),r},n.emotion=function(t,i){var r="emotion",u=new n.MultiMenuPop({title:t.options.labelMap[r]||t.getLang("labelMap."+r+"")||"",editor:t,className:"edui-for-"+r,iframeUrl:t.ui.mapUrl(i||(t.options.iframeUrlMap||{})[r]||o[r])});return n.buttons[r]=u,t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState(r)==-1)}),u},n.autotypeset=function(t){var i=new n.AutoTypeSetButton({editor:t,title:t.options.labelMap.autotypeset||t.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){t.execCommand("autotypeset")}});return n.buttons.autotypeset=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("autotypeset")==-1)}),i}}(),function(){function f(n){this.initOptions(n),this.initEditorUI()}var u=r.editor.utils,e=r.editor.ui.uiUtils,s=r.editor.ui.UIBase,n=r.editor.dom.domUtils,o=[],t;f.prototype={uiName:"editor",initEditorUI:function(){function s(n,t){var r;n.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:n.options.wordCountMsg||n.getLang("wordCountMsg"),wordOverFlowMsg:n.options.wordOverFlowMsg||n.getLang("wordOverFlowMsg")});var i=n.options,u=i.maximumWords,e=i.wordCountMsg,o=i.wordOverFlowMsg,f=t.getDom("wordcount");i.wordCount&&(r=n.getContentLength(!0),r>u?(f.innerHTML=o,n.fireEvent("wordcountoverflow")):f.innerHTML=e.replace("{#leave}",u-r).replace("{#count}",r))}var t,f,u,e,o,i;this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars(),t=this.editor,f=this,t.addListener("ready",function(){t.getDialog=function(n){return t.ui._dialogs[n+"Dialog"]};n.on(t.window,"scroll",function(n){r.editor.ui.Popup.postHide(n)});if(t.ui._actualFrameWidth=t.options.initialFrameWidth,t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":<\/div>"),t.options.wordCount){function i(){s(t,f),n.un(t.document,"click",arguments.callee)}n.on(t.document,"click",i);t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")}(t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),f.enableScale()):f.disableScale(),t.options.elementPathEnabled||t.options.wordCount||t.options.scaleEnabled||(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus())&&t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(n,t){var i=t.target||t.srcElement;r.editor.ui.Popup.postHide(t,i),r.editor.ui.ShortCutMenu.postHide(t)}),t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t),t.getDialog("edittip").open()}),e=!1,t.addListener("afterpaste",function(){t.queryCommandState("pasteplain")||(r.editor.ui.PastePicker&&(u=new r.editor.ui.Popup({content:new r.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),u.render()),e=!0)}),t.addListener("afterinserthtml",function(){clearTimeout(o),o=setTimeout(function(){var i,f,r;u&&(e||t.ui._isTransfer)&&(u.isHidden()?(i=n.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"﻿"}),f=t.selection.getRange(),f.insertNode(i),r=c(i,"firstChild","previousSibling"),u.showAnchor(r.nodeType==3?r.parentNode:r),n.remove(i)):u.show(),delete t.ui._isTransfer,e=!1)},200)}),t.addListener("contextmenu",function(n,t){r.editor.ui.Popup.postHide(t)}),t.addListener("keydown",function(n,t){u&&u.dispose(t);var i=t.keyCode||t.which;t.altKey&&i==90&&UE.ui.buttons.fullscreen.onclick()}),t.addListener("wordcount",function(){s(this,f)}),t.addListener("selectionchange",function(){t.options.elementPathEnabled&&f[(t.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&f[(t.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()}),i=new r.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(n){this.hide(),t.ui._dialogs[n]&&t.ui._dialogs[n].open()},_onImgSetFloat:function(n){this.hide(),t.execCommand("imagefloat",n)},_setIframeAlign:function(t){var u=i.anchorEl,r=u.cloneNode(!0);switch(t){case-2:r.setAttribute("align","");break;case-1:r.setAttribute("align","left");break;case 1:r.setAttribute("align","right")}u.parentNode.insertBefore(r,u),n.remove(u),i.anchorEl=r,i.showAnchor(i.anchorEl)},_updateIframe:function(){t._iframe=i.anchorEl,t.ui._dialogs.insertframeDialog.open(),i.hide()},_onRemoveButtonClick:function(n){t.execCommand(n),this.hide()},queryAutoHide:function(u){return u&&u.ownerDocument==t.document&&(u.tagName.toLowerCase()=="img"||n.findParentByTagName(u,"a",!0))?u!==i.anchorEl:r.editor.ui.Popup.prototype.queryAutoHide.call(this,u)}}),i.render(),t.options.imagePopup&&(t.addListener("mouseover",function(n,r){var u,f;r=r||window.event,u=r.target||r.srcElement,t.ui._dialogs.insertframeDialog&&/iframe/ig.test(u.tagName)&&(f=i.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'<\/span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'<\/span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'<\/span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"<\/span><\/nobr>"),f?(i.getDom("content").innerHTML=f,i.anchorEl=u,i.showAnchor(i.anchorEl)):i.hide())}),t.addListener("selectionchange",function(n,r){var f,o,s,h;if(r){var e="",c="",u=t.selection.getRange().getClosedNode(),l=t.ui._dialogs;if(u&&u.tagName=="IMG"){if(f="insertimageDialog",u.className.indexOf("edui-faked-video")!=-1&&(f="insertvideoDialog"),u.className.indexOf("edui-faked-webapp")!=-1&&(f="webappDialog"),u.src.indexOf("http://api.map.baidu.com")!=-1&&(f="mapDialog"),u.className.indexOf("edui-faked-music")!=-1&&(f="musicDialog"),u.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(f="gmapDialog"),u.getAttribute("anchorname")&&(f="anchorDialog",e=i.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"<\/span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"<\/span><\/nobr>")),u.getAttribute("word_img")&&(t.word_img=[u.getAttribute("word_img")],f="wordimageDialog"),!l[f])return;c="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'<\/span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'<\/span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'<\/span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"<\/span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+f+'\');" class="edui-clickable">'+t.getLang("modify")+"<\/span><\/nobr>",e||(e=i.formatHtml(c))}t.ui._dialogs.linkDialog&&(o=t.queryCommandValue("link"),o&&(s=o.getAttribute("_href")||o.getAttribute("href",2))&&(h=s,s.length>30&&(h=s.substring(0,20)+"..."),e&&(e+='<div style="height:5px;"><\/div>'),e+=i.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+s+'" title="'+s+'" >'+h+'<\/a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'<\/span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"<\/span><\/nobr>"),i.showAnchor(o))),e?(i.getDom("content").innerHTML=e,i.anchorEl=u||o,i.showAnchor(i.anchorEl)):i.hide()}}))},_initToolbars:function(){for(var s=this.editor,h=this.toolbars||[],i=[],o,f,e,n,t,u=0;u<h.length;u++){for(o=h[u],f=new r.editor.ui.Toolbar({theme:s.options.theme}),e=0;e<o.length;e++){if(n=o[e],t=null,typeof n=="string"){if(n=n.toLowerCase(),n=="|"&&(n="Separator"),n=="||"&&(n="Breakline"),r.editor.ui[n]&&(t=new r.editor.ui[n](s)),n=="fullscreen"){i&&i[0]?i[0].items.splice(0,0,t):t&&f.items.splice(0,0,t);continue}}else t=n;t&&t.id&&f.add(t)}i[u]=f}this.toolbars=i},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"<\/div><\/div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'<\/div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x<\/div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"><\/div><div style="height:0;overflow:hidden;clear:both;"><\/div><\/div><\/div><div id="##_iframeholder" class="%%-iframeholder"><\/div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"><\/td><td id="##_wordcount" class="%%-wordcount"><\/td><td id="##_scale" class="%%-scale"><div class="%%-icon"><\/div><\/td><\/tr><\/table><\/div><div id="##_scalelayer"><\/div><\/div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img"),this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var t=[],n=0;n<this.toolbars.length;n++)t.push(this.toolbars[n].renderHtml());return t.join("")},setFullScreen:function(n){var t=this.editor,u=t.container.parentNode.parentNode,e,s,f;if(this._fullscreen!=n){if(this._fullscreen=n,this.editor.fireEvent("beforefullscreenchange",n),r.editor.browser.gecko&&(e=t.selection.getRange().createBookmark()),n){while(u.tagName!="BODY")s=r.editor.dom.domUtils.getComputedStyle(u,"position"),o.push(s),u.style.position="static",u=u.parentNode;this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,t.iframe.parentNode.style.width="",this._updateFullScreen()}else{while(u.tagName!="BODY")u.style.position=o.shift(),u=u.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}i.gecko&&t.body.contentEditable==="true"&&(f=document.createElement("input"),document.body.appendChild(f),t.body.contentEditable=!1,setTimeout(function(){f.focus(),setTimeout(function(){t.body.contentEditable=!0,t.fireEvent("fullscreenchanged",n),t.selection.getRange().moveToBookmark(e).select(!0),r.editor.dom.domUtils.remove(f),n&&window.scroll(0,0)},0)},0)),t.body.contentEditable==="true"&&(this.editor.fireEvent("fullscreenchanged",n),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var n=e.getViewportRect();if(this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+n.width+"px;height:"+n.height+"px;z-index:"+(this.getDom().style.zIndex*1+100),e.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(n.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0)),i.gecko)try{window.onresize()}catch(t){}}},_updateElementPath:function(){var i=this.getDom("elementpath"),r,t,n,u;if(this.elementPathEnabled&&(r=this.editor.queryCommandValue("elementpath"))){for(t=[],n=0;u=r[n];n++)t[n]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+n+'&quot;);">'+u+"<\/span>");i.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+t.join(" &gt; ")+"<\/div>"}else i.style.display="none"},disableElementPath:function(){var n=this.getDom("elementpath");n.innerHTML="",n.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var n=this.getDom("elementpath");n.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function d(){c=n.getXY(e),l||(l=t.options.minFrameHeight+p.offsetHeight+w.offsetHeight),u.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+e.offsetWidth+"px;height:"+e.offsetHeight+"px;z-index:"+(t.options.zIndex+1);n.on(r,"mousemove",g);n.on(y,"mouseup",h);n.on(r,"mouseup",h)}function g(n){nt();var t=n||window.event;b=t.pageX||r.documentElement.scrollLeft+t.clientX,k=t.pageY||r.documentElement.scrollTop+t.clientY,a=b-c.x,v=k-c.y,a>=tt&&(s=!0,u.style.width=a+"px"),v>=l&&(s=!0,u.style.height=v+"px")}function h(){s&&(s=!1,t.ui._actualFrameWidth=u.offsetWidth-2,e.style.width=t.ui._actualFrameWidth+"px",t.setHeight(u.offsetHeight-w.offsetHeight-p.offsetHeight-2)),u&&(u.style.display="none"),nt(),n.un(r,"mousemove",g),n.un(y,"mouseup",h),n.un(r,"mouseup",h)}function nt(){i.ie?r.selection.clear():window.getSelection().removeAllRanges()}var r=document,t=this.editor,e=t.container,y=t.document,p=this.getDom("toolbarbox"),w=this.getDom("bottombar"),o=this.getDom("scale"),u=this.getDom("scalelayer"),s=!1,c=null,l=0,tt=t.options.minFrameWidth,b=0,k=0,a=0,v=0,f=this;this.editor.addListener("fullscreenchanged",function(t,i){if(i)f.disableScale();else if(f.editor.options.scaleEnabled){f.enableScale();var r=f.editor.document.createElement("span");f.editor.body.appendChild(r),f.editor.body.style.height=Math.max(n.getXY(r).y,f.editor.iframe.offsetHeight-20)+"px",n.remove(r)}}),this.enableScale=function(){if(t.queryCommandState("source")!=1){o.style.display="",this.scaleEnabled=!0;n.on(o,"mousedown",d)}},this.disableScale=function(){o.style.display="none",this.scaleEnabled=!1,n.un(o,"mousedown",d)}},isFullScreen:function(){return this._fullscreen},postRender:function(){var n;for(s.prototype.postRender.call(this),n=0;n<this.toolbars.length;n++)this.toolbars[n].postRender();var i=this,t,u=r.editor.dom.domUtils,f=function(){clearTimeout(t),t=setTimeout(function(){i._updateFullScreen()})};u.on(window,"resize",f);i.addListener("destroy",function(){u.un(window,"resize",f),clearTimeout(t)})},showToolbarMsg:function(n,t){if(this.getDom("toolbarmsg_label").innerHTML=n,this.getDom("toolbarmsg").style.display="",!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(n){return n?n.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var n=this.getDom();n.style.zoom=n.style.zoom=="1"?"100%":"1"}},u.inherits(f,r.editor.ui.UIBase),t={},UE.ui.Editor=function(i){var r=new UE.Editor(i),e;return r.options.editor=r,u.loadFile(document,{href:r.options.themePath+r.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"}),e=r.render,r.render=function(i){i.constructor===String&&(r.key=i,t[i]=r),u.domReady(function(){function t(){var o,h,t,c,l,u,s;for(r.setOpt({labelMap:r.options.labelMap||r.getLang("labelMap")}),new f(r.options),i&&(i.constructor===String&&(i=document.getElementById(i)),i&&i.getAttribute("name")&&(r.options.textarea=i.getAttribute("name")),i&&/script|textarea/ig.test(i.tagName)&&(o=document.createElement("div"),i.parentNode.insertBefore(o,i),h=i.value||i.innerHTML,r.options.initialContent=/^[\t\r\n ]*$/.test(h)?r.options.initialContent:h.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),i.className&&(o.className=i.className),i.style.cssText&&(o.style.cssText=i.style.cssText),/textarea/i.test(i.tagName)?(r.textarea=i,r.textarea.style.display="none"):(i.parentNode.removeChild(i),i.id&&(o.id=i.id)),i=o,i.innerHTML="")),n.addClass(i,"edui-"+r.options.theme),r.ui.render(i),t=r.options,r.container=r.ui.getDom(),c=n.findParents(i,!0),l=[],u=0;s=c[u];u++)l[u]=s.style.display,s.style.display="block";for(t.minFrameWidth=t.initialFrameWidth?t.initialFrameWidth:t.initialFrameWidth=i.offsetWidth,t.initialFrameHeight?t.minFrameHeight=t.initialFrameHeight:t.initialFrameHeight=t.minFrameHeight=i.offsetHeight,u=0;s=c[u];u++)s.style.display=l[u];i.style.height&&(i.style.height=""),r.container.style.width=t.initialFrameWidth+(/%$/.test(t.initialFrameWidth)?"":"px"),r.container.style.zIndex=t.zIndex,e.call(r,r.ui.getDom("iframeholder"))}r.langIsReady?t():r.addListener("langReady",t)})},r},UE.getEditor=function(n,i){var r=t[n];return r||(r=t[n]=new UE.ui.Editor(i),r.render(n)),r},UE.delEditor=function(n){var i;(i=t[n])&&(i.key&&i.destroy(),delete t[n])}}(),function(){var t=r.editor.utils,i=r.editor.ui.Popup,u=r.editor.ui.SplitButton,n=r.editor.ui.MultiMenuPop=function(n){this.initOptions(n),this.initMultiMenu()};n.prototype={initMultiMenu:function(){var n=this;this.popup=new i({content:"",editor:n.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+n.id+'_iframe" src="'+n.iframeUrl+'" frameborder="0"><\/iframe>',n.editor.container.style.zIndex&&(this.getDom().style.zIndex=n.editor.container.style.zIndex*1+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},t.inherits(n,u)}(),function(){function s(t){var u=t.target||t.srcElement,f=n.findParent(u,function(t){return n.hasClass(t,"edui-shortcutmenu")||n.hasClass(t,"edui-popup")},!0),i,r;if(!f)for(i=0;r=h[i++];)r.hide()}var t=r.editor.ui,l=t.UIBase,e=t.uiUtils,u=r.editor.utils,n=r.editor.dom.domUtils,h=[],c,f=!1,o=t.ShortCutMenu=function(n){this.initOptions(n),this.initShortCutMenu()};o.postHide=s,o.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),h.push(this)},initEvent:function(){var t=this,r=t.editor.document;n.on(r,"mousemove",function(n){if(t.isHidden===!1){if(t.getSubMenuMark()||t.eventType=="contextmenu")return;var o=!0,i=t.getDom(),s=i.offsetWidth,h=i.offsetHeight,f=s/2+t.SPACE,e=h/2,r=Math.abs(n.screenX-t.left),u=Math.abs(n.screenY-t.top);clearTimeout(c),c=setTimeout(function(){u>0&&u<e?t.setOpacity(i,"1"):u>e&&u<e+70?(t.setOpacity(i,"0.5"),o=!1):u>e+70&&u<e+140&&t.hide(),o&&r>0&&r<f?t.setOpacity(i,"1"):r>f&&r<f+70?t.setOpacity(i,"0.5"):r>f+70&&r<f+140&&t.hide()})}});if(i.chrome)n.on(r,"mouseout",function(n){var i=n.relatedTarget||n.toElement;(i==null||i.tagName=="HTML")&&t.hide()});t.editor.addListener("afterhidepop",function(){t.isHidden||(f=!0)})},initItems:function(){var n,r,i;if(u.isArray(this.items))for(n=0,r=this.items.length;n<r;n++)i=this.items[n].toLowerCase(),t[i]&&(this.items[n]=new t[i](this.editor),this.items[n].className+=" edui-shortcutsubmenu ")},setOpacity:function(n,t){i.ie&&i.version<9?n.style.filter="alpha(opacity = "+parseFloat(t)*100+");":n.style.opacity=t},getSubMenuMark:function(){var t,i,r,u;for(f=!1,t=e.getFixedLayer(),i=n.getElementsByTagName(t,"div",function(t){return n.hasClass(t,"edui-shortcutsubmenu edui-popup")}),r=0;u=i[r++];)u.style.display!="none"&&(f=!0);return f},show:function(t,i){function h(n){n.left<0&&(n.left=0),n.top<0&&(n.top=0),u.style.cssText="position:absolute;left:"+n.left+"px;top:"+n.top+"px;"}function c(n){n.tagName||(n=n.getDom()),f.left=parseInt(n.style.left),f.top=parseInt(n.style.top),f.top-=u.offsetHeight+15,h(f)}var r=this,f={},u=this.getDom(),s=e.getFixedLayer(),o;r.eventType=t.type,u.style.cssText="display:block;left:-9999px",t.type=="contextmenu"&&i?(o=n.getElementsByTagName(s,"div","edui-contextmenu")[0],o?c(o):r.editor.addListener("aftershowcontextmenu",function(n,t){c(t)})):(f=e.getViewportOffsetByEvent(t),f.top-=u.offsetHeight+r.SPACE,f.left+=r.SPACE+20,h(f),r.setOpacity(u,.2)),r.isHidden=!1,r.left=t.screenX+u.offsetWidth/2-r.SPACE,r.top=t.screenY-u.offsetHeight/2-r.SPACE,r.editor&&(u.style.zIndex=r.editor.container.style.zIndex*1+10,s.style.zIndex=u.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(u.isArray(this.items))for(var t=0,n;n=this.items[t++];)n.postRender()},getHtmlTpl:function(){var n,t;if(u.isArray(this.items)){for(n=[],t=0;t<this.items.length;t++)n[t]=this.items[t].renderHtml();n=n.join("")}else n=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+n+"<\/div>"}},u.inherits(o,l);n.on(document,"mousedown",function(n){s(n)});n.on(window,"scroll",function(n){s(n)})}(),function(){var t=r.editor.utils,i=r.editor.ui.UIBase,n=r.editor.ui.Breakline=function(n){this.initOptions(n),this.initSeparator()};n.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}},t.inherits(n,i)}()})();
//@ sourceMappingURL=ueditor.all.min.js.map